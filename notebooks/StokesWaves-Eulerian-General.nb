(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    259352,       6784]
NotebookOptionsPosition[    245642,       6557]
NotebookOutlinePosition[    246035,       6573]
CellTagsIndexPosition[    245992,       6570]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Stokes Waves in Eulerian Coordinates", "Title",
 CellChangeTimes->{{3.8726167911979227`*^9, 
  3.872616813652995*^9}},ExpressionUUID->"b00a80b6-6bb9-45e9-b949-\
0996d304dd9f"],

Cell["\<\
Written by: Aidan Blaser (ablaser@ucsd.edu)
Last Edited: 09/19/2022\
\>", "Subtitle",
 CellChangeTimes->{{3.872616827956628*^9, 
  3.872616848669795*^9}},ExpressionUUID->"171d7166-04ce-4e9b-8e0e-\
f9bc540ed745"],

Cell[BoxData[
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.872616862260195*^9, 3.872616863764624*^9}, {
  3.872680770659586*^9, 3.8726807756920443`*^9}},
 CellLabel->
  "In[1944]:=",ExpressionUUID->"492a0b1f-8802-4cde-8d5f-2482156ea0af"],

Cell[CellGroupData[{

Cell["Equations of Motion", "Section",
 CellChangeTimes->{{3.872616874586975*^9, 
  3.872616878686367*^9}},ExpressionUUID->"cb9d3b79-5f20-4de2-bc64-\
6f2a6441573d"],

Cell[TextData[{
 "We first begin with irrotational, incompressible, inviscid Navier-Stokes in \
2D\n\nx: ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[<|"boxes" -> FormBox[
        RowBox[{
          FractionBox[
           RowBox[{
             StyleBox["D", "TI"], 
             StyleBox["u", "TI"]}], 
           RowBox[{
             StyleBox["D", "TI"], 
             StyleBox["t", "TI"]}]], "\[LongEqual]", "-", 
          FractionBox[
           SubscriptBox[
            StyleBox["p", "TI"], 
            StyleBox["x", "TI"]], "\[Rho]"]}], TraditionalForm], 
      "errors" -> {}, "input" -> "\\frac{Du}{Dt} = -\\frac{p_x}{\\rho}", 
      "state" -> "Boxes"|>,
     "TeXAssistantTemplate"], " "}], TraditionalForm]],ExpressionUUID->
  "afd55268-aa9a-4c12-bf73-9f1c3ddcd742"],
 "\nz: ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         FractionBox[
          RowBox[{
            StyleBox["D", "TI"], 
            StyleBox["w", "TI"]}], 
          RowBox[{
            StyleBox["D", "TI"], 
            StyleBox["t", "TI"]}]], "\[LongEqual]", "-", 
         FractionBox[
          SubscriptBox[
           StyleBox["p", "TI"], 
           StyleBox["z", "TI"]], "\[Rho]"], "-", 
         StyleBox["g", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\frac{Dw}{Dt} = -\\frac{p_z}{\\rho} - g", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "35c67917-207f-40e0-bf9f-dd214f994afc"],
 "\nsince irrotational, we can write a velocity potential ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Phi]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\phi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "3f988e22-245b-463c-8501-dca83a4f4d92"],
 " s.t. ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["u", FontSlant -> "Bold"], "\[LongEqual]", "\[Del]", 
         "\[Phi]"}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\mathbf{u} = \\nabla \\phi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "573f60cc-bbf3-4aaf-b782-34b1f9472ee1"],
 "\nsince incompressible, ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SuperscriptBox["\[Del]", "2"], "\[Phi]", "\[LongEqual]", "0"}], 
       TraditionalForm], "errors" -> {}, "input" -> "\\nabla^2 \\phi = 0", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "8ddd322f-dc38-4f49-b919-40abdb9bc552"],
 "\n\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["w", "TI"], "\[LongEqual]", 
         FractionBox[
          RowBox[{
            StyleBox["D", "TI"], 
            StyleBox["z", "TI"]}], 
          RowBox[{
            StyleBox["D", "TI"], 
            StyleBox["t", "TI"]}]]}], TraditionalForm], "errors" -> {}, 
     "input" -> "w = \\frac{Dz}{Dt}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "52f1ebd1-3fd4-4586-8304-f648c84c5f07"],
 " so at the surface ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["z", "TI"], "\[LongEqual]", "\[Eta]"}], TraditionalForm], 
     "errors" -> {}, "input" -> "z=\\eta", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "bf967a73-338d-432b-97c9-475809590596"],
 ", ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["w", "TI"], "\[LongEqual]", 
         SubscriptBox["\[Phi]", 
          StyleBox["z", "TI"]], "\[LongEqual]", 
         FractionBox[
          RowBox[{
            StyleBox["D", "TI"], "\[Eta]"}], 
          RowBox[{
            StyleBox["D", "TI"], 
            StyleBox["t", "TI"]}]], "\[LongEqual]", 
         SubscriptBox["\[Eta]", 
          StyleBox["t", "TI"]], "+", 
         SubscriptBox["\[Phi]", 
          StyleBox["x", "TI"]], 
         SubscriptBox["\[Eta]", 
          StyleBox["x", "TI"]]}], TraditionalForm], "errors" -> {}, "input" -> 
     "w = \\phi_z = \\frac{D\\eta}{Dt} = \\eta_t + \\phi_x \\eta_x", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "244f38a6-d743-4b9e-a33e-3bdb5e4388e0"],
 " \n\nFrom Bernoulli\[CloseCurlyQuote]s Law for potential flow: ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         FractionBox[
          RowBox[{"\[PartialD]", "\[Phi]"}], 
          RowBox[{"\[PartialD]", 
            StyleBox["t", "TI"]}]], "+", 
         FractionBox["1", "2"], 
         SuperscriptBox[
          RowBox[{"(", 
            RowBox[{"\[Del]", "\[Phi]"}], ")"}], "2"], "+", 
         FractionBox[
          StyleBox["p", "TI"], "\[Rho]"], "+", 
         StyleBox["g", "TI"], 
         StyleBox["z", "TI"], "\[LongEqual]", 
         StyleBox["f", "TI"], 
         RowBox[{"(", 
           StyleBox["t", "TI"], ")"}]}], TraditionalForm], "errors" -> {}, 
     "input" -> 
     "\\frac{\\partial \\phi}{\\partial t} + \\frac{1}{2} (\\nabla  \\phi)^2 \
+ \\frac{p}{\\rho} + g z = f(t)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "ce12785a-0a84-4b7d-aae3-1833af37dac5"],
 "\nAt the surface, let ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["p", "TI"], "\[LongEqual]", "0"}], TraditionalForm], 
     "errors" -> {}, "input" -> "p=0", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "094cb4f1-5428-45d8-968c-d1406fcade0e"],
 " and also let the Bernoulli constant ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["f", "TI"], 
         RowBox[{"(", 
           StyleBox["t", "TI"], ")"}], "\[LongEqual]", "0"}], 
       TraditionalForm], "errors" -> {}, "input" -> "f(t)=0", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "2b609b64-7265-41a4-804b-cc538e304119"],
 " \n(since velocity comes from gradient, f is arbitrary gauge and does not \
change velocity, so we can ignore it)\n\nTo solve, we expand the potential \
asymptotically about a state of rest (",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[Phi]", "\[LongEqual]", "0"}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\phi=0", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "17eab96b-a71d-4beb-a4b5-9cc86cc99a2b"],
 ")\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[Phi]", "\[LongEqual]", "0", "+", 
         SubscriptBox["\[Epsilon]\[Phi]", "1"], 
         RowBox[{"(", 
           RowBox[{
             StyleBox["x", "TI"], ",", 
             StyleBox["z", "TI"], ",", 
             StyleBox["t", "TI"]}], ")"}], "+", 
         SuperscriptBox["\[Epsilon]", "2"], 
         SubscriptBox["\[Phi]", "2"], 
         RowBox[{"(", 
           RowBox[{
             StyleBox["x", "TI"], ",", 
             StyleBox["z", "TI"], ",", 
             StyleBox["t", "TI"]}], ")"}], "+", "..."}], TraditionalForm], 
     "errors" -> {}, "input" -> 
     "\\phi = 0 + \\epsilon \\phi_1(x,z,t) + \\epsilon^2 \\phi_2(x,z,t) + \
...", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "d026eb29-9c18-48a8-bfd0-f900373c3c99"],
 "\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[Eta]", "\[LongEqual]", "0", "+", 
         SubscriptBox["\[Epsilon]\[Eta]", "1"], 
         RowBox[{"(", 
           RowBox[{
             StyleBox["x", "TI"], ",", 
             StyleBox["z", "TI"], ",", 
             StyleBox["t", "TI"]}], ")"}], "+", 
         SuperscriptBox["\[Epsilon]", "2"], 
         SubscriptBox["\[Eta]", "2"], 
         RowBox[{"(", 
           RowBox[{
             StyleBox["x", "TI"], ",", 
             StyleBox["z", "TI"], ",", 
             StyleBox["t", "TI"]}], ")"}], "+", "..."}], TraditionalForm], 
     "errors" -> {}, "input" -> 
     "\\eta = 0 + \\epsilon \\eta_1(x,z,t) + \\epsilon^2 \\eta_2(x,z,t) + \
...", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "5d91c1bf-23e1-4099-8c7a-e24421c83639"],
 "\n\nSo our boundary conditions are (at order \[Epsilon])\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox["\[Eta]", 
          StyleBox["t", "TI"]], "\[LongEqual]", 
         StyleBox["w", "TI"], "\[LongEqual]", 
         SubscriptBox["\[Phi]", 
          StyleBox["z", "TI"]], "  ", "@", 
         StyleBox["z", "TI"], "\[LongEqual]", "\[Eta]"}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\eta_t = w = \\phi_z \\quad @z=\\eta", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "2a6e03d2-353c-4d18-b52c-febbc5ec1b3e"],
 " (velocity at surface is height changing)\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox["\[Phi]", 
          StyleBox["z", "TI"]], "\[Rule]", "0  ", "as", " ", 
         StyleBox["z", "TI"], "\[Rule]", "-", "\[Infinity]"}], 
       TraditionalForm], "errors" -> {}, "input" -> 
     "\\phi_z \\rightarrow 0 \\quad \\text{as} \\, z \\rightarrow -\\infty", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "13307335-7c6d-4e15-b1ee-15e820b2d928"],
 "\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox["\[Phi]", 
          StyleBox["t", "TI"]], "+", 
         StyleBox["g", "TI"], "\[Eta]", "\[LongEqual]", "0  ", "@", 
         StyleBox["z", "TI"], "\[LongEqual]", "\[Eta]"}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\phi_t  + g\\eta = 0 \\quad @ z=\\eta", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "20e5a489-c48b-4149-8096-b9fdb374b2df"],
 " (from Bernoulli, velocity small since small slope expansion)\n\nAnother \
Issue that will arise is that we evaluate our B.C. at \[Eta] which changes.\n\
We get around this by remembering that we also expanded \[Eta] so\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[Phi]", 
         RowBox[{"(", 
           RowBox[{
             StyleBox["z", "TI"], "\[LongEqual]", "\[Eta]"}], ")"}], 
         "\[LongEqual]", "\[Phi]", 
         RowBox[{"(", "0", ")"}], "+", 
         SubscriptBox["\[Phi]", 
          StyleBox["z", "TI"]], 
         RowBox[{"(", "0", ")"}], 
         RowBox[{"(", 
           RowBox[{
             SubscriptBox["\[Epsilon]\[Eta]", "1"], "+", 
             SuperscriptBox["\[Epsilon]", "2"], 
             SubscriptBox["\[Eta]", "2"], "+", "..."}], ")"}], "+", "..."}], 
       TraditionalForm], "errors" -> {}, "input" -> 
     "\\phi (z = \\eta) = \\phi(0) + \\phi_z(0) (\\epsilon \\eta_1 + \
\\epsilon^2 \\eta_2 + ...) + ...", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "859064bf-e515-4344-8b34-13f00f478b7d"],
 " via a standard Taylor expansion\n"
}], "Text",
 CellChangeTimes->{{3.8726168897642193`*^9, 3.87261690565034*^9}, {
   3.872617403362317*^9, 3.872617434730317*^9}, {3.872617469553533*^9, 
   3.872617474911139*^9}, {3.8726175057679853`*^9, 3.87261750949504*^9}, {
   3.872617748103174*^9, 3.872617754118582*^9}, 3.8726177940845633`*^9, {
   3.872617853339507*^9, 3.872617855482437*^9}, {3.872618496375654*^9, 
   3.872618548270265*^9}, {3.872618590442992*^9, 3.872618598083027*^9}, {
   3.872618748125887*^9, 3.872618769325946*^9}, {3.872620430910647*^9, 
   3.8726204474623957`*^9}, {3.872620539980077*^9, 3.8726206033773413`*^9}, {
   3.872620772859462*^9, 3.872620837252962*^9}, {3.8726208895683823`*^9, 
   3.872620897151587*^9}, {3.872680109626584*^9, 3.872680152885179*^9}, {
   3.872680281209968*^9, 3.872680315195107*^9}, {3.872687487045652*^9, 
   3.872687522202713*^9}, {3.872687560755286*^9, 3.8726875687177973`*^9}, {
   3.87268761640129*^9, 3.8726876771695757`*^9}, {3.8726877451607637`*^9, 
   3.872687745464056*^9}, {3.872698030133856*^9, 3.872698031901926*^9}, 
   3.872700431277384*^9, {3.872783831752803*^9, 3.872783888054954*^9}, {
   3.8727839734358664`*^9, 
   3.872783980100155*^9}},ExpressionUUID->"6db499c1-8a50-4e78-a4b5-\
b29203035bf3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Boundary Conditions", "Section",
 CellChangeTimes->{{3.872680414335019*^9, 3.872680415255184*^9}, {
  3.872688804329184*^9, 
  3.8726888078496103`*^9}},ExpressionUUID->"9274f81e-b79a-4ee0-9378-\
ac8ed9446c36"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Define", " ", "variables"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"order", " ", "=", " ", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"omega", " ", "=", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Omega]", "[", "n", "]"}], " ", 
       RowBox[{"\[Epsilon]", "^", 
        RowBox[{"(", "n", ")"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "0", ",", 
        RowBox[{"order", "-", "1"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"phi", "[", 
    RowBox[{"x_", ",", "z_", ",", "t_", ",", "k_", ",", "\[Omega]_"}], "]"}], 
   " ", ":=", " ", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Epsilon]", "^", "n"}], " ", "*", " ", 
      RowBox[{"\[Phi]", "[", 
       RowBox[{"n", ",", "m"}], "]"}], 
      RowBox[{"Sin", "[", 
       RowBox[{"m", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"k", " ", "x"}], " ", "-", " ", 
          RowBox[{"\[Omega]", " ", "t"}]}], ")"}]}], "]"}], 
      RowBox[{"Exp", "[", 
       RowBox[{"m", " ", "k", " ", "z"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "1", ",", "order"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "1", ",", "order"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phi", "=", " ", 
   RowBox[{"phi", "[", 
    RowBox[{"x", ",", "z", ",", "t", ",", "k", ",", "omega"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"eta", "[", 
    RowBox[{"x_", ",", "z_", ",", "t_", ",", "k_", ",", "\[Omega]_"}], "]"}], 
   " ", ":=", " ", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Epsilon]", "^", "n"}], " ", "*", " ", 
      RowBox[{"\[Eta]", "[", 
       RowBox[{"n", ",", "m"}], "]"}], "*", 
      RowBox[{"Cos", "[", 
       RowBox[{"m", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"k", " ", "x"}], " ", "-", " ", 
          RowBox[{"\[Omega]", " ", "t"}]}], ")"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "1", ",", "order"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "1", ",", "order"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"eta", "=", " ", 
  RowBox[{"eta", "[", 
   RowBox[{"x", ",", "z", ",", "t", ",", "k", ",", "omega"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.872680420587098*^9, 3.872680490381316*^9}, {
   3.872680543811681*^9, 3.872680603410541*^9}, {3.87268063464824*^9, 
   3.8726806618238163`*^9}, {3.872680698054575*^9, 3.872680818442637*^9}, {
   3.872681008933825*^9, 3.872681115663733*^9}, {3.8726888225831413`*^9, 
   3.872688840969386*^9}, {3.872701776959146*^9, 3.872701780490205*^9}, {
   3.872701821431881*^9, 3.872701822987059*^9}, {3.872784152759347*^9, 
   3.872784154430393*^9}, {3.872785555393237*^9, 3.872785555569529*^9}, {
   3.873218164565428*^9, 3.873218165095379*^9}, {3.874685322513688*^9, 
   3.874685323939258*^9}, {3.874685501132882*^9, 3.874685515641781*^9}, {
   3.874685734707041*^9, 3.8746858478511057`*^9}, {3.874685914735187*^9, 
   3.87468594077387*^9}, {3.87468597830145*^9, 3.874686036346899*^9}, {
   3.8746860784857883`*^9, 3.874686238530994*^9}, {3.874686427278657*^9, 
   3.874686428213668*^9}, {3.874686639574915*^9, 3.874686645900893*^9}, {
   3.874686730212098*^9, 3.874686739053*^9}, 3.874686908838059*^9, {
   3.875030053317309*^9, 3.875030121726203*^9}, {3.8750311511671877`*^9, 
   3.875031167222496*^9}, {3.875358045304756*^9, 3.8753580454221287`*^9}},
 CellLabel->
  "In[1945]:=",ExpressionUUID->"d28214ab-a569-432c-a31f-35f9e89de257"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"k", " ", "z"}]], " ", "\[Epsilon]", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{
     RowBox[{"k", " ", "x"}], "-", 
     RowBox[{"t", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
        RowBox[{"\[Epsilon]", " ", 
         RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "2"], " ", 
         RowBox[{"\[Omega]", "[", "2", "]"}]}]}], ")"}]}]}], "]"}], " ", 
   RowBox[{"\[Phi]", "[", 
    RowBox[{"1", ",", "1"}], "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"2", " ", "k", " ", "z"}]], " ", "\[Epsilon]", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"k", " ", "x"}], "-", 
       RowBox[{"t", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
          RowBox[{"\[Epsilon]", " ", 
           RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
          RowBox[{
           SuperscriptBox["\[Epsilon]", "2"], " ", 
           RowBox[{"\[Omega]", "[", "2", "]"}]}]}], ")"}]}]}], ")"}]}], "]"}],
    " ", 
   RowBox[{"\[Phi]", "[", 
    RowBox[{"1", ",", "2"}], "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"3", " ", "k", " ", "z"}]], " ", "\[Epsilon]", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"3", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"k", " ", "x"}], "-", 
       RowBox[{"t", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
          RowBox[{"\[Epsilon]", " ", 
           RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
          RowBox[{
           SuperscriptBox["\[Epsilon]", "2"], " ", 
           RowBox[{"\[Omega]", "[", "2", "]"}]}]}], ")"}]}]}], ")"}]}], "]"}],
    " ", 
   RowBox[{"\[Phi]", "[", 
    RowBox[{"1", ",", "3"}], "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"k", " ", "z"}]], " ", 
   SuperscriptBox["\[Epsilon]", "2"], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{
     RowBox[{"k", " ", "x"}], "-", 
     RowBox[{"t", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
        RowBox[{"\[Epsilon]", " ", 
         RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "2"], " ", 
         RowBox[{"\[Omega]", "[", "2", "]"}]}]}], ")"}]}]}], "]"}], " ", 
   RowBox[{"\[Phi]", "[", 
    RowBox[{"2", ",", "1"}], "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"2", " ", "k", " ", "z"}]], " ", 
   SuperscriptBox["\[Epsilon]", "2"], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"k", " ", "x"}], "-", 
       RowBox[{"t", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
          RowBox[{"\[Epsilon]", " ", 
           RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
          RowBox[{
           SuperscriptBox["\[Epsilon]", "2"], " ", 
           RowBox[{"\[Omega]", "[", "2", "]"}]}]}], ")"}]}]}], ")"}]}], "]"}],
    " ", 
   RowBox[{"\[Phi]", "[", 
    RowBox[{"2", ",", "2"}], "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"3", " ", "k", " ", "z"}]], " ", 
   SuperscriptBox["\[Epsilon]", "2"], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"3", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"k", " ", "x"}], "-", 
       RowBox[{"t", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
          RowBox[{"\[Epsilon]", " ", 
           RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
          RowBox[{
           SuperscriptBox["\[Epsilon]", "2"], " ", 
           RowBox[{"\[Omega]", "[", "2", "]"}]}]}], ")"}]}]}], ")"}]}], "]"}],
    " ", 
   RowBox[{"\[Phi]", "[", 
    RowBox[{"2", ",", "3"}], "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"k", " ", "z"}]], " ", 
   SuperscriptBox["\[Epsilon]", "3"], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{
     RowBox[{"k", " ", "x"}], "-", 
     RowBox[{"t", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
        RowBox[{"\[Epsilon]", " ", 
         RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "2"], " ", 
         RowBox[{"\[Omega]", "[", "2", "]"}]}]}], ")"}]}]}], "]"}], " ", 
   RowBox[{"\[Phi]", "[", 
    RowBox[{"3", ",", "1"}], "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"2", " ", "k", " ", "z"}]], " ", 
   SuperscriptBox["\[Epsilon]", "3"], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"k", " ", "x"}], "-", 
       RowBox[{"t", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
          RowBox[{"\[Epsilon]", " ", 
           RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
          RowBox[{
           SuperscriptBox["\[Epsilon]", "2"], " ", 
           RowBox[{"\[Omega]", "[", "2", "]"}]}]}], ")"}]}]}], ")"}]}], "]"}],
    " ", 
   RowBox[{"\[Phi]", "[", 
    RowBox[{"3", ",", "2"}], "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"3", " ", "k", " ", "z"}]], " ", 
   SuperscriptBox["\[Epsilon]", "3"], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"3", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"k", " ", "x"}], "-", 
       RowBox[{"t", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
          RowBox[{"\[Epsilon]", " ", 
           RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
          RowBox[{
           SuperscriptBox["\[Epsilon]", "2"], " ", 
           RowBox[{"\[Omega]", "[", "2", "]"}]}]}], ")"}]}]}], ")"}]}], "]"}],
    " ", 
   RowBox[{"\[Phi]", "[", 
    RowBox[{"3", ",", "3"}], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.874686429483852*^9, 3.874686430835772*^9}, 
   3.8746864798575783`*^9, {3.874686647620585*^9, 3.874686656160453*^9}, {
   3.874686688161952*^9, 3.8746867082936153`*^9}, 3.874686740394496*^9, 
   3.874686771857294*^9, {3.874686911823317*^9, 3.874686937459901*^9}, 
   3.874687003949457*^9, 3.875030124668117*^9, 3.875031172628521*^9, 
   3.875032945090624*^9, 3.875284493051446*^9, 3.875284765717773*^9, 
   3.875285381494609*^9, 3.875291499835828*^9, 3.875357846579522*^9, 
   3.8753591530448837`*^9},
 CellLabel->
  "Out[1949]=",ExpressionUUID->"258c6b7d-8a13-45d5-8aea-e7183b83f31b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Epsilon]", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{
     RowBox[{"k", " ", "x"}], "-", 
     RowBox[{"t", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
        RowBox[{"\[Epsilon]", " ", 
         RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "2"], " ", 
         RowBox[{"\[Omega]", "[", "2", "]"}]}]}], ")"}]}]}], "]"}], " ", 
   RowBox[{"\[Eta]", "[", 
    RowBox[{"1", ",", "1"}], "]"}]}], "+", 
  RowBox[{"\[Epsilon]", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"k", " ", "x"}], "-", 
       RowBox[{"t", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
          RowBox[{"\[Epsilon]", " ", 
           RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
          RowBox[{
           SuperscriptBox["\[Epsilon]", "2"], " ", 
           RowBox[{"\[Omega]", "[", "2", "]"}]}]}], ")"}]}]}], ")"}]}], "]"}],
    " ", 
   RowBox[{"\[Eta]", "[", 
    RowBox[{"1", ",", "2"}], "]"}]}], "+", 
  RowBox[{"\[Epsilon]", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"3", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"k", " ", "x"}], "-", 
       RowBox[{"t", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
          RowBox[{"\[Epsilon]", " ", 
           RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
          RowBox[{
           SuperscriptBox["\[Epsilon]", "2"], " ", 
           RowBox[{"\[Omega]", "[", "2", "]"}]}]}], ")"}]}]}], ")"}]}], "]"}],
    " ", 
   RowBox[{"\[Eta]", "[", 
    RowBox[{"1", ",", "3"}], "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["\[Epsilon]", "2"], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{
     RowBox[{"k", " ", "x"}], "-", 
     RowBox[{"t", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
        RowBox[{"\[Epsilon]", " ", 
         RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "2"], " ", 
         RowBox[{"\[Omega]", "[", "2", "]"}]}]}], ")"}]}]}], "]"}], " ", 
   RowBox[{"\[Eta]", "[", 
    RowBox[{"2", ",", "1"}], "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["\[Epsilon]", "2"], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"k", " ", "x"}], "-", 
       RowBox[{"t", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
          RowBox[{"\[Epsilon]", " ", 
           RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
          RowBox[{
           SuperscriptBox["\[Epsilon]", "2"], " ", 
           RowBox[{"\[Omega]", "[", "2", "]"}]}]}], ")"}]}]}], ")"}]}], "]"}],
    " ", 
   RowBox[{"\[Eta]", "[", 
    RowBox[{"2", ",", "2"}], "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["\[Epsilon]", "2"], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"3", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"k", " ", "x"}], "-", 
       RowBox[{"t", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
          RowBox[{"\[Epsilon]", " ", 
           RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
          RowBox[{
           SuperscriptBox["\[Epsilon]", "2"], " ", 
           RowBox[{"\[Omega]", "[", "2", "]"}]}]}], ")"}]}]}], ")"}]}], "]"}],
    " ", 
   RowBox[{"\[Eta]", "[", 
    RowBox[{"2", ",", "3"}], "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["\[Epsilon]", "3"], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{
     RowBox[{"k", " ", "x"}], "-", 
     RowBox[{"t", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
        RowBox[{"\[Epsilon]", " ", 
         RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "2"], " ", 
         RowBox[{"\[Omega]", "[", "2", "]"}]}]}], ")"}]}]}], "]"}], " ", 
   RowBox[{"\[Eta]", "[", 
    RowBox[{"3", ",", "1"}], "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["\[Epsilon]", "3"], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"k", " ", "x"}], "-", 
       RowBox[{"t", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
          RowBox[{"\[Epsilon]", " ", 
           RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
          RowBox[{
           SuperscriptBox["\[Epsilon]", "2"], " ", 
           RowBox[{"\[Omega]", "[", "2", "]"}]}]}], ")"}]}]}], ")"}]}], "]"}],
    " ", 
   RowBox[{"\[Eta]", "[", 
    RowBox[{"3", ",", "2"}], "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["\[Epsilon]", "3"], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"3", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"k", " ", "x"}], "-", 
       RowBox[{"t", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
          RowBox[{"\[Epsilon]", " ", 
           RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
          RowBox[{
           SuperscriptBox["\[Epsilon]", "2"], " ", 
           RowBox[{"\[Omega]", "[", "2", "]"}]}]}], ")"}]}]}], ")"}]}], "]"}],
    " ", 
   RowBox[{"\[Eta]", "[", 
    RowBox[{"3", ",", "3"}], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.874686429483852*^9, 3.874686430835772*^9}, 
   3.8746864798575783`*^9, {3.874686647620585*^9, 3.874686656160453*^9}, {
   3.874686688161952*^9, 3.8746867082936153`*^9}, 3.874686740394496*^9, 
   3.874686771857294*^9, {3.874686911823317*^9, 3.874686937459901*^9}, 
   3.874687003949457*^9, 3.875030124668117*^9, 3.875031172628521*^9, 
   3.875032945090624*^9, 3.875284493051446*^9, 3.875284765717773*^9, 
   3.875285381494609*^9, 3.875291499835828*^9, 3.875357846579522*^9, 
   3.87535915306992*^9},
 CellLabel->
  "Out[1951]=",ExpressionUUID->"b6b1b259-4063-4c97-9947-34fbecb789f5"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Define", " ", "Taylor", " ", "Expansion"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Taylor", "[", "f_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"Normal", "[", 
     RowBox[{"Series", "[", 
      RowBox[{"f", ",", 
       RowBox[{"{", 
        RowBox[{"z", ",", "0", ",", "order"}], "}"}]}], "]"}], "]"}], " ", "/.",
     " ", 
    RowBox[{"z", " ", "->", " ", "eta"}]}]}]}]], "Input",
 CellChangeTimes->{{3.87278415809452*^9, 3.872784173693617*^9}, {
   3.8727848319905443`*^9, 3.872784842136733*^9}, {3.872784890452794*^9, 
   3.872784901437533*^9}, {3.8727849426117477`*^9, 3.872784953427904*^9}, {
   3.8727850118588448`*^9, 3.8727850202407417`*^9}, {3.872785083198824*^9, 
   3.872785087322277*^9}, {3.872785176949741*^9, 3.8727852030511837`*^9}, {
   3.872785249081381*^9, 3.8727852760083838`*^9}, 3.874686766744925*^9, {
   3.8746869465999813`*^9, 3.87468695044153*^9}, {3.874687115889154*^9, 
   3.874687144843192*^9}, 3.87468717721395*^9, {3.8746872736348677`*^9, 
   3.874687274326828*^9}},
 CellLabel->
  "In[1952]:=",ExpressionUUID->"5ba5cfe9-4bc8-4cd9-bfb5-ea8e872d2c62"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Define", " ", "Laplacian"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"laplace", " ", "=", " ", 
   RowBox[{"CoefficientList", "[", 
    RowBox[{
     RowBox[{"Laplacian", "[", 
      RowBox[{"phi", ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "z"}], "}"}]}], "]"}], ",", "\[Epsilon]"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.872697914914721*^9, 3.872697948792777*^9}},
 CellLabel->
  "In[1953]:=",ExpressionUUID->"cf63aacc-b963-469f-8e31-f049253fe51c"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{{3.872697932889616*^9, 3.872697950856391*^9}, 
   3.872701367226235*^9, 3.872701786908018*^9, 3.872701834150105*^9, 
   3.87270285132966*^9, 3.872770722971074*^9, 3.872785561549799*^9, 
   3.8727864070432053`*^9, 3.872786509392206*^9, 3.87278657300193*^9, 
   3.8727866649086018`*^9, 3.873218171518611*^9, 3.873287437594262*^9, 
   3.8732885874830513`*^9, 3.873288712880385*^9, 3.873289065741167*^9, 
   3.873289109316538*^9, 3.8732906557892227`*^9, 3.8732908841373377`*^9, 
   3.873291154035914*^9, 3.8732922859748793`*^9, {3.873307285948243*^9, 
   3.873307293663383*^9}, 3.8733073585296583`*^9, 3.873384829315827*^9, {
   3.873803431843562*^9, 3.8738034764943123`*^9}, 3.873803608339527*^9, 
   3.873804084805832*^9, 3.8738041161082706`*^9, 3.873804214056571*^9, {
   3.873804284321349*^9, 3.873804298943459*^9}, 3.8738044010876837`*^9, 
   3.873816076099543*^9, 3.8738228260654163`*^9, 3.874686397417502*^9, {
   3.874686483071377*^9, 3.874686488339671*^9}, {3.874686716016214*^9, 
   3.8746867748532467`*^9}, 3.874686915429954*^9, 3.874686961089526*^9, 
   3.8746870188171673`*^9, 3.874687282201849*^9, 3.875030134126845*^9, 
   3.875031176420724*^9, 3.875032945190756*^9, 3.875284493145586*^9, 
   3.875284765815671*^9, 3.8752853815932817`*^9, 3.875291499931156*^9, 
   3.875357846680628*^9, 3.8753591531420717`*^9},
 CellLabel->
  "Out[1953]=",ExpressionUUID->"58a0faf0-84d3-4ba1-b7e4-b74488f6e979"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Kinematic", " ", "BC", " ", "at", " ", "all", " ", "orders"}], 
    " ", "-", " ", 
    RowBox[{
    "Particles", " ", "on", " ", "Surface", " ", "Stay", " ", "on", " ", 
     "Surface"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"kbc", " ", "=", " ", 
    RowBox[{"CoefficientList", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"eta", ",", "t"}], "]"}], " ", "+", " ", 
        RowBox[{
         RowBox[{"Taylor", "[", 
          RowBox[{"D", "[", 
           RowBox[{"phi", ",", "x"}], "]"}], "]"}], 
         RowBox[{"D", "[", 
          RowBox[{"eta", ",", "x"}], "]"}]}], " ", "-", " ", 
        RowBox[{"Taylor", "[", 
         RowBox[{"D", "[", 
          RowBox[{"phi", ",", "z"}], "]"}], "]"}]}], " ", "/.", " ", 
       RowBox[{"z", "->", "0"}]}], ",", "\[Epsilon]"}], "]"}]}], " ", 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.872688851465135*^9, 3.872688957029265*^9}, {
   3.872689203886367*^9, 3.8726892048155823`*^9}, {3.872689263330344*^9, 
   3.872689334504347*^9}, {3.87269292186558*^9, 3.872692927739745*^9}, {
   3.872693006543254*^9, 3.8726930791163588`*^9}, {3.872693134787072*^9, 
   3.872693136435277*^9}, 3.8726931742900143`*^9, {3.872784145979796*^9, 
   3.872784146710601*^9}, {3.872784813271494*^9, 3.872784885903113*^9}, {
   3.8727852834081287`*^9, 3.87278529165593*^9}, {3.8727853277755003`*^9, 
   3.8727853660140038`*^9}, {3.872786482035153*^9, 3.872786484512539*^9}, 
   3.872786530862131*^9, {3.872786623386347*^9, 3.872786656978847*^9}, {
   3.8746864698373423`*^9, 3.874686471177994*^9}, {3.875030973077586*^9, 
   3.8750309989140043`*^9}},
 CellLabel->
  "In[1954]:=",ExpressionUUID->"8807aa22-4d2e-4014-a94f-30409f739391"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.87468649385001*^9, 3.8746865046442013`*^9}},
 NumberMarks->False,
 CellLabel->
  "In[1955]:=",ExpressionUUID->"803ba42d-4eb9-443a-a73c-d7f38ae1c9bf"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Ex", ".", " ", "KBC"}], " ", "at", " ", "order", " ", 
    RowBox[{"\[Epsilon]", "^", "2"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"TrigReduce", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"kbc", "[", 
      RowBox[{"[", "2", "]"}], "]"}], " ", "==", " ", "0"}], "  ", "/.", " ", 
    
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"k", " ", "x"}], " ", "-", " ", 
       RowBox[{"omega", " ", "t"}]}], " ", "->", " ", "\[Theta]"}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.87269294812772*^9, 3.872692992199749*^9}, {
  3.872693061838728*^9, 3.872693106163747*^9}, {3.8726931449063473`*^9, 
  3.872693166889838*^9}, {3.8727853114711113`*^9, 3.8727853464855433`*^9}, {
  3.872785376982472*^9, 3.872785391860241*^9}, {3.872786583854434*^9, 
  3.872786584596858*^9}, {3.872786671299727*^9, 3.872786675449852*^9}, {
  3.872788380915379*^9, 3.872788397849161*^9}, {3.873216676001627*^9, 
  3.873216692178653*^9}, {3.87468702996766*^9, 3.874687070583737*^9}, {
  3.8746872151056223`*^9, 3.874687218176654*^9}, {3.87468728605905*^9, 
  3.8746873174209623`*^9}, {3.874687414642905*^9, 3.8746874445278*^9}, {
  3.875030868325658*^9, 3.875030887485239*^9}, {3.875031009556135*^9, 
  3.875031009688973*^9}, {3.8750312165961523`*^9, 3.875031216682212*^9}, {
  3.875031341672412*^9, 3.875031421657549*^9}, {3.8750329028037443`*^9, 
  3.875032902881728*^9}},
 CellLabel->
  "In[1956]:=",ExpressionUUID->"e631a0b0-cb2a-4fb1-a5aa-c78fbcbf322f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"-", "k"}], " ", 
    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
    RowBox[{"\[Phi]", "[", 
     RowBox[{"1", ",", "1"}], "]"}]}], "-", 
   RowBox[{"2", " ", "k", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", "\[Theta]"}], "]"}], " ", 
    RowBox[{"\[Phi]", "[", 
     RowBox[{"1", ",", "2"}], "]"}]}], "-", 
   RowBox[{"3", " ", "k", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"3", " ", "\[Theta]"}], "]"}], " ", 
    RowBox[{"\[Phi]", "[", 
     RowBox[{"1", ",", "3"}], "]"}]}], "+", 
   RowBox[{
    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
    RowBox[{"\[Eta]", "[", 
     RowBox[{"1", ",", "1"}], "]"}], " ", 
    RowBox[{"\[Omega]", "[", "0", "]"}]}], "+", 
   RowBox[{"2", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", "\[Theta]"}], "]"}], " ", 
    RowBox[{"\[Eta]", "[", 
     RowBox[{"1", ",", "2"}], "]"}], " ", 
    RowBox[{"\[Omega]", "[", "0", "]"}]}], "+", 
   RowBox[{"3", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"3", " ", "\[Theta]"}], "]"}], " ", 
    RowBox[{"\[Eta]", "[", 
     RowBox[{"1", ",", "3"}], "]"}], " ", 
    RowBox[{"\[Omega]", "[", "0", "]"}]}]}], "\[Equal]", "0"}]], "Output",
 CellChangeTimes->{
  3.874687446361974*^9, 3.875030144119734*^9, 3.875030887947624*^9, 
   3.875031009991745*^9, 3.875031180486887*^9, 3.875031217130134*^9, {
   3.875031342054085*^9, 3.875031380887971*^9}, 3.875031422314537*^9, 
   3.875032908065419*^9, 3.875032946087034*^9, 3.875284495688676*^9, 
   3.8752847684364347`*^9, 3.875285384312716*^9, 3.875291502439014*^9, 
   3.875357849188772*^9, 3.875359155227467*^9},
 CellLabel->
  "Out[1956]=",ExpressionUUID->"a2329da9-cbb9-4f17-8640-ebefc523f12d"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8727866100599318`*^9, 3.87278661208454*^9}, 
   3.872786701315563*^9, {3.873198165380142*^9, 3.873198201950828*^9}},
 CellLabel->
  "In[1957]:=",ExpressionUUID->"28ff057a-a164-4bc4-8b5d-5bd4380047f1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Dynamic", " ", "BC", " ", "at", " ", "all", " ", "orders"}], " ",
     "-", " ", "Bernoulli"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"dbc", " ", "=", " ", 
    RowBox[{"CoefficientList", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Taylor", "[", 
         RowBox[{"D", "[", 
          RowBox[{"phi", ",", "t"}], "]"}], "]"}], " ", "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "/", "2"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Taylor", "[", 
             RowBox[{"D", "[", 
              RowBox[{"phi", ",", "x"}], "]"}], "]"}], "^", "2"}], " ", "+", 
           " ", 
           RowBox[{
            RowBox[{"Taylor", "[", 
             RowBox[{"D", "[", 
              RowBox[{"phi", ",", "z"}], "]"}], "]"}], "^", "2"}]}], ")"}]}], 
        " ", "+", " ", 
        RowBox[{"g", "*", "eta"}]}], " ", "/.", " ", 
       RowBox[{"z", "->", " ", "0"}]}], ",", "\[Epsilon]"}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.872689037977941*^9, 3.872689052051692*^9}, {
  3.8726931398105583`*^9, 3.87269314112287*^9}, {3.872693208832328*^9, 
  3.872693280991514*^9}, {3.87278540391761*^9, 3.8727854296518106`*^9}, {
  3.872786706733953*^9, 3.872786765687708*^9}, {3.873803380093813*^9, 
  3.873803381401449*^9}},
 CellLabel->
  "In[1958]:=",ExpressionUUID->"abaa8b3b-256f-4398-abaa-3194e8aa4a48"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Ex", ".", " ", "DBC"}], " ", "at", " ", "order", " ", 
    RowBox[{"\[Epsilon]", "^", "2"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"dbc", "[", 
     RowBox[{"[", "2", "]"}], "]"}], " ", "==", " ", "0"}], " ", "/.", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"k", " ", "x"}], " ", "-", " ", 
      RowBox[{"omega", " ", "t"}]}], " ", "->", " ", "\[Theta]"}], 
    "}"}]}]}]], "Input",
 CellChangeTimes->{{3.872693289422493*^9, 3.872693312541183*^9}, {
  3.8727883879792128`*^9, 3.872788401425115*^9}, {3.872788457454895*^9, 
  3.872788471738634*^9}, {3.873216694101863*^9, 3.873216710001731*^9}, {
  3.873216782452545*^9, 3.873216785170919*^9}, {3.8750313289175797`*^9, 
  3.8750313366136713`*^9}, {3.875032897290161*^9, 3.875032914579013*^9}},
 CellLabel->
  "In[1959]:=",ExpressionUUID->"f571322c-de27-41cc-8a37-f8a06f98dc94"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"g", " ", 
    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
    RowBox[{"\[Eta]", "[", 
     RowBox[{"1", ",", "1"}], "]"}]}], "+", 
   RowBox[{"g", " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"2", " ", "\[Theta]"}], "]"}], " ", 
    RowBox[{"\[Eta]", "[", 
     RowBox[{"1", ",", "2"}], "]"}]}], "+", 
   RowBox[{"g", " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"3", " ", "\[Theta]"}], "]"}], " ", 
    RowBox[{"\[Eta]", "[", 
     RowBox[{"1", ",", "3"}], "]"}]}], "-", 
   RowBox[{
    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
    RowBox[{"\[Phi]", "[", 
     RowBox[{"1", ",", "1"}], "]"}], " ", 
    RowBox[{"\[Omega]", "[", "0", "]"}]}], "-", 
   RowBox[{"2", " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"2", " ", "\[Theta]"}], "]"}], " ", 
    RowBox[{"\[Phi]", "[", 
     RowBox[{"1", ",", "2"}], "]"}], " ", 
    RowBox[{"\[Omega]", "[", "0", "]"}]}], "-", 
   RowBox[{"3", " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"3", " ", "\[Theta]"}], "]"}], " ", 
    RowBox[{"\[Phi]", "[", 
     RowBox[{"1", ",", "3"}], "]"}], " ", 
    RowBox[{"\[Omega]", "[", "0", "]"}]}]}], "\[Equal]", "0"}]], "Output",
 CellChangeTimes->{
  3.8732179591936073`*^9, 3.873290656004251*^9, 3.873290884340975*^9, 
   3.87329115420048*^9, 3.8732922861629467`*^9, {3.8733072861076307`*^9, 
   3.873307293789461*^9}, 3.8733073586451197`*^9, 3.873384829477168*^9, {
   3.873803432011428*^9, 3.8738034766222267`*^9}, 3.87380360846422*^9, 
   3.8738040849700613`*^9, 3.873804123858135*^9, 3.873804214219057*^9, 
   3.873804284459128*^9, 3.873804401183516*^9, 3.8738160762652073`*^9, 
   3.873822826242065*^9, 3.874686512187029*^9, 3.874687514424295*^9, 
   3.875031326151875*^9, {3.875032907933943*^9, 3.875032919039567*^9}, 
   3.875033016056436*^9, 3.8752845679711514`*^9, 3.875284839987907*^9, 
   3.875285458400901*^9, 3.875291571616967*^9, 3.875357918997295*^9, 
   3.875359224196549*^9},
 CellLabel->
  "Out[1959]=",ExpressionUUID->"7366b5cc-eab3-482b-ac6b-99f015d1002b"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.873217965929145*^9, 3.873217981419924*^9}, {
  3.873218137854621*^9, 3.873218155838015*^9}},
 CellLabel->
  "In[1960]:=",ExpressionUUID->"300d3410-9514-45e5-a308-c44fbd42b001"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Finding First Solution", "Section",
 CellChangeTimes->{{3.873217989387823*^9, 3.873218045718646*^9}, {
  3.873218138914061*^9, 3.873218159799596*^9}, {3.873286394320117*^9, 
  3.8732863997080927`*^9}},ExpressionUUID->"c33935e2-bfb4-49c5-92c1-\
568e82b64ca6"],

Cell["\<\
Since these must be valid for all time, will match not only powers of \
\[Epsilon] but also Fourier series terms\
\>", "Text",
 CellChangeTimes->{{3.8732864054424562`*^9, 3.873286446894617*^9}, {
   3.8732864920482397`*^9, 3.873286606869063*^9}, {3.873289114828835*^9, 
   3.873289117712195*^9}, {3.8732901701412373`*^9, 3.873290170213377*^9}, 
   3.874687822670471*^9, {3.87503176707047*^9, 
   3.875031801661427*^9}},ExpressionUUID->"e9b48876-698c-418c-98ac-\
ffc875955536"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"kbc11", " ", "=", " ", 
   RowBox[{
    RowBox[{"FourierSinCoefficient", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"kbc", "[", 
        RowBox[{"[", "2", "]"}], "]"}], " ", "/.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"k", " ", "x"}], " ", "-", " ", 
          RowBox[{"omega", " ", "t"}]}], " ", "->", " ", "\[Theta]"}], 
        "}"}]}], ",", "\[Theta]", ",", "1"}], "]"}], " ", "==", " ", "0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dbc11", " ", "=", " ", 
   RowBox[{
    RowBox[{"FourierCosCoefficient", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"dbc", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "/.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"k", " ", "x"}], " ", "-", " ", 
          RowBox[{"omega", " ", "t"}]}], " ", "->", " ", "\[Theta]"}], 
        "}"}]}], ",", "\[Theta]", ",", "1"}], "]"}], " ", "==", " ", "0"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.873286574870007*^9, 3.873286574877419*^9}, {
   3.873287425105015*^9, 3.873287428473373*^9}, 3.8732874836451273`*^9, {
   3.8750317398567457`*^9, 3.87503175327563*^9}, {3.875031806919023*^9, 
   3.875031812373702*^9}, {3.875031861572324*^9, 3.875031893123489*^9}, {
   3.8750319273541327`*^9, 3.8750320413202143`*^9}, {3.8750320845986557`*^9, 
   3.875032099219966*^9}, {3.875032193707198*^9, 3.875032208672707*^9}, {
   3.8750324600735903`*^9, 3.875032479056004*^9}},
 CellLabel->
  "In[1961]:=",ExpressionUUID->"81e5b6cc-555c-407d-95e5-43d479fd6595"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Force", " ", 
    RowBox[{"\[Eta]", "[", 
     RowBox[{"1", ",", "1"}], "]"}], " ", "to", " ", "be", " ", 
    RowBox[{"1", "/", "k"}], " ", "as", " ", "definition", " ", "of", " ", 
    "initial", " ", "amplitude"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[Eta]", "[", 
      RowBox[{"1", ",", "1"}], "]"}], " ", "=", " ", 
     RowBox[{"1", "/", "k"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"sol11", " ", "=", " ", 
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"kbc11", " ", "&&", " ", "dbc11"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Phi]", "[", 
          RowBox[{"1", ",", "1"}], "]"}], ",", 
         RowBox[{"\[Omega]", "[", "0", "]"}]}], "}"}]}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}]}], " ", 
   RowBox[{"(*", 
    RowBox[{"take", " ", "positive", " ", "root"}], "*)"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.874687829331729*^9, 3.874687840603325*^9}, {
   3.875032116864676*^9, 3.875032177137738*^9}, {3.875032496472472*^9, 
   3.8750325707182493`*^9}, {3.8750326046129017`*^9, 
   3.8750326407056427`*^9}, {3.87528425469615*^9, 3.87528426275839*^9}, {
   3.875284298333621*^9, 3.875284312931842*^9}, {3.875284383082439*^9, 
   3.8752843911209593`*^9}, {3.875284472655795*^9, 3.875284474046246*^9}, {
   3.875284617623406*^9, 3.8752846434324636`*^9}, {3.8752853590788813`*^9, 
   3.8752853644492617`*^9}, {3.875285551211955*^9, 3.87528555862466*^9}, 
   3.875291478994033*^9},
 CellLabel->
  "In[1963]:=",ExpressionUUID->"ce41a24e-d0a8-462f-a932-fc689416550e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Phi]", "[", 
     RowBox[{"1", ",", "1"}], "]"}], "\[Rule]", 
    FractionBox[
     SqrtBox["g"], 
     SuperscriptBox["k", 
      RowBox[{"3", "/", "2"}]]]}], ",", 
   RowBox[{
    RowBox[{"\[Omega]", "[", "0", "]"}], "\[Rule]", 
    RowBox[{
     SqrtBox["g"], " ", 
     SqrtBox["k"]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8750325774353313`*^9, {3.875032614448193*^9, 3.875032641300487*^9}, 
   3.8750330164878817`*^9, {3.875284257060564*^9, 3.875284263209406*^9}, 
   3.875284314474634*^9, 3.875284392023444*^9, 3.875284568434824*^9, 
   3.875284758247304*^9, 3.8752848404430637`*^9, 3.875285458876834*^9, 
   3.8752856372762413`*^9, 3.875291572038588*^9, 3.875357919471675*^9, 
   3.875359224643654*^9},
 CellLabel->
  "Out[1964]=",ExpressionUUID->"35e1293b-b2e3-4f92-8958-7aaa58c78927"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"kbc12", "=", " ", 
   RowBox[{
    RowBox[{"FourierSinCoefficient", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"kbc", "[", 
        RowBox[{"[", "2", "]"}], "]"}], " ", "/.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"k", " ", "x"}], " ", "-", " ", 
          RowBox[{"omega", " ", "t"}]}], " ", "->", " ", "\[Theta]"}], 
        "}"}]}], ",", "\[Theta]", ",", "2"}], "]"}], " ", "==", " ", "0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dbc12", " ", "=", " ", 
   RowBox[{
    RowBox[{"FourierCosCoefficient", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"dbc", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "/.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"k", " ", "x"}], " ", "-", " ", 
          RowBox[{"omega", " ", "t"}]}], " ", "->", " ", "\[Theta]"}], 
        "}"}]}], ",", "\[Theta]", ",", "2"}], "]"}], " ", "==", " ", "0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"sol12", " ", "=", " ", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"kbc12", " ", "&&", " ", "dbc12"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"1", ",", "2"}], "]"}], ",", 
       RowBox[{"\[Eta]", "[", 
        RowBox[{"1", ",", "2"}], "]"}]}], "}"}]}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.874687841999571*^9, 3.874687847739059*^9}, {
   3.875032754180435*^9, 3.8750327901655912`*^9}, {3.875284320668432*^9, 
   3.875284357154375*^9}, {3.875284400645252*^9, 3.87528442781569*^9}, {
   3.875284475631372*^9, 3.875284476678419*^9}, {3.875285368289234*^9, 
   3.8752853758064547`*^9}, {3.8752864035268927`*^9, 3.87528640440506*^9}, 
   3.875291481379003*^9},
 CellLabel->
  "In[1965]:=",ExpressionUUID->"3e702687-dba8-4ed4-9858-6d4ecf5ac6c3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Phi]", "[", 
     RowBox[{"1", ",", "2"}], "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"\[Eta]", "[", 
     RowBox[{"1", ",", "2"}], "]"}], "\[Rule]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.874687849248279*^9, 3.875032797047237*^9, 3.875033021737607*^9, 
   3.875284360294841*^9, {3.875284408508175*^9, 3.875284433610922*^9}, 
   3.8752845763894157`*^9, 3.875284846037657*^9, 3.875285465081026*^9, 
   3.875286464502411*^9, 3.875291577219926*^9, 3.8753579246241837`*^9, 
   3.875359229740596*^9},
 CellLabel->
  "Out[1967]=",ExpressionUUID->"3db87317-8d03-48fb-913d-bbc56d7f5ad1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"kbc13", "=", " ", 
   RowBox[{
    RowBox[{"FourierSinCoefficient", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"kbc", "[", 
        RowBox[{"[", "2", "]"}], "]"}], " ", "/.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"k", " ", "x"}], " ", "-", " ", 
          RowBox[{"omega", " ", "t"}]}], " ", "->", " ", "\[Theta]"}], 
        "}"}]}], ",", "\[Theta]", ",", "3"}], "]"}], " ", "==", " ", "0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dbc13", " ", "=", " ", 
   RowBox[{
    RowBox[{"FourierCosCoefficient", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"dbc", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "/.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"k", " ", "x"}], " ", "-", " ", 
          RowBox[{"omega", " ", "t"}]}], " ", "->", " ", "\[Theta]"}], 
        "}"}]}], ",", "\[Theta]", ",", "3"}], "]"}], " ", "==", " ", "0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"sol13", " ", "=", " ", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"kbc13", " ", "&&", " ", "dbc13"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"1", ",", "3"}], "]"}], ",", 
       RowBox[{"\[Eta]", "[", 
        RowBox[{"1", ",", "3"}], "]"}]}], "}"}]}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.873287455582718*^9, 3.873287458992227*^9}, {
   3.8732874964985332`*^9, 3.87328755922113*^9}, {3.873287886730433*^9, 
   3.873287887836314*^9}, {3.873288146483859*^9, 3.8732881496330233`*^9}, {
   3.8735598964639683`*^9, 3.873559896996579*^9}, {3.873803450935433*^9, 
   3.873803451655175*^9}, {3.873804396208559*^9, 3.873804396958515*^9}, {
   3.875032845048541*^9, 3.8750328614589863`*^9}, {3.875284444840452*^9, 
   3.87528447916602*^9}, {3.875285371241013*^9, 3.875285377957932*^9}, {
   3.875286406766611*^9, 3.875286407453126*^9}, 3.875291482753695*^9},
 CellLabel->
  "In[1968]:=",ExpressionUUID->"80023062-7256-40f5-ae9e-af9ea0aeac8d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Phi]", "[", 
     RowBox[{"1", ",", "3"}], "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"\[Eta]", "[", 
     RowBox[{"1", ",", "3"}], "]"}], "\[Rule]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{3.875032867220819*^9, 3.8750330266626883`*^9, 
  3.875284466448166*^9, 3.8752845815102882`*^9, 3.875284849630402*^9, 
  3.875285470190673*^9, 3.875286468818061*^9, 3.875291582001273*^9, 
  3.875357929491517*^9, 3.875359234674014*^9},
 CellLabel->
  "Out[1970]=",ExpressionUUID->"ef7575da-e248-4aad-b934-d5a05fc42bfb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Recompute", " ", "BC"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"kbc", "[", 
     RowBox[{"[", "2", "]"}], "]"}], " ", "==", " ", "0"}], " ", "/.", " ", 
   RowBox[{"Join", "[", 
    RowBox[{"sol11", ",", "sol12", ",", "sol13", ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"k", " ", "x"}], " ", "-", " ", 
        RowBox[{"omega", " ", "t"}]}], " ", "->", " ", "\[Theta]"}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.873287563387429*^9, 3.873287563861031*^9}, {
  3.873287952944936*^9, 3.873287967650855*^9}, {3.8732880043218603`*^9, 
  3.873288016273699*^9}, {3.873288085573702*^9, 3.873288178513015*^9}, {
  3.873803387905559*^9, 3.873803389729095*^9}, {3.87503372747782*^9, 
  3.875033751733492*^9}, {3.8752843697307167`*^9, 3.875284377809086*^9}, {
  3.87528443618465*^9, 3.875284436295027*^9}, {3.8752844872068777`*^9, 
  3.8752844884708557`*^9}, {3.875285644782097*^9, 3.8752857869771643`*^9}, {
  3.8752863615760202`*^9, 3.875286366677898*^9}, {3.8752864105088367`*^9, 
  3.87528648292939*^9}, {3.875291484931244*^9, 3.875291487385895*^9}},
 CellLabel->
  "In[1971]:=",ExpressionUUID->"566dc369-8ab9-41ab-8f9c-3c5d1db95472"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.8752912821060867`*^9, 3.875291582139587*^9, 
  3.875357929638125*^9, 3.8753592348226748`*^9},
 CellLabel->
  "Out[1971]=",ExpressionUUID->"79aca984-8611-405c-9924-12f0d92f68d8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Print", " ", "out", " ", "solution", " ", "so", " ", "far"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"phi", " ", "/.", " ", 
    RowBox[{"Join", "[", 
     RowBox[{"sol11", ",", "sol12", ",", "sol13", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"k", " ", "x"}], " ", "-", " ", 
         RowBox[{"omega", " ", "t"}]}], " ", "->", " ", "\[Theta]"}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Epsilon]", "^", "n_"}], "/;", 
         RowBox[{"n", ">=", "2"}]}], "->", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", " ", "->", " ", 
        RowBox[{"A", " ", "k"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"eta", " ", "/.", " ", 
    RowBox[{"Join", "[", 
     RowBox[{"sol11", ",", "sol12", ",", "sol13", ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"k", " ", "x"}], " ", "-", " ", 
         RowBox[{"omega", " ", "t"}]}], " ", "->", " ", "\[Theta]"}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Epsilon]", "^", "n_"}], "/;", 
         RowBox[{"n", ">=", "2"}]}], "->", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", " ", "->", " ", 
        RowBox[{"A", " ", "k"}]}], "}"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.875293174301044*^9, 3.875293273084236*^9}, {
  3.8752933737117167`*^9, 3.875293437759433*^9}, {3.8752934723613157`*^9, 
  3.8752934980264997`*^9}, {3.875293528276876*^9, 3.8752935436346684`*^9}, {
  3.875293606467104*^9, 3.8752936081526213`*^9}},
 CellLabel->
  "In[1972]:=",ExpressionUUID->"c40f17a5-fe34-476e-bd11-03345b1febd2"],

Cell[BoxData[
 FractionBox[
  RowBox[{"A", " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"k", " ", "z"}]], " ", 
   SqrtBox["g"], " ", 
   RowBox[{"Sin", "[", "\[Theta]", "]"}]}], 
  SqrtBox["k"]]], "Output",
 CellChangeTimes->{{3.8752932072196493`*^9, 3.875293235260563*^9}, 
   3.875293275310933*^9, 3.875293421838747*^9, {3.875293490196266*^9, 
   3.875293499055264*^9}, 3.8752935443129177`*^9, 3.875293608510353*^9, 
   3.875357929671734*^9, 3.875359234856497*^9},
 CellLabel->
  "Out[1972]=",ExpressionUUID->"678762bc-90f9-4250-94cf-5d65737817ee"],

Cell[BoxData[
 RowBox[{"A", " ", 
  RowBox[{"Cos", "[", "\[Theta]", "]"}]}]], "Output",
 CellChangeTimes->{{3.8752932072196493`*^9, 3.875293235260563*^9}, 
   3.875293275310933*^9, 3.875293421838747*^9, {3.875293490196266*^9, 
   3.875293499055264*^9}, 3.8752935443129177`*^9, 3.875293608510353*^9, 
   3.875357929671734*^9, 3.875359234876749*^9},
 CellLabel->
  "Out[1973]=",ExpressionUUID->"f8f18423-0e8c-4dfe-b06d-d025732bb3a6"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Knowing First Order Solution, Calculate Next Order", "Section",
 CellChangeTimes->{{3.875291287039701*^9, 
  3.875291301788931*^9}},ExpressionUUID->"280102cf-3c68-4a18-baa9-\
3286f4703e1d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"kbc22", " ", "=", " ", 
   RowBox[{
    RowBox[{"FourierSinCoefficient", "[", 
     RowBox[{
      RowBox[{"TrigReduce", "[", 
       RowBox[{
        RowBox[{"kbc", "[", 
         RowBox[{"[", "3", "]"}], "]"}], " ", "/.", " ", 
        RowBox[{"Join", "[", 
         RowBox[{"sol11", ",", "sol12", ",", "sol13", ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"k", " ", "x"}], " ", "-", " ", 
             RowBox[{"omega", " ", "t"}]}], " ", "->", " ", "\[Theta]"}], 
           "}"}]}], "]"}]}], "]"}], ",", "\[Theta]", ",", "2"}], "]"}], " ", "==",
     " ", "0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dbc22", " ", "=", " ", 
   RowBox[{
    RowBox[{"FourierCosCoefficient", "[", 
     RowBox[{
      RowBox[{"TrigReduce", "[", 
       RowBox[{
        RowBox[{"dbc", "[", 
         RowBox[{"[", "3", "]"}], "]"}], " ", "/.", " ", 
        RowBox[{"Join", "[", 
         RowBox[{"sol11", ",", "sol12", ",", "sol13", ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"k", " ", "x"}], " ", "-", " ", 
             RowBox[{"omega", " ", "t"}]}], " ", "->", " ", "\[Theta]"}], 
           "}"}]}], "]"}]}], "]"}], ",", "\[Theta]", ",", "2"}], "]"}], "==", 
    " ", "0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"sol22", " ", "=", " ", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"kbc22", " ", "&&", " ", "dbc22"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"2", ",", "2"}], "]"}], ",", 
       RowBox[{"\[Eta]", "[", 
        RowBox[{"2", ",", "2"}], "]"}]}], "}"}]}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.875291305363387*^9, 3.875291496489575*^9}, {
  3.87529171749648*^9, 3.8752917629918528`*^9}, {3.875291852660131*^9, 
  3.8752918582412777`*^9}, {3.875292503773485*^9, 3.875292507574005*^9}, {
  3.875292577250723*^9, 3.875292579873667*^9}, {3.8752926333022547`*^9, 
  3.8752926880871887`*^9}, {3.875292742133544*^9, 3.875292746566785*^9}, {
  3.875292835820755*^9, 3.875292836306888*^9}},
 CellLabel->
  "In[1974]:=",ExpressionUUID->"3cc05013-3a75-4c94-8359-6621ef659c2d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Phi]", "[", 
     RowBox[{"2", ",", "2"}], "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"\[Eta]", "[", 
     RowBox[{"2", ",", "2"}], "]"}], "\[Rule]", 
    FractionBox["1", 
     RowBox[{"2", " ", "k"}]]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.875291859929138*^9, 3.875292511123685*^9, 3.875292580625511*^9, {
   3.875292659253622*^9, 3.875292689320649*^9}, 3.8752927531654453`*^9, 
   3.875292842552437*^9, 3.8753579341276093`*^9, 3.875359239275737*^9},
 CellLabel->
  "Out[1976]=",ExpressionUUID->"7f1841b8-f8df-4425-8db8-0ecce47b5bd1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"kbc21", " ", "=", " ", 
   RowBox[{
    RowBox[{"FourierSinCoefficient", "[", 
     RowBox[{
      RowBox[{"TrigReduce", "[", 
       RowBox[{
        RowBox[{"kbc", "[", 
         RowBox[{"[", "3", "]"}], "]"}], " ", "/.", " ", 
        RowBox[{"Join", "[", 
         RowBox[{
         "sol11", ",", "sol12", ",", "sol13", ",", "sol22", ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"k", " ", "x"}], " ", "-", " ", 
             RowBox[{"omega", " ", "t"}]}], " ", "->", " ", "\[Theta]"}], 
           "}"}]}], "]"}]}], "]"}], ",", "\[Theta]", ",", "1"}], "]"}], " ", "==",
     " ", "0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dbc21", " ", "=", " ", 
   RowBox[{
    RowBox[{"FourierCosCoefficient", "[", 
     RowBox[{
      RowBox[{"TrigReduce", "[", 
       RowBox[{
        RowBox[{"dbc", "[", 
         RowBox[{"[", "3", "]"}], "]"}], " ", "/.", " ", 
        RowBox[{"Join", "[", 
         RowBox[{
         "sol11", ",", "sol12", ",", "sol13", ",", "sol22", ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"k", " ", "x"}], " ", "-", " ", 
             RowBox[{"omega", " ", "t"}]}], " ", "->", " ", "\[Theta]"}], 
           "}"}]}], "]"}]}], "]"}], ",", "\[Theta]", ",", "1"}], "]"}], "==", 
    " ", "0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sol21", " ", "=", " ", 
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"kbc21", " ", "&&", " ", "dbc21"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Phi]", "[", 
          RowBox[{"2", ",", "1"}], "]"}], ",", 
         RowBox[{"\[Omega]", "[", "1", "]"}]}], "}"}]}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "So", " ", "we", " ", "see", " ", "that", " ", "the", " ", "solution", 
     " ", "is", " ", "singular"}], ",", " ", 
    RowBox[{"any", " ", "value", " ", "would", " ", "work"}], ",", " ", 
    RowBox[{
     RowBox[{
     "so", " ", "set", " ", "to", " ", "0", "\[IndentingNewLine]", "We", " ", 
      "do", " ", "however", " ", "force", " ", 
      RowBox[{"\[Omega]", "[", "1", "]"}]}], "=", 
     RowBox[{"0", " ", "through", " ", "this", " ", "method"}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"sol21", " ", "=", " ", 
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"sol21", " ", "/.", " ", 
     RowBox[{
      RowBox[{"\[Eta]", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", "->", " ", "0"}]}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Eta]", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", "->", " ", "0"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.875290922270719*^9, 3.8752909236590157`*^9}, {
   3.8752918564793158`*^9, 3.875291877585485*^9}, {3.875291909233678*^9, 
   3.8752919140412083`*^9}, 3.8752919469433613`*^9, {3.87529209378881*^9, 
   3.875292098658739*^9}, {3.875292171897764*^9, 3.8752921802081337`*^9}, {
   3.875292233750374*^9, 3.875292242022305*^9}, {3.8752923033258753`*^9, 
   3.875292304404586*^9}, {3.875292712254387*^9, 3.8752927317083273`*^9}, {
   3.875292847427005*^9, 3.875293082497802*^9}},
 CellLabel->
  "In[1977]:=",ExpressionUUID->"8be3d68a-9c7b-4f3b-b6cd-5154ac6d4a48"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Phi]", "[", 
     RowBox[{"2", ",", "1"}], "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"\[Omega]", "[", "1", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"\[Eta]", "[", 
     RowBox[{"2", ",", "1"}], "]"}], "\[Rule]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.875291871774363*^9, 3.875291914582905*^9}, 
   3.875291947469183*^9, 3.8752920993530273`*^9, 3.8752921809809628`*^9, 
   3.87529224250915*^9, 3.8752927322246237`*^9, {3.8752928942528687`*^9, 
   3.875292934279708*^9}, 3.87529297247479*^9, {3.875293012737047*^9, 
   3.8752930682853413`*^9}, 3.87535793801587*^9, 3.8753592432075768`*^9},
 CellLabel->
  "Out[1980]=",ExpressionUUID->"06ab8acc-6aa0-41f6-8e57-1285e412ff61"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"kbc23", " ", "=", " ", 
   RowBox[{
    RowBox[{"FourierSinCoefficient", "[", 
     RowBox[{
      RowBox[{"TrigReduce", "[", 
       RowBox[{
        RowBox[{"kbc", "[", 
         RowBox[{"[", "3", "]"}], "]"}], " ", "/.", " ", 
        RowBox[{"Join", "[", 
         RowBox[{
         "sol11", ",", "sol12", ",", "sol13", ",", "sol22", ",", "sol21", ",",
           " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"k", " ", "x"}], " ", "-", " ", 
             RowBox[{"omega", " ", "t"}]}], " ", "->", " ", "\[Theta]"}], 
           "}"}]}], "]"}]}], "]"}], ",", "\[Theta]", ",", "3"}], "]"}], " ", "==",
     " ", "0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dbc23", " ", "=", " ", 
   RowBox[{
    RowBox[{"FourierCosCoefficient", "[", 
     RowBox[{
      RowBox[{"TrigReduce", "[", 
       RowBox[{
        RowBox[{"dbc", "[", 
         RowBox[{"[", "3", "]"}], "]"}], " ", "/.", " ", 
        RowBox[{"Join", "[", 
         RowBox[{
         "sol11", ",", "sol12", ",", "sol13", ",", "sol22", ",", "sol21", ",",
           " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"k", " ", "x"}], " ", "-", " ", 
             RowBox[{"omega", " ", "t"}]}], " ", "->", " ", "\[Theta]"}], 
           "}"}]}], "]"}]}], "]"}], ",", "\[Theta]", ",", "3"}], "]"}], "==", 
    " ", "0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"sol23", " ", "=", " ", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"kbc23", " ", "&&", " ", "dbc23"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"2", ",", "3"}], "]"}], ",", 
       RowBox[{"\[Eta]", "[", 
        RowBox[{"2", ",", "3"}], "]"}]}], "}"}]}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{
  3.873288091598976*^9, {3.8752911917315283`*^9, 3.875291271728312*^9}, {
   3.875291710866547*^9, 3.8752917145368233`*^9}, {3.875293087966942*^9, 
   3.875293153186049*^9}},
 CellLabel->
  "In[1981]:=",ExpressionUUID->"ce37bee1-f4dc-4fef-8753-ff09d1e68c21"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Phi]", "[", 
     RowBox[{"2", ",", "3"}], "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"\[Eta]", "[", 
     RowBox[{"2", ",", "3"}], "]"}], "\[Rule]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8732882108604116`*^9, 3.873288603111691*^9, 3.873288723756504*^9, 
   3.873289078683069*^9, 3.87328912466031*^9, 3.873290656313717*^9, 
   3.873290884645763*^9, 3.8732911545014477`*^9, 3.873292286474345*^9, {
   3.87330728638171*^9, 3.873307294042186*^9}, 3.873307358857826*^9, 
   3.873384829766713*^9, {3.8738034322022343`*^9, 3.873803476868877*^9}, 
   3.873803608693879*^9, 3.873804085190464*^9, 3.8738041340678797`*^9, 
   3.8738042144591303`*^9, 3.8738042847047663`*^9, 3.873804318764121*^9, 
   3.873804401398787*^9, 3.873816076551805*^9, 3.873822826546254*^9, 
   3.875033094637199*^9, 3.875284585177286*^9, 3.8752848525243597`*^9, 
   3.875285474085827*^9, {3.875291225167536*^9, 3.875291255895564*^9}, 
   3.875291586591704*^9, {3.875293140609418*^9, 3.875293161800667*^9}, 
   3.875357941748434*^9, 3.875359246869131*^9},
 CellLabel->
  "Out[1983]=",ExpressionUUID->"3236ed43-a0c8-4a7a-9795-f4ae1c06a851"]
}, Open  ]],

Cell["Let\[CloseCurlyQuote]s print out our solution to second order", "Text",
 CellChangeTimes->{{3.873288194319007*^9, 3.873288204583302*^9}, {
  3.8732882354873743`*^9, 3.873288238661471*^9}, {3.8732883508304157`*^9, 
  3.873288426311364*^9}, {3.8732884898688*^9, 3.873288496845263*^9}, {
  3.8732901628695383`*^9, 3.873290164510159*^9}, {3.875293288588838*^9, 
  3.8752932944818163`*^9}},ExpressionUUID->"f0f3b849-c736-4075-926a-\
fea16d52ef7a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"phi", " ", "/.", " ", 
  RowBox[{"Join", "[", 
   RowBox[{
   "sol11", ",", "sol12", ",", "sol13", ",", "sol21", ",", "sol22", ",", 
    "sol23", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"k", " ", "x"}], " ", "-", " ", 
       RowBox[{"omega", " ", "t"}]}], " ", "->", " ", "\[Theta]"}], "}"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Epsilon]", "^", "n_"}], "/;", 
       RowBox[{"n", ">=", "3"}]}], "->", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Epsilon]", " ", "->", " ", 
      RowBox[{"A", " ", "k"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"eta", " ", "/.", " ", 
  RowBox[{"Join", "[", 
   RowBox[{
   "sol11", ",", "sol12", ",", "sol13", ",", "sol21", ",", "sol22", ",", 
    "sol23", ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"k", " ", "x"}], " ", "-", " ", 
       RowBox[{"omega", " ", "t"}]}], " ", "->", " ", "\[Theta]"}], "}"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Epsilon]", "^", "n_"}], "/;", 
       RowBox[{"n", ">=", "3"}]}], "->", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Epsilon]", " ", "->", " ", 
      RowBox[{"A", " ", "k"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.873288502628001*^9, 3.873288572607266*^9}, {
   3.8732886331295424`*^9, 3.8732886554323893`*^9}, {3.873288692021409*^9, 
   3.873288693266102*^9}, 3.8732887309300127`*^9, {3.87328897639797*^9, 
   3.8732889786699257`*^9}, {3.8732890975809298`*^9, 3.873289099073709*^9}, {
   3.873804076387212*^9, 3.873804099426155*^9}, 3.8738041442653713`*^9, {
   3.8738042794450274`*^9, 3.873804281442089*^9}, {3.873804327857017*^9, 
   3.873804350266816*^9}, {3.8752933217242117`*^9, 3.8752933639524603`*^9}, {
   3.8752935617770243`*^9, 3.875293597952817*^9}},
 CellLabel->
  "In[1984]:=",ExpressionUUID->"282d3dcb-3bae-4527-990d-4678b1077e6e"],

Cell[BoxData[
 FractionBox[
  RowBox[{"A", " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"k", " ", "z"}]], " ", 
   SqrtBox["g"], " ", 
   RowBox[{"Sin", "[", "\[Theta]", "]"}]}], 
  SqrtBox["k"]]], "Output",
 CellChangeTimes->{
  3.873804145804431*^9, 3.873804214499374*^9, 3.873804284746687*^9, {
   3.873804323939165*^9, 3.8738043460899277`*^9}, 3.873804401423769*^9, 
   3.873816076608199*^9, 3.873822826605401*^9, 3.8750330947536783`*^9, 
   3.875284588736611*^9, 3.8752848552918673`*^9, 3.875285477778167*^9, 
   3.8752915901659613`*^9, 3.8752933647565823`*^9, {3.875293592006321*^9, 
   3.8752935984067507`*^9}, 3.875357941840089*^9, 3.8753592469561367`*^9},
 CellLabel->
  "Out[1984]=",ExpressionUUID->"f655cefb-59d4-4f84-9c8e-49b64154e974"],

Cell[BoxData[
 RowBox[{
  RowBox[{"A", " ", 
   RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   SuperscriptBox["A", "2"], " ", "k", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", "\[Theta]"}], "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.873804145804431*^9, 3.873804214499374*^9, 3.873804284746687*^9, {
   3.873804323939165*^9, 3.8738043460899277`*^9}, 3.873804401423769*^9, 
   3.873816076608199*^9, 3.873822826605401*^9, 3.8750330947536783`*^9, 
   3.875284588736611*^9, 3.8752848552918673`*^9, 3.875285477778167*^9, 
   3.8752915901659613`*^9, 3.8752933647565823`*^9, {3.875293592006321*^9, 
   3.8752935984067507`*^9}, 3.875357941840089*^9, 3.875359246972352*^9},
 CellLabel->
  "Out[1985]=",ExpressionUUID->"7bd4aa14-2b87-414c-9601-4b3125f40ee3"],

Cell[BoxData[
 TemplateBox[{
  "ReplaceAll", "reps", 
   "\"\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"Solve\\\", \\\"[\\\", \
RowBox[{\\\"True\\\", \\\",\\\", FractionBox[RowBox[{\\\"\[Omega]\\\", \\\" \
\\\", RowBox[{\\\"Cos\\\", \\\"[\\\", RowBox[{RowBox[{\\\"k\\\", \\\" \\\", \
\\\"x\\\"}], \\\"-\\\", RowBox[{\\\"t\\\", \\\" \\\", \\\"\[Omega]\\\"}]}], \
\\\"]\\\"}]}], \\\"g\\\"]}], \\\"]\\\"}], \\\"}\\\"}]\\) is neither a list of \
replacement rules nor a valid dispatch table, and so cannot be used for \
replacing.\"", 2, 524, 35, 29504127468218165255, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.87328864760608*^9, 3.873288665253942*^9}, 
   3.873804145810535*^9},
 CellLabel->
  "During evaluation of \
In[523]:=",ExpressionUUID->"aefff90d-d121-4e45-a5a6-29d02b0189f8"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "ivar", 
   "\"\\!\\(\\*FractionBox[RowBox[{\\\"\[Omega]\\\", \\\" \\\", \
RowBox[{\\\"Cos\\\", \\\"[\\\", RowBox[{RowBox[{\\\"k\\\", \\\" \\\", \\\"x\\\
\"}], \\\"-\\\", RowBox[{\\\"t\\\", \\\" \\\", \\\"\[Omega]\\\"}]}], \
\\\"]\\\"}]}], \\\"g\\\"]\\) is not a valid variable.\"", 2, 523, 34, 
   29504127468218165255, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.87328864760608*^9, 3.873288665253942*^9}, 
   3.873804145791415*^9},
 CellLabel->
  "During evaluation of \
In[523]:=",ExpressionUUID->"542c8d76-7afd-46a0-9947-092da6d47dcf"],

Cell[BoxData[
 TemplateBox[{
  "$RecursionLimit", "reclim2", 
   "\"Recursion depth of \\!\\(\\*RowBox[{\\\"1024\\\"}]\\) exceeded during \
evaluation of \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"\[Eta]\\\", \
\\\"[\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"x\\\", \\\",\\\", \\\"t\\\"}], \
\\\"]\\\"}], \\\"\[Rule]\\\", FractionBox[RowBox[{\\\"A\\\", \\\" \\\", \\\"\
\[Omega]\\\", \\\" \\\", RowBox[{\\\"Cos\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"k\\\", \\\" \\\", \\\"x\\\"}], \\\"-\\\", RowBox[{\\\"t\\\
\", \\\" \\\", \\\"\[Omega]\\\"}]}], \\\"]\\\"}]}], \\\"g\\\"]}], \\\"}\\\"}]\
\\).\"", 2, 1338, 168, 29496185747949257067, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.87328864760608*^9, 
  3.873288665253942*^9}},ExpressionUUID->"0bc749ca-81df-4d24-a782-\
bdd6058f14c7"],

Cell[BoxData[
 RowBox[{"Hold", "[", 
  RowBox[{
   RowBox[{"\[Eta]", "[", 
    RowBox[{"1", ",", "x", ",", "t"}], "]"}], "=", 
   RowBox[{"eta1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
  "]"}]], "Output",
 CellChangeTimes->{
  3.873288124291361*^9, 3.873288160571287*^9, 3.8732882054023323`*^9, 
   3.873288239188439*^9, 3.873288517323443*^9, {3.873288563440302*^9, 
   3.873288574575507*^9}, 3.873288606032444*^9, {3.873288647628718*^9, 
   3.873288656078002*^9}},
 CellLabel->
  "Out[1338]=",ExpressionUUID->"b4794b4d-b7cf-457d-b7cf-b7da0ea4e63a"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Knowing Second solution, can we get to 3rd order?", "Section",
 CellChangeTimes->{{3.873288612984063*^9, 3.8732886166893873`*^9}, {
  3.873288670488246*^9, 3.87328868469446*^9}, {3.873288739101612*^9, 
  3.873288745397089*^9}, {3.873288809179596*^9, 3.873288819858453*^9}, {
  3.873288891121681*^9, 3.873288982152445*^9}, {3.8732890166039953`*^9, 
  3.8732890598173447`*^9}, {3.873289189190447*^9, 3.873289209054446*^9}, {
  3.873289708913876*^9, 3.873289725948861*^9}, {3.873289959772946*^9, 
  3.873290032802484*^9}, {3.873290085424821*^9, 3.87329020888463*^9}, {
  3.8753562973122168`*^9, 
  3.875356304272232*^9}},ExpressionUUID->"7d3ad541-0dc3-494d-a7c8-\
19da8886e329"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"kbc33", " ", "=", " ", 
   RowBox[{
    RowBox[{"FourierSinCoefficient", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"kbc", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "/.", " ", 
       RowBox[{"Join", "[", 
        RowBox[{
        "sol11", ",", "sol12", ",", "sol13", ",", "sol22", ",", "sol21", ",", 
         "sol23", ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"k", " ", "x"}], " ", "-", " ", 
            RowBox[{"omega", " ", "t"}]}], " ", "->", " ", "\[Theta]"}], 
          "}"}]}], "]"}]}], ",", "\[Theta]", ",", "3"}], "]"}], " ", "==", 
    " ", "0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dbc33", " ", "=", " ", 
   RowBox[{
    RowBox[{"FourierCosCoefficient", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"dbc", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "/.", " ", 
       RowBox[{"Join", "[", 
        RowBox[{
        "sol11", ",", "sol12", ",", "sol13", ",", "sol22", ",", "sol21", ",", 
         "sol23", ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"k", " ", "x"}], " ", "-", " ", 
            RowBox[{"omega", " ", "t"}]}], " ", "->", " ", "\[Theta]"}], 
          "}"}]}], "]"}]}], ",", "\[Theta]", ",", "3"}], "]"}], " ", "==", 
    " ", "0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"sol33", " ", "=", " ", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"kbc33", " ", "&&", " ", "dbc33"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"3", ",", "3"}], "]"}], ",", 
       RowBox[{"\[Eta]", "[", 
        RowBox[{"3", ",", "3"}], "]"}]}], "}"}]}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8732902358060226`*^9, 3.873290599176958*^9}, {
  3.873290633279603*^9, 3.8732906710618467`*^9}, {3.873290740156164*^9, 
  3.873290742267352*^9}, {3.873290830049067*^9, 3.8732908920224247`*^9}, {
  3.8732909270582867`*^9, 3.873291149652454*^9}, {3.873291261993147*^9, 
  3.873291272018808*^9}, {3.873804054660864*^9, 3.873804055547867*^9}, {
  3.8738041944184427`*^9, 3.873804208077895*^9}, {3.873804290898246*^9, 
  3.873804292755726*^9}, {3.8738043616919622`*^9, 3.873804371422174*^9}, {
  3.873804410194829*^9, 3.873804413430113*^9}, {3.875356318372343*^9, 
  3.875356486898093*^9}, {3.875357255249954*^9, 3.8753572596006613`*^9}},
 CellLabel->
  "In[1986]:=",ExpressionUUID->"de2de41c-b57f-490c-967a-718f76d99e95"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Phi]", "[", 
     RowBox[{"3", ",", "3"}], "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"\[Eta]", "[", 
     RowBox[{"3", ",", "3"}], "]"}], "\[Rule]", 
    FractionBox["3", 
     RowBox[{"8", " ", "k"}]]}]}], "}"}]], "Output",
 CellChangeTimes->{3.875356495511466*^9, 3.875357946642769*^9, 
  3.875359251685789*^9},
 CellLabel->
  "Out[1988]=",ExpressionUUID->"48f9fd8c-87c4-4639-b45f-60474de1e13c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"kbc32", " ", "=", " ", 
   RowBox[{
    RowBox[{"FourierSinCoefficient", "[", 
     RowBox[{
      RowBox[{"TrigReduce", "[", 
       RowBox[{
        RowBox[{"kbc", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "/.", " ", 
        RowBox[{"Join", "[", 
         RowBox[{
         "sol11", ",", "sol12", ",", "sol13", ",", "sol22", ",", "sol21", ",",
           "sol23", ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"k", " ", "x"}], " ", "-", " ", 
             RowBox[{"omega", " ", "t"}]}], " ", "->", " ", "\[Theta]"}], 
           "}"}]}], "]"}]}], "]"}], ",", "\[Theta]", ",", "2"}], "]"}], " ", "==",
     " ", "0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dbc32", " ", "=", " ", 
   RowBox[{
    RowBox[{"FourierCosCoefficient", "[", 
     RowBox[{
      RowBox[{"TrigReduce", "[", 
       RowBox[{
        RowBox[{"dbc", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "/.", " ", 
        RowBox[{"Join", "[", 
         RowBox[{
         "sol11", ",", "sol12", ",", "sol13", ",", "sol22", ",", "sol21", ",",
           "sol23", ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"k", " ", "x"}], " ", "-", " ", 
             RowBox[{"omega", " ", "t"}]}], " ", "->", " ", "\[Theta]"}], 
           "}"}]}], "]"}]}], "]"}], ",", "\[Theta]", ",", "2"}], "]"}], " ", "==",
     " ", "0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sol32", " ", "=", " ", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"kbc32", " ", "&&", " ", "dbc32"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Phi]", "[", 
         RowBox[{"3", ",", "2"}], "]"}], ",", 
        RowBox[{"\[Eta]", "[", 
         RowBox[{"3", ",", "2"}], "]"}]}], "}"}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[LineSeparator]"}], "Input",
 CellChangeTimes->{{3.874781465585586*^9, 3.8747815305699787`*^9}, 
   3.875356473025941*^9, {3.8753565120664053`*^9, 3.87535656317776*^9}, {
   3.875357038009267*^9, 3.875357046927968*^9}, {3.8753570847517548`*^9, 
   3.8753572897291393`*^9}},
 CellLabel->
  "In[1989]:=",ExpressionUUID->"4d1e3475-2976-473b-8df6-30ef539a8d9e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Phi]", "[", 
     RowBox[{"3", ",", "2"}], "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"\[Eta]", "[", 
     RowBox[{"3", ",", "2"}], "]"}], "\[Rule]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8753570931092443`*^9, 3.875357133518032*^9, {3.875357192090056*^9, 
   3.875357237285965*^9}, 3.875357296214079*^9, 3.8753579512392397`*^9, 
   3.875359256280572*^9},
 CellLabel->
  "Out[1991]=",ExpressionUUID->"f16039d6-59cf-437b-b2fb-b5b67b4c8b78"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"kbc31", " ", "=", " ", 
   RowBox[{
    RowBox[{"FourierSinCoefficient", "[", 
     RowBox[{
      RowBox[{"TrigReduce", "[", 
       RowBox[{
        RowBox[{"kbc", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "/.", " ", 
        RowBox[{"Join", "[", 
         RowBox[{
         "sol11", ",", "sol12", ",", "sol13", ",", "sol22", ",", "sol21", ",",
           "sol23", ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"k", " ", "x"}], " ", "-", " ", 
             RowBox[{"omega", " ", "t"}]}], " ", "->", " ", "\[Theta]"}], 
           "}"}]}], "]"}]}], "]"}], ",", "\[Theta]", ",", "1"}], "]"}], " ", "==",
     " ", "0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dbc31", " ", "=", " ", 
   RowBox[{
    RowBox[{"FourierCosCoefficient", "[", 
     RowBox[{
      RowBox[{"TrigReduce", "[", 
       RowBox[{
        RowBox[{"dbc", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "/.", " ", 
        RowBox[{"Join", "[", 
         RowBox[{
         "sol11", ",", "sol12", ",", "sol13", ",", "sol22", ",", "sol21", ",",
           "sol23", ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"k", " ", "x"}], " ", "-", " ", 
             RowBox[{"omega", " ", "t"}]}], " ", "->", " ", "\[Theta]"}], 
           "}"}]}], "]"}]}], "]"}], ",", "\[Theta]", ",", "1"}], "]"}], " ", "==",
     " ", "0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sol31", " ", "=", " ", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"kbc31", " ", "&&", " ", "dbc31"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Eta]", "[", 
         RowBox[{"3", ",", "1"}], "]"}], ",", 
        RowBox[{"\[Omega]", "[", "2", "]"}]}], "}"}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"sol31", " ", "=", " ", 
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"sol31", " ", "/.", " ", 
     RowBox[{
      RowBox[{"\[Phi]", "[", 
       RowBox[{"3", ",", "1"}], "]"}], " ", "->", " ", "0"}]}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Phi]", "[", 
       RowBox[{"3", ",", "1"}], "]"}], " ", "->", " ", "0"}], "}"}]}], 
   "]"}]}], "\[LineSeparator]"}], "Input",
 CellChangeTimes->{{3.873307390996216*^9, 3.873307390998939*^9}, {
  3.874781538917095*^9, 3.874781681223793*^9}, {3.874781771678852*^9, 
  3.874781857619732*^9}, {3.874781917642064*^9, 3.874781955518512*^9}, {
  3.87478200533503*^9, 3.874782006260697*^9}, {3.874782040086083*^9, 
  3.874782074890362*^9}, {3.8747821055873547`*^9, 3.87478215267981*^9}, {
  3.8747821983683558`*^9, 3.874782223725559*^9}, {3.8747824679911823`*^9, 
  3.874782494972397*^9}, {3.8753573136609983`*^9, 3.8753573693887033`*^9}, {
  3.875357625716669*^9, 3.875357658682486*^9}},
 CellLabel->
  "In[1992]:=",ExpressionUUID->"7aed649f-08c5-44b0-a640-c83afa618a8a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Eta]", "[", 
     RowBox[{"3", ",", "1"}], "]"}], "\[Rule]", 
    FractionBox["1", 
     RowBox[{"8", " ", "k"}]]}], ",", 
   RowBox[{
    RowBox[{"\[Omega]", "[", "2", "]"}], "\[Rule]", 
    FractionBox[
     RowBox[{
      SqrtBox["g"], " ", 
      SqrtBox["k"]}], "2"]}], ",", 
   RowBox[{
    RowBox[{"\[Phi]", "[", 
     RowBox[{"3", ",", "1"}], "]"}], "\[Rule]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{3.875357955873554*^9, 3.875359260861211*^9},
 CellLabel->
  "Out[1995]=",ExpressionUUID->"60d1661a-e753-4c46-a234-d719706a4f29"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Printint", " ", "our", " ", "solution", " ", "to", " ", "3", "rd", " ", 
    "order"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"phi", " ", "/.", " ", 
    RowBox[{"Join", "[", 
     RowBox[{
     "sol11", ",", "sol12", ",", "sol13", ",", "sol21", ",", "sol22", ",", 
      "sol23", ",", "sol31", ",", "sol32", ",", "sol33", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"k", " ", "x"}], " ", "-", " ", 
         RowBox[{"omega", " ", "t"}]}], " ", "->", " ", "\[Theta]"}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Epsilon]", "^", "n_"}], "/;", 
         RowBox[{"n", ">=", "4"}]}], "->", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", " ", "->", " ", 
        RowBox[{"A", " ", "k"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"eta", " ", "/.", " ", 
    RowBox[{"Join", "[", 
     RowBox[{
     "sol11", ",", "sol12", ",", "sol13", ",", "sol21", ",", "sol22", ",", 
      "sol23", ",", "sol31", ",", "sol32", ",", "sol33", ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"k", " ", "x"}], " ", "-", " ", 
         RowBox[{"omega", " ", "t"}]}], " ", "->", " ", "\[Theta]"}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Epsilon]", "^", "n_"}], "/;", 
         RowBox[{"n", ">=", "4"}]}], "->", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", " ", "->", " ", 
        RowBox[{"A", " ", "k"}]}], "}"}]}], "]"}]}]}]}]], "Text", "Input",
 CellChangeTimes->{{3.875357715085456*^9, 3.8753578113816557`*^9}},
 CellLabel->
  "In[1996]:=",ExpressionUUID->"d1f86c52-7ddf-4d55-9c7f-46463580375c"],

Cell[BoxData[
 FractionBox[
  RowBox[{"A", " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"k", " ", "z"}]], " ", 
   SqrtBox["g"], " ", 
   RowBox[{"Sin", "[", "\[Theta]", "]"}]}], 
  SqrtBox["k"]]], "Output",
 CellChangeTimes->{
  3.875357667143911*^9, {3.875357771775195*^9, 3.875357781558053*^9}, 
   3.8753578358980083`*^9, 3.875357955958335*^9, 3.8753592609517097`*^9},
 CellLabel->
  "Out[1996]=",ExpressionUUID->"f5d95681-8ae4-4e59-8bf7-4a83bd25bc29"],

Cell[BoxData[
 RowBox[{
  RowBox[{"A", " ", 
   RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   SuperscriptBox["A", "3"], " ", 
   SuperscriptBox["k", "2"], " ", 
   RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   SuperscriptBox["A", "2"], " ", "k", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", "\[Theta]"}], "]"}]}], "+", 
  RowBox[{
   FractionBox["3", "8"], " ", 
   SuperscriptBox["A", "3"], " ", 
   SuperscriptBox["k", "2"], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"3", " ", "\[Theta]"}], "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.875357667143911*^9, {3.875357771775195*^9, 3.875357781558053*^9}, 
   3.8753578358980083`*^9, 3.875357955958335*^9, 3.875359260967504*^9},
 CellLabel->
  "Out[1997]=",ExpressionUUID->"6e7b6a34-86a9-496a-9e30-58e9b8da0678"]
}, Open  ]],

Cell[BoxData[""], "Text", "Input",
 CellChangeTimes->{
  3.8753576232304487`*^9, 3.875357661423891*^9, {3.875357697341363*^9, 
   3.8753577093108873`*^9}},
 CellLabel->
  "In[1998]:=",ExpressionUUID->"866d3bef-4a28-41ea-963b-dd4ff4352543"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plot Results", "Section",
 CellChangeTimes->{{3.872693617220345*^9, 3.8726936182989283`*^9}, {
  3.873197117713191*^9, 3.873197134126687*^9}, {3.8732863821721287`*^9, 
  3.873286383468438*^9}, {3.875358713790161*^9, 
  3.8753587159420137`*^9}},ExpressionUUID->"7482126b-1ebb-48d4-a4e9-\
e393e6739f5d"],

Cell["Given our results, what does the sea surface look like?", "Text",
 CellChangeTimes->{{3.8731971443499613`*^9, 3.8731971868020487`*^9}, {
  3.873197224451056*^9, 3.873197265875926*^9}, {3.8732913273108873`*^9, 
  3.873291331230732*^9}, {3.875358725406192*^9, 
  3.875358734469665*^9}},ExpressionUUID->"26b0bbb3-f100-40c8-a921-\
d8f7616718ba"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"A_", ",", "x_", ",", "t_"}], "]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"eta", " ", "/.", " ", 
      RowBox[{"Join", "[", 
       RowBox[{
       "sol11", ",", "sol12", ",", "sol13", ",", "sol21", ",", "sol22", ",", 
        "sol23", ",", "sol31", ",", "sol32", ",", "sol33", ",", 
        RowBox[{"{", 
         RowBox[{"\[Epsilon]", " ", "->", " ", 
          RowBox[{"A", " ", "k"}]}], "}"}]}], "]"}]}], " ", "/.", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"g", " ", "->", " ", "9.81"}], ",", 
       RowBox[{"k", "->", "1"}]}], "}"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Plot", "[", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"A", ",", "x", ",", "t"}], "]"}], " ", "/.", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"t", "->", "0"}], ",", 
        RowBox[{"A", "->", "0.1"}]}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", 
       RowBox[{"2", " ", "Pi"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"A", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "5"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.873197271803306*^9, 3.873197342592513*^9}, {
   3.873197497268159*^9, 3.873197500068378*^9}, {3.8731982075663347`*^9, 
   3.873198207627133*^9}, {3.873216492561418*^9, 3.873216492976789*^9}, 
   3.873290870180469*^9, {3.875358758293648*^9, 3.875358774916892*^9}, {
   3.875358971708621*^9, 3.87535910965837*^9}, 3.8753591425467453`*^9, {
   3.875359354530321*^9, 3.875359384084262*^9}, {3.875359441380932*^9, 
   3.8753594442709312`*^9}, {3.8753594881087503`*^9, 3.875359492972872*^9}, {
   3.875359547276473*^9, 3.875359560291024*^9}, {3.8753596064171267`*^9, 
   3.875359607349155*^9}, {3.87535966769526*^9, 3.875359699548078*^9}, 
   3.875359738449874*^9, {3.875359792092958*^9, 3.875359842115233*^9}, {
   3.875360296331098*^9, 3.875360323058085*^9}, {3.8753603660270576`*^9, 
   3.875360370481099*^9}, {3.875362885964862*^9, 3.87536290490809*^9}, {
   3.875362935829068*^9, 3.875363091662945*^9}},
 CellLabel->
  "In[2056]:=",ExpressionUUID->"8e432576-bdbd-4270-b8c2-989a518a0eae"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`A$$ = 
    0.12799999999999995`, $CellContext`t$$ = 0.99, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`A$$], 0, 1}, {
      Hold[$CellContext`t$$], 0, 5}}, Typeset`size$$ = {360., {105., 110.}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = True}, 
    
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`A$$ = 0, $CellContext`t$$ = 0}, 
      "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Plot[
        ReplaceAll[
         $CellContext`f[$CellContext`A$$, $CellContext`x, $CellContext`t$$], \
{$CellContext`t$$ -> 0, $CellContext`A$$ -> 0.1}], {$CellContext`x, 0, 2 Pi}],
       "Specifications" :> {{$CellContext`A$$, 0, 1}, {$CellContext`t$$, 0, 
         5}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{404., {178., 183.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.875360323581093*^9, {3.8753628906347723`*^9, 3.8753629057735033`*^9}, {
   3.875362936378765*^9, 3.875362950290545*^9}, {3.875362992586327*^9, 
   3.875363098256971*^9}},
 CellLabel->
  "Out[2057]=",ExpressionUUID->"7cb71671-22c2-434c-a8eb-d7e4bcd9d7a0"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.873197353316656*^9, 3.8731974174936457`*^9}, {
   3.87319821070885*^9, 3.8731982124354563`*^9}, {3.873216496495124*^9, 
   3.8732164969845448`*^9}, 3.873290868067608*^9},
 CellLabel->
  "In[2001]:=",ExpressionUUID->"78464b50-4f75-459b-b2ba-794dd084b928"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8731974260662403`*^9, 3.87319742842131*^9}, {
   3.8731975483140993`*^9, 3.8731975680444613`*^9}, {3.873197657568778*^9, 
   3.87319766486976*^9}, 3.875358739196987*^9},
 CellLabel->
  "In[2002]:=",ExpressionUUID->"e2800158-3cd5-4c50-8c9f-120860157783"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"kbc", "[", 
    RowBox[{"[", "3", "]"}], "]"}], " ", "==", " ", "0"}], "]"}]], "Input",
 CellChangeTimes->{{3.8731975711334133`*^9, 3.873197582360099*^9}, {
  3.873197671172983*^9, 3.873197671861027*^9}, {3.8731982255315523`*^9, 
  3.873198244834237*^9}},
 CellLabel->
  "In[2003]:=",ExpressionUUID->"f01e29bf-10de-43b7-af62-538c0c39958a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "k"], 
   RowBox[{
    RowBox[{"Sin", "[", 
     RowBox[{
      RowBox[{"k", " ", "x"}], "-", 
      RowBox[{"t", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
         RowBox[{"\[Epsilon]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Omega]", "[", "1", "]"}], "+", 
            RowBox[{"\[Epsilon]", " ", 
             RowBox[{"\[Omega]", "[", "2", "]"}]}]}], ")"}]}]}], ")"}]}]}], 
     "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       SuperscriptBox["k", "3"], " ", 
       RowBox[{"\[Eta]", "[", 
        RowBox[{"1", ",", "2"}], "]"}], " ", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"1", ",", "1"}], "]"}]}], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox["k", "3"], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"3", " ", "k", " ", "x"}], "-", 
         RowBox[{"3", " ", "t", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
            RowBox[{"\[Epsilon]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Omega]", "[", "1", "]"}], "+", 
               RowBox[{"\[Epsilon]", " ", 
                RowBox[{"\[Omega]", "[", "2", "]"}]}]}], ")"}]}]}], ")"}]}]}],
         "]"}], " ", 
       RowBox[{"\[Eta]", "[", 
        RowBox[{"1", ",", "3"}], "]"}], " ", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"1", ",", "1"}], "]"}]}], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox["k", "2"], " ", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"1", ",", "2"}], "]"}]}], "+", 
      RowBox[{"8", " ", 
       SuperscriptBox["k", "3"], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"3", " ", "k", " ", "x"}], "-", 
         RowBox[{"3", " ", "t", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
            RowBox[{"\[Epsilon]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Omega]", "[", "1", "]"}], "+", 
               RowBox[{"\[Epsilon]", " ", 
                RowBox[{"\[Omega]", "[", "2", "]"}]}]}], ")"}]}]}], ")"}]}]}],
         "]"}], " ", 
       RowBox[{"\[Eta]", "[", 
        RowBox[{"1", ",", "2"}], "]"}], " ", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"1", ",", "2"}], "]"}]}], "+", 
      RowBox[{"6", " ", 
       SuperscriptBox["k", "3"], " ", 
       RowBox[{"\[Eta]", "[", 
        RowBox[{"1", ",", "3"}], "]"}], " ", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"1", ",", "2"}], "]"}]}], "+", 
      RowBox[{"10", " ", 
       SuperscriptBox["k", "3"], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"4", " ", "k", " ", "x"}], "-", 
         RowBox[{"4", " ", "t", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
            RowBox[{"\[Epsilon]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Omega]", "[", "1", "]"}], "+", 
               RowBox[{"\[Epsilon]", " ", 
                RowBox[{"\[Omega]", "[", "2", "]"}]}]}], ")"}]}]}], ")"}]}]}],
         "]"}], " ", 
       RowBox[{"\[Eta]", "[", 
        RowBox[{"1", ",", "3"}], "]"}], " ", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"1", ",", "2"}], "]"}]}], "+", 
      RowBox[{"12", " ", 
       SuperscriptBox["k", "2"], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"3", " ", "k", " ", "x"}], "-", 
         RowBox[{"3", " ", "t", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
            RowBox[{"\[Epsilon]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Omega]", "[", "1", "]"}], "+", 
               RowBox[{"\[Epsilon]", " ", 
                RowBox[{"\[Omega]", "[", "2", "]"}]}]}], ")"}]}]}], ")"}]}]}],
         "]"}], " ", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"1", ",", "3"}], "]"}]}], "+", 
      RowBox[{"9", " ", 
       SuperscriptBox["k", "3"], " ", 
       RowBox[{"\[Eta]", "[", 
        RowBox[{"1", ",", "2"}], "]"}], " ", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"1", ",", "3"}], "]"}]}], "+", 
      RowBox[{"15", " ", 
       SuperscriptBox["k", "3"], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"4", " ", "k", " ", "x"}], "-", 
         RowBox[{"4", " ", "t", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
            RowBox[{"\[Epsilon]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Omega]", "[", "1", "]"}], "+", 
               RowBox[{"\[Epsilon]", " ", 
                RowBox[{"\[Omega]", "[", "2", "]"}]}]}], ")"}]}]}], ")"}]}]}],
         "]"}], " ", 
       RowBox[{"\[Eta]", "[", 
        RowBox[{"1", ",", "2"}], "]"}], " ", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"1", ",", "3"}], "]"}]}], "+", 
      RowBox[{"18", " ", 
       SuperscriptBox["k", "3"], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"5", " ", "k", " ", "x"}], "-", 
         RowBox[{"5", " ", "t", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
            RowBox[{"\[Epsilon]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Omega]", "[", "1", "]"}], "+", 
               RowBox[{"\[Epsilon]", " ", 
                RowBox[{"\[Omega]", "[", "2", "]"}]}]}], ")"}]}]}], ")"}]}]}],
         "]"}], " ", 
       RowBox[{"\[Eta]", "[", 
        RowBox[{"1", ",", "3"}], "]"}], " ", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"1", ",", "3"}], "]"}]}], "+", 
      RowBox[{"18", " ", 
       SuperscriptBox["k", "3"], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"3", " ", "k", " ", "x"}], "-", 
         RowBox[{"3", " ", "t", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
            RowBox[{"\[Epsilon]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Omega]", "[", "1", "]"}], "+", 
               RowBox[{"\[Epsilon]", " ", 
                RowBox[{"\[Omega]", "[", "2", "]"}]}]}], ")"}]}]}], ")"}]}]}],
         "]"}], " ", 
       RowBox[{"\[Eta]", "[", 
        RowBox[{"1", ",", "3"}], "]"}], " ", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"1", ",", "3"}], "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["k", "2"], " ", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"2", ",", "1"}], "]"}]}], "+", 
      RowBox[{"3", " ", 
       SuperscriptBox["k", "2"], " ", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"2", ",", "3"}], "]"}]}], "-", 
      RowBox[{"k", " ", 
       RowBox[{"\[Eta]", "[", 
        RowBox[{"2", ",", "1"}], "]"}], " ", 
       RowBox[{"\[Omega]", "[", "0", "]"}]}], "-", 
      RowBox[{"3", " ", "k", " ", 
       RowBox[{"\[Eta]", "[", 
        RowBox[{"2", ",", "3"}], "]"}], " ", 
       RowBox[{"\[Omega]", "[", "0", "]"}]}], "-", 
      RowBox[{"\[Omega]", "[", "1", "]"}], "-", 
      RowBox[{"3", " ", "k", " ", 
       RowBox[{"\[Eta]", "[", 
        RowBox[{"1", ",", "3"}], "]"}], " ", 
       RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
      RowBox[{"2", " ", "k", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"k", " ", "x"}], "-", 
         RowBox[{"t", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
            RowBox[{"\[Epsilon]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Omega]", "[", "1", "]"}], "+", 
               RowBox[{"\[Epsilon]", " ", 
                RowBox[{"\[Omega]", "[", "2", "]"}]}]}], ")"}]}]}], ")"}]}]}],
         "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["k", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", 
             RowBox[{"\[Eta]", "[", 
              RowBox[{"1", ",", "2"}], "]"}], " ", 
             RowBox[{"\[Phi]", "[", 
              RowBox[{"1", ",", "2"}], "]"}]}], "+", 
            RowBox[{"3", " ", 
             RowBox[{"\[Eta]", "[", 
              RowBox[{"1", ",", "3"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Phi]", "[", 
                RowBox[{"1", ",", "1"}], "]"}], "+", 
               RowBox[{"3", " ", 
                RowBox[{"\[Phi]", "[", 
                 RowBox[{"1", ",", "3"}], "]"}]}]}], ")"}]}]}], ")"}]}], "+", 
         
         RowBox[{"k", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Phi]", "[", 
             RowBox[{"1", ",", "1"}], "]"}], "+", 
            RowBox[{"9", " ", 
             RowBox[{"\[Phi]", "[", 
              RowBox[{"1", ",", "3"}], "]"}]}], "+", 
            RowBox[{"2", " ", 
             RowBox[{"\[Phi]", "[", 
              RowBox[{"2", ",", "2"}], "]"}]}]}], ")"}]}], "-", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Eta]", "[", 
              RowBox[{"2", ",", "2"}], "]"}], " ", 
             RowBox[{"\[Omega]", "[", "0", "]"}]}], "+", 
            RowBox[{
             RowBox[{"\[Eta]", "[", 
              RowBox[{"1", ",", "2"}], "]"}], " ", 
             RowBox[{"\[Omega]", "[", "1", "]"}]}]}], ")"}]}]}], ")"}]}], "+", 
      RowBox[{"k", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"2", " ", "k", " ", "x"}], "-", 
         RowBox[{"2", " ", "t", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
            RowBox[{"\[Epsilon]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Omega]", "[", "1", "]"}], "+", 
               RowBox[{"\[Epsilon]", " ", 
                RowBox[{"\[Omega]", "[", "2", "]"}]}]}], ")"}]}]}], ")"}]}]}],
         "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["k", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"10", " ", 
             RowBox[{"\[Eta]", "[", 
              RowBox[{"1", ",", "3"}], "]"}], " ", 
             RowBox[{"\[Phi]", "[", 
              RowBox[{"1", ",", "2"}], "]"}]}], "+", 
            RowBox[{"3", " ", 
             RowBox[{"\[Eta]", "[", 
              RowBox[{"1", ",", "2"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Phi]", "[", 
                RowBox[{"1", ",", "1"}], "]"}], "+", 
               RowBox[{"5", " ", 
                RowBox[{"\[Phi]", "[", 
                 RowBox[{"1", ",", "3"}], "]"}]}]}], ")"}]}]}], ")"}]}], "+", 
         
         RowBox[{"6", " ", "k", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Phi]", "[", 
             RowBox[{"1", ",", "2"}], "]"}], "+", 
            RowBox[{"\[Phi]", "[", 
             RowBox[{"2", ",", "3"}], "]"}]}], ")"}]}], "-", 
         RowBox[{"6", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Eta]", "[", 
              RowBox[{"2", ",", "3"}], "]"}], " ", 
             RowBox[{"\[Omega]", "[", "0", "]"}]}], "+", 
            RowBox[{
             RowBox[{"\[Eta]", "[", 
              RowBox[{"1", ",", "3"}], "]"}], " ", 
             RowBox[{"\[Omega]", "[", "1", "]"}]}]}], ")"}]}]}], ")"}]}]}], 
     ")"}]}]}], "\[Equal]", "0"}]], "Output",
 CellChangeTimes->{
  3.873197603503313*^9, 3.8731976358140163`*^9, 3.8731976729521523`*^9, {
   3.873198221487949*^9, 3.8731982453287287`*^9}, 3.873216253042474*^9, 
   3.8732165042358303`*^9, 3.873290656660555*^9, 3.8732908850221167`*^9, 
   3.873291154872089*^9, 3.873292286858767*^9, {3.873307286705958*^9, 
   3.873307294391824*^9}, 3.873307359109521*^9, 3.873384830075871*^9, {
   3.873803432441731*^9, 3.8738034770235023`*^9}, 3.873803608846395*^9, 
   3.873804085367826*^9, 3.873804214631065*^9, 3.873804284885592*^9, 
   3.8738044016944847`*^9, 3.8738160768611794`*^9, 3.873822826888999*^9, 
   3.8750334083833027`*^9, 3.875284591831863*^9, 3.875284857381078*^9, 
   3.875285629540905*^9, 3.875291851201194*^9, 3.875358274137836*^9, 
   3.875359296361978*^9},
 CellLabel->
  "Out[2003]=",ExpressionUUID->"c0056f70-0b22-41d7-ab5a-1acd07398b6f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"dbc", " ", "=", " ", 
   RowBox[{"CoefficientList", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Taylor", "[", 
        RowBox[{"D", "[", 
         RowBox[{"phi", ",", "t"}], "]"}], "]"}], " ", "+", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", "2"}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Taylor", "[", 
            RowBox[{"D", "[", 
             RowBox[{"phi", ",", "x"}], "]"}], "]"}], "^", "2"}], " ", "+", 
          " ", 
          RowBox[{
           RowBox[{"Taylor", "[", 
            RowBox[{"D", "[", 
             RowBox[{"phi", ",", "z"}], "]"}], "]"}], "^", "2"}]}], ")"}]}], 
       " ", "+", " ", 
       RowBox[{"g", "*", "eta"}]}], " ", "/.", " ", 
      RowBox[{"z", "->", " ", "0"}]}], ",", "\[Epsilon]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"dbc", "[", 
        RowBox[{"[", "3", "]"}], "]"}], " ", "==", " ", "0"}], " ", "/.", " ", 
      RowBox[{"\[Omega]", " ", "->", " ", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"g", " ", "k"}], "]"}]}]}], "]"}], " ", "/.", " ", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{"g", " ", "k"}], "]"}], " ", "->", " ", "\[Omega]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"bc2", " ", "=", 
  RowBox[{
   RowBox[{"Assuming", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"k", " ", "!=", " ", "0"}], " ", "&&", " ", 
      RowBox[{"g", " ", "!=", " ", "0"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"Simplify", "[", 
       RowBox[{
        RowBox[{"Eliminate", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"dbc", "[", 
                RowBox[{"[", "3", "]"}], "]"}], ",", "t"}], "]"}], "==", 
             "0"}], ",", 
            RowBox[{
             RowBox[{"kbc", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "==", "0"}]}], "}"}], ",", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"\[Eta]", "[", 
             RowBox[{"2", ",", "x", ",", "t"}], "]"}], ",", "t"}], "]"}]}], 
         "]"}], " ", "/.", " ", 
        RowBox[{"\[Omega]", " ", "->", " ", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"g", " ", "k"}], "]"}]}]}], "]"}], "}"}]}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.873197620138723*^9, 3.873197627918486*^9}, {
  3.873199725856077*^9, 3.8731997278308277`*^9}, {3.87321489451473*^9, 
  3.873214909454652*^9}, {3.8732152730745277`*^9, 3.873215278160652*^9}, {
  3.873216374874628*^9, 3.873216376961013*^9}, {3.873291354525922*^9, 
  3.873291382284927*^9}, {3.873292250052804*^9, 3.8732922505102453`*^9}, {
  3.873293005654513*^9, 3.873293171513871*^9}, {3.873293841330463*^9, 
  3.8732938778925533`*^9}, {3.873305178760812*^9, 3.873305210519382*^9}, {
  3.873305917365736*^9, 3.87330625031677*^9}, {3.873306280940248*^9, 
  3.8733063388338223`*^9}, {3.873803397954548*^9, 3.873803401281323*^9}},
 CellLabel->
  "In[2004]:=",ExpressionUUID->"fdb0cb0d-31d8-416d-91f9-2a1de88543b2"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{
  3.87330721876647*^9, {3.873307286860201*^9, 3.8733072945439034`*^9}, 
   3.873307359338399*^9, 3.8733848302119293`*^9, {3.873803432493154*^9, 
   3.873803477072462*^9}, 3.873803608892859*^9, 3.8738040854144506`*^9, 
   3.8738042146785994`*^9, 3.8738042849291687`*^9, 3.873804401895404*^9, 
   3.873816077026909*^9, 3.873822827110721*^9, 3.875033747519326*^9, 
   3.8752847546442738`*^9, 3.875284899061304*^9, 3.875358819928681*^9, 
   3.87535934179652*^9},
 CellLabel->
  "Out[2004]=",ExpressionUUID->"9965fb58-e465-4a59-b801-2eda68a6dd8e"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{
  3.87330721876647*^9, {3.873307286860201*^9, 3.8733072945439034`*^9}, 
   3.873307359338399*^9, 3.8733848302119293`*^9, {3.873803432493154*^9, 
   3.873803477072462*^9}, 3.873803608892859*^9, 3.8738040854144506`*^9, 
   3.8738042146785994`*^9, 3.8738042849291687`*^9, 3.873804401895404*^9, 
   3.873816077026909*^9, 3.873822827110721*^9, 3.875033747519326*^9, 
   3.8752847546442738`*^9, 3.875284899061304*^9, 3.875358819928681*^9, 
   3.8753593526064262`*^9},
 CellLabel->
  "Out[2005]=",ExpressionUUID->"dc51f159-6f61-40d1-88b6-99dcce62c574"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{
  3.87330721876647*^9, {3.873307286860201*^9, 3.8733072945439034`*^9}, 
   3.873307359338399*^9, 3.8733848302119293`*^9, {3.873803432493154*^9, 
   3.873803477072462*^9}, 3.873803608892859*^9, 3.8738040854144506`*^9, 
   3.8738042146785994`*^9, 3.8738042849291687`*^9, 3.873804401895404*^9, 
   3.873816077026909*^9, 3.873822827110721*^9, 3.875033747519326*^9, 
   3.8752847546442738`*^9, 3.875284899061304*^9, 3.875358819928681*^9, 
   3.875359439509363*^9},
 CellLabel->
  "Out[2006]=",ExpressionUUID->"2282210a-268d-4d69-98f7-8fb78dc30c98"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Solving For Second Solution", "Section",
 CellChangeTimes->{{3.873307208095193*^9, 
  3.873307216475486*^9}},ExpressionUUID->"49ce2238-68a3-4723-898e-\
dbb6fd81056c"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.873307386370882*^9, 3.873307386373726*^9}},
 CellLabel->
  "In[1572]:=",ExpressionUUID->"856f20d0-34e1-432f-af91-14bcd53ed645"],

Cell["\<\
Once again, we can assume the classic solution for \[Phi]2, assuming a \
Fourier sine series\
\>", "Text",
 CellChangeTimes->{{3.873306512105328*^9, 3.873306533418418*^9}, {
  3.8733846318032703`*^9, 
  3.873384637627247*^9}},ExpressionUUID->"570a3c73-9078-43e9-bdbf-\
ec78f7814338"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]", "[", 
    RowBox[{"2", ",", "x", ",", "z", ",", "t"}], "]"}], " ", "=", " ", 
   RowBox[{"B", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"2", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"k", " ", "x"}], " ", "-", " ", 
        RowBox[{"\[Omega]", " ", "t"}]}], ")"}]}], "]"}], " ", 
    RowBox[{"Exp", "[", " ", 
     RowBox[{"2", "k", " ", "z"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kbc", " ", "=", " ", 
   RowBox[{"CoefficientList", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"eta", ",", "t"}], "]"}], " ", "+", " ", 
       RowBox[{
        RowBox[{"Taylor", "[", 
         RowBox[{"D", "[", 
          RowBox[{"phi", ",", "x"}], "]"}], "]"}], 
        RowBox[{"D", "[", 
         RowBox[{"eta", ",", "x"}], "]"}]}], " ", "-", " ", 
       RowBox[{"Taylor", "[", 
        RowBox[{"D", "[", 
         RowBox[{"phi", ",", "z"}], "]"}], "]"}]}], " ", "/.", " ", 
      RowBox[{"z", "->", "0"}]}], ",", "\[Epsilon]"}], "]"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dbc", " ", "=", " ", 
   RowBox[{"CoefficientList", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Taylor", "[", 
        RowBox[{"D", "[", 
         RowBox[{"phi", ",", "t"}], "]"}], "]"}], " ", "+", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", "2"}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Taylor", "[", 
            RowBox[{"D", "[", 
             RowBox[{"phi", ",", "x"}], "]"}], "]"}], "^", "2"}], " ", "+", 
          " ", 
          RowBox[{
           RowBox[{"Taylor", "[", 
            RowBox[{"D", "[", 
             RowBox[{"phi", ",", "z"}], "]"}], "]"}], "^", "2"}]}], ")"}]}], 
       " ", "+", " ", 
       RowBox[{"g", "*", "eta"}]}], " ", "/.", " ", 
      RowBox[{"z", "->", " ", "0"}]}], ",", "\[Epsilon]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"bc2", " ", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"Assuming", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"k", " ", "!=", " ", "0"}], " ", "&&", " ", 
         RowBox[{"g", " ", "!=", " ", "0"}], " ", "&&", " ", 
         RowBox[{"\[Omega]", " ", "!=", " ", "0"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"Simplify", "[", 
          RowBox[{"Eliminate", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"dbc", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], ",", "t"}], "]"}], "==", 
               "0"}], ",", 
              RowBox[{
               RowBox[{"kbc", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "==", "0"}]}], "}"}], ",", 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"\[Eta]", "[", 
               RowBox[{"2", ",", "x", ",", "t"}], "]"}], ",", "t"}], "]"}]}], 
           "]"}], " ", "]"}], "}"}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], " ", "/.", " ", 
     RowBox[{"\[Omega]", " ", "->", " ", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"g", " ", "k"}], "]"}]}]}], ")"}], "/.", " ", 
   RowBox[{
    RowBox[{"Sqrt", "[", 
     RowBox[{"g", " ", "k"}], "]"}], " ", "->", " ", 
    "\[Omega]"}]}]}]}], "Input",
 CellChangeTimes->{{3.873306545263898*^9, 3.873306545271605*^9}, {
  3.873306618400363*^9, 3.873306689293696*^9}, {3.873306724793344*^9, 
  3.87330677671513*^9}, {3.873371878572481*^9, 3.873371912529579*^9}, {
  3.87337198876084*^9, 3.87337201091063*^9}, {3.873384046264184*^9, 
  3.873384048488378*^9}, {3.873384140421955*^9, 3.8733841419910307`*^9}, {
  3.87338419383709*^9, 3.8733841947729473`*^9}, {3.873384508594048*^9, 
  3.873384520570312*^9}, {3.87338467187498*^9, 3.8733847320021152`*^9}, {
  3.8738034070587254`*^9, 3.873803409081163*^9}},
 CellLabel->
  "In[1573]:=",ExpressionUUID->"2aca4a3a-95da-499a-acb2-25f649ce45ef"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Sin", "[", 
     RowBox[{
      RowBox[{"k", " ", "x"}], "-", 
      RowBox[{"t", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
         RowBox[{"\[Epsilon]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Omega]", "[", "1", "]"}], "+", 
            RowBox[{"\[Epsilon]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Omega]", "[", "2", "]"}], "+", 
               RowBox[{"\[Epsilon]", " ", 
                RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], ")"}]}]}],
         ")"}]}]}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["k", "2"], " ", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"2", ",", "1"}], "]"}]}], "+", 
      RowBox[{"3", " ", 
       SuperscriptBox["k", "2"], " ", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"2", ",", "3"}], "]"}]}], "-", 
      RowBox[{"k", " ", 
       RowBox[{"\[Eta]", "[", 
        RowBox[{"2", ",", "1"}], "]"}], " ", 
       RowBox[{"\[Omega]", "[", "0", "]"}]}], "-", 
      RowBox[{"3", " ", "k", " ", 
       RowBox[{"\[Eta]", "[", 
        RowBox[{"2", ",", "3"}], "]"}], " ", 
       RowBox[{"\[Omega]", "[", "0", "]"}]}], "+", 
      RowBox[{"2", " ", "k", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"k", " ", "x"}], "-", 
         RowBox[{"t", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
            RowBox[{"\[Epsilon]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Omega]", "[", "1", "]"}], "+", 
               RowBox[{"\[Epsilon]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Omega]", "[", "2", "]"}], "+", 
                  RowBox[{"\[Epsilon]", " ", 
                   RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], 
              ")"}]}]}], ")"}]}]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"k", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Phi]", "[", 
             RowBox[{"1", ",", "1"}], "]"}], "+", 
            RowBox[{"2", " ", 
             RowBox[{"\[Phi]", "[", 
              RowBox[{"2", ",", "2"}], "]"}]}]}], ")"}]}], "-", 
         RowBox[{"2", " ", 
          RowBox[{"\[Eta]", "[", 
           RowBox[{"2", ",", "2"}], "]"}], " ", 
          RowBox[{"\[Omega]", "[", "0", "]"}]}]}], ")"}]}], "+", 
      RowBox[{"6", " ", "k", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"2", " ", "k", " ", "x"}], "-", 
         RowBox[{"2", " ", "t", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
            RowBox[{"\[Epsilon]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Omega]", "[", "1", "]"}], "+", 
               RowBox[{"\[Epsilon]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Omega]", "[", "2", "]"}], "+", 
                  RowBox[{"\[Epsilon]", " ", 
                   RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], 
              ")"}]}]}], ")"}]}]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"k", " ", 
          RowBox[{"\[Phi]", "[", 
           RowBox[{"2", ",", "3"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"\[Eta]", "[", 
           RowBox[{"2", ",", "3"}], "]"}], " ", 
          RowBox[{"\[Omega]", "[", "0", "]"}]}]}], ")"}]}], "-", 
      RowBox[{"\[Omega]", "[", "1", "]"}]}], ")"}]}], "\[Equal]", "0"}], "&&", 
  RowBox[{
   RowBox[{
    RowBox[{"Sin", "[", 
     RowBox[{
      RowBox[{"k", " ", "x"}], "-", 
      RowBox[{"t", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
         RowBox[{"\[Epsilon]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Omega]", "[", "1", "]"}], "+", 
            RowBox[{"\[Epsilon]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Omega]", "[", "2", "]"}], "+", 
               RowBox[{"\[Epsilon]", " ", 
                RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], ")"}]}]}],
         ")"}]}]}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "g"}], " ", 
       SuperscriptBox["k", "2"], " ", 
       RowBox[{"\[Eta]", "[", 
        RowBox[{"2", ",", "1"}], "]"}]}], "-", 
      RowBox[{"3", " ", "g", " ", 
       SuperscriptBox["k", "2"], " ", 
       RowBox[{"\[Eta]", "[", 
        RowBox[{"2", ",", "3"}], "]"}]}], "+", 
      RowBox[{"6", " ", 
       SuperscriptBox["k", "2"], " ", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"2", ",", "3"}], "]"}], " ", 
       RowBox[{"\[Omega]", "[", "0", "]"}]}], "+", 
      RowBox[{"k", " ", 
       RowBox[{"\[Eta]", "[", 
        RowBox[{"2", ",", "1"}], "]"}], " ", 
       SuperscriptBox[
        RowBox[{"\[Omega]", "[", "0", "]"}], "2"]}], "+", 
      RowBox[{"3", " ", "k", " ", 
       RowBox[{"\[Eta]", "[", 
        RowBox[{"2", ",", "3"}], "]"}], " ", 
       SuperscriptBox[
        RowBox[{"\[Omega]", "[", "0", "]"}], "2"]}], "+", 
      RowBox[{"6", " ", "k", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"2", " ", "k", " ", "x"}], "-", 
         RowBox[{"2", " ", "t", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
            RowBox[{"\[Epsilon]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Omega]", "[", "1", "]"}], "+", 
               RowBox[{"\[Epsilon]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Omega]", "[", "2", "]"}], "+", 
                  RowBox[{"\[Epsilon]", " ", 
                   RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], 
              ")"}]}]}], ")"}]}]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "g"}], " ", "k", " ", 
          RowBox[{"\[Eta]", "[", 
           RowBox[{"2", ",", "3"}], "]"}]}], "+", 
         RowBox[{"2", " ", "k", " ", 
          RowBox[{"\[Phi]", "[", 
           RowBox[{"2", ",", "3"}], "]"}], " ", 
          RowBox[{"\[Omega]", "[", "0", "]"}]}], "+", 
         RowBox[{
          RowBox[{"\[Eta]", "[", 
           RowBox[{"2", ",", "3"}], "]"}], " ", 
          SuperscriptBox[
           RowBox[{"\[Omega]", "[", "0", "]"}], "2"]}]}], ")"}]}], "+", 
      RowBox[{"4", " ", "k", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"k", " ", "x"}], "-", 
         RowBox[{"t", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
            RowBox[{"\[Epsilon]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Omega]", "[", "1", "]"}], "+", 
               RowBox[{"\[Epsilon]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Omega]", "[", "2", "]"}], "+", 
                  RowBox[{"\[Epsilon]", " ", 
                   RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], 
              ")"}]}]}], ")"}]}]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "g"}], " ", "k", " ", 
          RowBox[{"\[Eta]", "[", 
           RowBox[{"2", ",", "2"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"\[Omega]", "[", "0", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"k", " ", 
             RowBox[{"\[Phi]", "[", 
              RowBox[{"2", ",", "2"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"\[Eta]", "[", 
              RowBox[{"2", ",", "2"}], "]"}], " ", 
             RowBox[{"\[Omega]", "[", "0", "]"}]}]}], ")"}]}]}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["k", "2"], " ", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", 
       RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
      RowBox[{
       RowBox[{"\[Omega]", "[", "0", "]"}], " ", 
       RowBox[{"\[Omega]", "[", "1", "]"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
      RowBox[{"\[Epsilon]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Omega]", "[", "1", "]"}], "+", 
         RowBox[{"\[Epsilon]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Omega]", "[", "2", "]"}], "+", 
            RowBox[{"\[Epsilon]", " ", 
             RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], ")"}]}]}], 
     ")"}]}], "\[Equal]", "0"}]}]], "Output",
 CellChangeTimes->{
  3.873384732739975*^9, 3.873384830544011*^9, {3.8738034326244698`*^9, 
   3.8738034772835703`*^9}, 3.873803609106431*^9, 3.873804085631248*^9, 
   3.873804214890382*^9, 3.873804285163494*^9, 3.873804402225692*^9, 
   3.873816077387271*^9, 3.873822827413711*^9, 3.875284916205853*^9},
 CellLabel->
  "Out[1576]=",ExpressionUUID->"364b7d64-cb4d-4bb0-b4c7-0f0a47fd0622"]
}, Open  ]],

Cell["\<\
So we see that the BC is only satisfied if B=0. What does this say about \
\[Eta]?\
\>", "Text",
 CellChangeTimes->{{3.873307488865398*^9, 3.873307513528838*^9}, {
  3.873371943455612*^9, 3.873371956103341*^9}, {3.873384588773117*^9, 
  3.8733845990845003`*^9}},ExpressionUUID->"37e07e2c-f9a1-4721-b9c3-\
38a5844d411f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"B", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"eta2", " ", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{"Simplify", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dbc", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "==", "0"}], " ", "/.", " ", 
          RowBox[{"{", 
           RowBox[{"\[Omega]", " ", "->", " ", 
            RowBox[{"Sqrt", "[", " ", 
             RowBox[{"g", " ", "k"}], "]"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"\[Eta]", "[", 
         RowBox[{"2", ",", "x", ",", "t"}], "]"}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], " ", "/.", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Sqrt", "[", 
        RowBox[{"g", " ", "k"}], "]"}], " ", "->", " ", "\[Omega]"}], ",", 
      RowBox[{"B", "->", "0"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Eta]", "[", 
    RowBox[{"2", ",", "x", ",", "t"}], "]"}], " ", "=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"\[Eta]", "[", 
      RowBox[{"2", ",", "x", ",", "t"}], "]"}], " ", "/.", " ", "eta2"}], 
    ")"}]}], ";"}], "\[IndentingNewLine]"}], "Text", "Input",
 CellChangeTimes->{{3.873306503145933*^9, 3.873306504997334*^9}, {
  3.873307448731639*^9, 3.873307471860038*^9}, {3.8733716534491253`*^9, 
  3.8733717123039*^9}, {3.873371795582664*^9, 3.873371827956482*^9}, {
  3.873372241423872*^9, 3.8733723207638693`*^9}, {3.8733723631165*^9, 
  3.873372405232731*^9}, {3.873372460625628*^9, 3.8733725583182*^9}, {
  3.8733734260237017`*^9, 3.873373440686962*^9}, {3.873384607006997*^9, 
  3.873384619926981*^9}, {3.873384760769225*^9, 3.873384806871364*^9}},
 CellLabel->
  "In[1577]:=",ExpressionUUID->"b197d847-52d6-4cb6-9869-54ec49f46bd6"],

Cell[BoxData[
 TemplateBox[{
  "Part", "partw", 
   "\"Part \\!\\(\\*RowBox[{\\\"1\\\"}]\\) of \\!\\(\\*RowBox[{\\\"{\\\", \
\\\"}\\\"}]\\) does not exist.\"", 2, 1578, 90, 29504127468218165255, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8752849412296467`*^9},
 CellLabel->
  "During evaluation of \
In[1577]:=",ExpressionUUID->"7c8ee40e-a0be-498c-89d7-9aaa5d0b3cd9"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{{3.873384807983994*^9, 3.8733848305913553`*^9}, {
   3.873803432676845*^9, 3.873803477300962*^9}, 3.873803609147395*^9, 
   3.8738040856487827`*^9, 3.8738042149075747`*^9, 3.873804285180686*^9, 
   3.873804402322975*^9, 3.873816077453195*^9, 3.8738228274805727`*^9, 
   3.875284941244801*^9},
 CellLabel->
  "Out[1578]=",ExpressionUUID->"2428727e-cd13-47e0-8a2b-053a9a6a3586"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Display", " ", "variables", " ", "up", " ", "to", " ", "now"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"phi", "\[IndentingNewLine]", "eta"}]}]], "Text", "Input",
 CellChangeTimes->{{3.873384781959653*^9, 3.8733847846236153`*^9}, {
  3.873384836359913*^9, 3.873384843925674*^9}},
 CellLabel->
  "In[1580]:=",ExpressionUUID->"232cf917-2ae2-4efc-8ed0-810410d79a25"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"k", " ", "z"}]], " ", "\[Epsilon]", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{
     RowBox[{"k", " ", "x"}], "-", 
     RowBox[{"t", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
        RowBox[{"\[Epsilon]", " ", 
         RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "2"], " ", 
         RowBox[{"\[Omega]", "[", "2", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "3"], " ", 
         RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], "]"}], " ", 
   RowBox[{"\[Phi]", "[", 
    RowBox[{"1", ",", "1"}], "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"k", " ", "z"}]], " ", 
   SuperscriptBox["\[Epsilon]", "2"], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{
     RowBox[{"k", " ", "x"}], "-", 
     RowBox[{"t", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
        RowBox[{"\[Epsilon]", " ", 
         RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "2"], " ", 
         RowBox[{"\[Omega]", "[", "2", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "3"], " ", 
         RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], "]"}], " ", 
   RowBox[{"\[Phi]", "[", 
    RowBox[{"2", ",", "1"}], "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"2", " ", "k", " ", "z"}]], " ", 
   SuperscriptBox["\[Epsilon]", "2"], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"k", " ", "x"}], "-", 
       RowBox[{"t", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
          RowBox[{"\[Epsilon]", " ", 
           RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
          RowBox[{
           SuperscriptBox["\[Epsilon]", "2"], " ", 
           RowBox[{"\[Omega]", "[", "2", "]"}]}], "+", 
          RowBox[{
           SuperscriptBox["\[Epsilon]", "3"], " ", 
           RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], ")"}]}], "]"}],
    " ", 
   RowBox[{"\[Phi]", "[", 
    RowBox[{"2", ",", "2"}], "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"3", " ", "k", " ", "z"}]], " ", 
   SuperscriptBox["\[Epsilon]", "2"], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"3", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"k", " ", "x"}], "-", 
       RowBox[{"t", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
          RowBox[{"\[Epsilon]", " ", 
           RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
          RowBox[{
           SuperscriptBox["\[Epsilon]", "2"], " ", 
           RowBox[{"\[Omega]", "[", "2", "]"}]}], "+", 
          RowBox[{
           SuperscriptBox["\[Epsilon]", "3"], " ", 
           RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], ")"}]}], "]"}],
    " ", 
   RowBox[{"\[Phi]", "[", 
    RowBox[{"2", ",", "3"}], "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"k", " ", "z"}]], " ", 
   SuperscriptBox["\[Epsilon]", "3"], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{
     RowBox[{"k", " ", "x"}], "-", 
     RowBox[{"t", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
        RowBox[{"\[Epsilon]", " ", 
         RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "2"], " ", 
         RowBox[{"\[Omega]", "[", "2", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "3"], " ", 
         RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], "]"}], " ", 
   RowBox[{"\[Phi]", "[", 
    RowBox[{"3", ",", "1"}], "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"2", " ", "k", " ", "z"}]], " ", 
   SuperscriptBox["\[Epsilon]", "3"], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"k", " ", "x"}], "-", 
       RowBox[{"t", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
          RowBox[{"\[Epsilon]", " ", 
           RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
          RowBox[{
           SuperscriptBox["\[Epsilon]", "2"], " ", 
           RowBox[{"\[Omega]", "[", "2", "]"}]}], "+", 
          RowBox[{
           SuperscriptBox["\[Epsilon]", "3"], " ", 
           RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], ")"}]}], "]"}],
    " ", 
   RowBox[{"\[Phi]", "[", 
    RowBox[{"3", ",", "2"}], "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"3", " ", "k", " ", "z"}]], " ", 
   SuperscriptBox["\[Epsilon]", "3"], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"3", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"k", " ", "x"}], "-", 
       RowBox[{"t", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
          RowBox[{"\[Epsilon]", " ", 
           RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
          RowBox[{
           SuperscriptBox["\[Epsilon]", "2"], " ", 
           RowBox[{"\[Omega]", "[", "2", "]"}]}], "+", 
          RowBox[{
           SuperscriptBox["\[Epsilon]", "3"], " ", 
           RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], ")"}]}], "]"}],
    " ", 
   RowBox[{"\[Phi]", "[", 
    RowBox[{"3", ",", "3"}], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.873372252596068*^9, 3.873372321215313*^9}, {
   3.873372380737957*^9, 3.8733724056418962`*^9}, {3.873372468342457*^9, 
   3.873372558839237*^9}, {3.8733734295665083`*^9, 3.87337344119203*^9}, 
   3.873384056292432*^9, 3.873384151390748*^9, 3.873384198443811*^9, {
   3.873384609467101*^9, 3.873384621424366*^9}, {3.873384773227841*^9, 
   3.873384848727141*^9}, {3.873803432697196*^9, 3.8738034773360367`*^9}, 
   3.873803609163747*^9, 3.873804085682078*^9, 3.8738042149438267`*^9, 
   3.873804285215578*^9, 3.8738044023433332`*^9, 3.873816077474864*^9, 
   3.87382282750263*^9, 3.875284941313897*^9},
 CellLabel->
  "Out[1580]=",ExpressionUUID->"ec5c08b0-90f4-4de9-8869-5275e7a661b0"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"\[Epsilon]", " ", 
    RowBox[{"Cos", "[", 
     RowBox[{
      RowBox[{"k", " ", "x"}], "-", 
      RowBox[{"t", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
         RowBox[{"\[Epsilon]", " ", 
          RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["\[Epsilon]", "2"], " ", 
          RowBox[{"\[Omega]", "[", "2", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["\[Epsilon]", "3"], " ", 
          RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], "]"}]}], "k"], 
  "+", 
  RowBox[{
   SuperscriptBox["\[Epsilon]", "2"], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{
     RowBox[{"k", " ", "x"}], "-", 
     RowBox[{"t", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
        RowBox[{"\[Epsilon]", " ", 
         RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "2"], " ", 
         RowBox[{"\[Omega]", "[", "2", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "3"], " ", 
         RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], "]"}], " ", 
   RowBox[{"\[Eta]", "[", 
    RowBox[{"2", ",", "1"}], "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["\[Epsilon]", "2"], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"k", " ", "x"}], "-", 
       RowBox[{"t", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
          RowBox[{"\[Epsilon]", " ", 
           RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
          RowBox[{
           SuperscriptBox["\[Epsilon]", "2"], " ", 
           RowBox[{"\[Omega]", "[", "2", "]"}]}], "+", 
          RowBox[{
           SuperscriptBox["\[Epsilon]", "3"], " ", 
           RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], ")"}]}], "]"}],
    " ", 
   RowBox[{"\[Eta]", "[", 
    RowBox[{"2", ",", "2"}], "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["\[Epsilon]", "2"], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"3", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"k", " ", "x"}], "-", 
       RowBox[{"t", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
          RowBox[{"\[Epsilon]", " ", 
           RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
          RowBox[{
           SuperscriptBox["\[Epsilon]", "2"], " ", 
           RowBox[{"\[Omega]", "[", "2", "]"}]}], "+", 
          RowBox[{
           SuperscriptBox["\[Epsilon]", "3"], " ", 
           RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], ")"}]}], "]"}],
    " ", 
   RowBox[{"\[Eta]", "[", 
    RowBox[{"2", ",", "3"}], "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["\[Epsilon]", "3"], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{
     RowBox[{"k", " ", "x"}], "-", 
     RowBox[{"t", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
        RowBox[{"\[Epsilon]", " ", 
         RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "2"], " ", 
         RowBox[{"\[Omega]", "[", "2", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "3"], " ", 
         RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], "]"}], " ", 
   RowBox[{"\[Eta]", "[", 
    RowBox[{"3", ",", "1"}], "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["\[Epsilon]", "3"], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"k", " ", "x"}], "-", 
       RowBox[{"t", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
          RowBox[{"\[Epsilon]", " ", 
           RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
          RowBox[{
           SuperscriptBox["\[Epsilon]", "2"], " ", 
           RowBox[{"\[Omega]", "[", "2", "]"}]}], "+", 
          RowBox[{
           SuperscriptBox["\[Epsilon]", "3"], " ", 
           RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], ")"}]}], "]"}],
    " ", 
   RowBox[{"\[Eta]", "[", 
    RowBox[{"3", ",", "2"}], "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["\[Epsilon]", "3"], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"3", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"k", " ", "x"}], "-", 
       RowBox[{"t", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
          RowBox[{"\[Epsilon]", " ", 
           RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
          RowBox[{
           SuperscriptBox["\[Epsilon]", "2"], " ", 
           RowBox[{"\[Omega]", "[", "2", "]"}]}], "+", 
          RowBox[{
           SuperscriptBox["\[Epsilon]", "3"], " ", 
           RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], ")"}]}], "]"}],
    " ", 
   RowBox[{"\[Eta]", "[", 
    RowBox[{"3", ",", "3"}], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.873372252596068*^9, 3.873372321215313*^9}, {
   3.873372380737957*^9, 3.8733724056418962`*^9}, {3.873372468342457*^9, 
   3.873372558839237*^9}, {3.8733734295665083`*^9, 3.87337344119203*^9}, 
   3.873384056292432*^9, 3.873384151390748*^9, 3.873384198443811*^9, {
   3.873384609467101*^9, 3.873384621424366*^9}, {3.873384773227841*^9, 
   3.873384848727141*^9}, {3.873803432697196*^9, 3.8738034773360367`*^9}, 
   3.873803609163747*^9, 3.873804085682078*^9, 3.8738042149438267`*^9, 
   3.873804285215578*^9, 3.8738044023433332`*^9, 3.873816077474864*^9, 
   3.87382282750263*^9, 3.875284941326406*^9},
 CellLabel->
  "Out[1581]=",ExpressionUUID->"83a5deb3-2fd7-418f-a453-114b84dfe404"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Knowing Second Solution, next BC", "Section",
 CellChangeTimes->{{3.8732181091320677`*^9, 
  3.873218120639409*^9}},ExpressionUUID->"0c61ca42-2ef7-4493-af30-\
cce583d837b2"],

Cell[TextData[{
 "The second solution is  ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox["\[Phi]", "2"], "\[LongEqual]", "0"}], TraditionalForm],
      "errors" -> {}, "input" -> "\\phi_2 = 0", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "130a3aed-a780-43d3-a2d8-6b2717077ede"],
 " , ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox["\[Eta]", "2"], "\[LongEqual]", 
         FractionBox["1", 
          RowBox[{"2", 
            StyleBox["k", "TI"]}]], "cos", 
         RowBox[{"(", 
           RowBox[{"2", 
             SubscriptBox["\[Theta]", "0"]}], ")"}]}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\eta_2 = \\frac{1}{2k} \\cos(2\\theta_0)", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "ea1c7e8d-71e3-499e-8143-671da93806d6"]
}], "Text",
 CellChangeTimes->{
  3.873218135262595*^9, {3.873299076705035*^9, 3.8732990785366087`*^9}, {
   3.8733849651213818`*^9, 
   3.8733849738970547`*^9}},ExpressionUUID->"898818ec-2765-4383-a253-\
7301d5937b42"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.873218190315588*^9, 3.873218239046197*^9}, 
   3.873292282094611*^9},
 CellLabel->
  "In[1582]:=",ExpressionUUID->"ee7e8782-3e46-40ab-b203-ed8bf6d7ce23"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Recompute", " ", "BC"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"kbc", " ", "=", " ", 
     RowBox[{"TrigReduce", "[", 
      RowBox[{"CoefficientList", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{"eta", ",", "t"}], "]"}], " ", "+", " ", 
          RowBox[{
           RowBox[{"Taylor", "[", 
            RowBox[{"D", "[", 
             RowBox[{"phi", ",", "x"}], "]"}], "]"}], 
           RowBox[{"D", "[", 
            RowBox[{"eta", ",", "x"}], "]"}]}], " ", "-", " ", 
          RowBox[{"Taylor", "[", 
           RowBox[{"D", "[", 
            RowBox[{"phi", ",", "z"}], "]"}], "]"}]}], " ", "/.", " ", 
         RowBox[{"z", "->", "0"}]}], ",", "\[Epsilon]"}], "]"}], " ", "]"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{"kbc", "[", 
    RowBox[{"[", "4", "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.873218257943774*^9, 3.8732182890754642`*^9}, {
  3.873218338722736*^9, 3.873218341440793*^9}, {3.8733850359206533`*^9, 
  3.873385054055039*^9}, {3.8733851227738533`*^9, 3.873385124244494*^9}, {
  3.873560432572303*^9, 3.8735604683507967`*^9}, {3.873804867865159*^9, 
  3.873804904181005*^9}},
 CellLabel->
  "In[1583]:=",ExpressionUUID->"9a44e161-517f-423b-8e3d-15c972194446"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    FractionBox["3", "8"]}], " ", "k", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{
     RowBox[{"3", " ", "k", " ", "x"}], "-", 
     RowBox[{"3", " ", "t", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
        RowBox[{"\[Epsilon]", " ", 
         RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "2"], " ", 
         RowBox[{"\[Omega]", "[", "2", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "3"], " ", 
         RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], "]"}], " ", 
   RowBox[{"\[Phi]", "[", 
    RowBox[{"1", ",", "1"}], "]"}]}], "-", 
  RowBox[{
   FractionBox["3", "8"], " ", "k", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{
     RowBox[{"k", " ", "x"}], "-", 
     RowBox[{"t", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
        RowBox[{"\[Epsilon]", " ", 
         RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "2"], " ", 
         RowBox[{"\[Omega]", "[", "2", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "3"], " ", 
         RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], "]"}], " ", 
   RowBox[{"\[Phi]", "[", 
    RowBox[{"1", ",", "1"}], "]"}]}], "-", 
  RowBox[{
   SuperscriptBox["k", "2"], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{
     RowBox[{"2", " ", "k", " ", "x"}], "-", 
     RowBox[{"2", " ", "t", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
        RowBox[{"\[Epsilon]", " ", 
         RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "2"], " ", 
         RowBox[{"\[Omega]", "[", "2", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "3"], " ", 
         RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], "]"}], " ", 
   RowBox[{"\[Eta]", "[", 
    RowBox[{"2", ",", "1"}], "]"}], " ", 
   RowBox[{"\[Phi]", "[", 
    RowBox[{"1", ",", "1"}], "]"}]}], "-", 
  RowBox[{
   FractionBox["3", "2"], " ", 
   SuperscriptBox["k", "2"], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{
     RowBox[{"3", " ", "k", " ", "x"}], "-", 
     RowBox[{"3", " ", "t", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
        RowBox[{"\[Epsilon]", " ", 
         RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "2"], " ", 
         RowBox[{"\[Omega]", "[", "2", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "3"], " ", 
         RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], "]"}], " ", 
   RowBox[{"\[Eta]", "[", 
    RowBox[{"2", ",", "2"}], "]"}], " ", 
   RowBox[{"\[Phi]", "[", 
    RowBox[{"1", ",", "1"}], "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   SuperscriptBox["k", "2"], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{
     RowBox[{"k", " ", "x"}], "-", 
     RowBox[{"t", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
        RowBox[{"\[Epsilon]", " ", 
         RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "2"], " ", 
         RowBox[{"\[Omega]", "[", "2", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "3"], " ", 
         RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], "]"}], " ", 
   RowBox[{"\[Eta]", "[", 
    RowBox[{"2", ",", "2"}], "]"}], " ", 
   RowBox[{"\[Phi]", "[", 
    RowBox[{"1", ",", "1"}], "]"}]}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["k", "2"], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{
     RowBox[{"4", " ", "k", " ", "x"}], "-", 
     RowBox[{"4", " ", "t", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
        RowBox[{"\[Epsilon]", " ", 
         RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "2"], " ", 
         RowBox[{"\[Omega]", "[", "2", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "3"], " ", 
         RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], "]"}], " ", 
   RowBox[{"\[Eta]", "[", 
    RowBox[{"2", ",", "3"}], "]"}], " ", 
   RowBox[{"\[Phi]", "[", 
    RowBox[{"1", ",", "1"}], "]"}]}], "-", 
  RowBox[{
   SuperscriptBox["k", "2"], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{
     RowBox[{"2", " ", "k", " ", "x"}], "-", 
     RowBox[{"2", " ", "t", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
        RowBox[{"\[Epsilon]", " ", 
         RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "2"], " ", 
         RowBox[{"\[Omega]", "[", "2", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "3"], " ", 
         RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], "]"}], " ", 
   RowBox[{"\[Eta]", "[", 
    RowBox[{"2", ",", "3"}], "]"}], " ", 
   RowBox[{"\[Phi]", "[", 
    RowBox[{"1", ",", "1"}], "]"}]}], "-", 
  RowBox[{"k", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{
     RowBox[{"2", " ", "k", " ", "x"}], "-", 
     RowBox[{"2", " ", "t", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
        RowBox[{"\[Epsilon]", " ", 
         RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "2"], " ", 
         RowBox[{"\[Omega]", "[", "2", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "3"], " ", 
         RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], "]"}], " ", 
   RowBox[{"\[Phi]", "[", 
    RowBox[{"2", ",", "1"}], "]"}]}], "-", 
  RowBox[{"3", " ", "k", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{
     RowBox[{"3", " ", "k", " ", "x"}], "-", 
     RowBox[{"3", " ", "t", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
        RowBox[{"\[Epsilon]", " ", 
         RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "2"], " ", 
         RowBox[{"\[Omega]", "[", "2", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "3"], " ", 
         RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], "]"}], " ", 
   RowBox[{"\[Phi]", "[", 
    RowBox[{"2", ",", "2"}], "]"}]}], "-", 
  RowBox[{"k", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{
     RowBox[{"k", " ", "x"}], "-", 
     RowBox[{"t", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
        RowBox[{"\[Epsilon]", " ", 
         RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "2"], " ", 
         RowBox[{"\[Omega]", "[", "2", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "3"], " ", 
         RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], "]"}], " ", 
   RowBox[{"\[Phi]", "[", 
    RowBox[{"2", ",", "2"}], "]"}]}], "-", 
  RowBox[{"6", " ", "k", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{
     RowBox[{"4", " ", "k", " ", "x"}], "-", 
     RowBox[{"4", " ", "t", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
        RowBox[{"\[Epsilon]", " ", 
         RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "2"], " ", 
         RowBox[{"\[Omega]", "[", "2", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "3"], " ", 
         RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], "]"}], " ", 
   RowBox[{"\[Phi]", "[", 
    RowBox[{"2", ",", "3"}], "]"}]}], "-", 
  RowBox[{"3", " ", "k", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{
     RowBox[{"2", " ", "k", " ", "x"}], "-", 
     RowBox[{"2", " ", "t", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
        RowBox[{"\[Epsilon]", " ", 
         RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "2"], " ", 
         RowBox[{"\[Omega]", "[", "2", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "3"], " ", 
         RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], "]"}], " ", 
   RowBox[{"\[Phi]", "[", 
    RowBox[{"2", ",", "3"}], "]"}]}], "-", 
  RowBox[{"k", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{
     RowBox[{"k", " ", "x"}], "-", 
     RowBox[{"t", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
        RowBox[{"\[Epsilon]", " ", 
         RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "2"], " ", 
         RowBox[{"\[Omega]", "[", "2", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "3"], " ", 
         RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], "]"}], " ", 
   RowBox[{"\[Phi]", "[", 
    RowBox[{"3", ",", "1"}], "]"}]}], "-", 
  RowBox[{"2", " ", "k", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{
     RowBox[{"2", " ", "k", " ", "x"}], "-", 
     RowBox[{"2", " ", "t", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
        RowBox[{"\[Epsilon]", " ", 
         RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "2"], " ", 
         RowBox[{"\[Omega]", "[", "2", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "3"], " ", 
         RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], "]"}], " ", 
   RowBox[{"\[Phi]", "[", 
    RowBox[{"3", ",", "2"}], "]"}]}], "-", 
  RowBox[{"3", " ", "k", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{
     RowBox[{"3", " ", "k", " ", "x"}], "-", 
     RowBox[{"3", " ", "t", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
        RowBox[{"\[Epsilon]", " ", 
         RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "2"], " ", 
         RowBox[{"\[Omega]", "[", "2", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "3"], " ", 
         RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], "]"}], " ", 
   RowBox[{"\[Phi]", "[", 
    RowBox[{"3", ",", "3"}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"Sin", "[", 
    RowBox[{
     RowBox[{"k", " ", "x"}], "-", 
     RowBox[{"t", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
        RowBox[{"\[Epsilon]", " ", 
         RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "2"], " ", 
         RowBox[{"\[Omega]", "[", "2", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "3"], " ", 
         RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], "]"}], " ", 
   RowBox[{"\[Eta]", "[", 
    RowBox[{"3", ",", "1"}], "]"}], " ", 
   RowBox[{"\[Omega]", "[", "0", "]"}]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{
     RowBox[{"2", " ", "k", " ", "x"}], "-", 
     RowBox[{"2", " ", "t", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
        RowBox[{"\[Epsilon]", " ", 
         RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "2"], " ", 
         RowBox[{"\[Omega]", "[", "2", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "3"], " ", 
         RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], "]"}], " ", 
   RowBox[{"\[Eta]", "[", 
    RowBox[{"3", ",", "2"}], "]"}], " ", 
   RowBox[{"\[Omega]", "[", "0", "]"}]}], "+", 
  RowBox[{"3", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{
     RowBox[{"3", " ", "k", " ", "x"}], "-", 
     RowBox[{"3", " ", "t", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
        RowBox[{"\[Epsilon]", " ", 
         RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "2"], " ", 
         RowBox[{"\[Omega]", "[", "2", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "3"], " ", 
         RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], "]"}], " ", 
   RowBox[{"\[Eta]", "[", 
    RowBox[{"3", ",", "3"}], "]"}], " ", 
   RowBox[{"\[Omega]", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Sin", "[", 
    RowBox[{
     RowBox[{"k", " ", "x"}], "-", 
     RowBox[{"t", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
        RowBox[{"\[Epsilon]", " ", 
         RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "2"], " ", 
         RowBox[{"\[Omega]", "[", "2", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "3"], " ", 
         RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], "]"}], " ", 
   RowBox[{"\[Eta]", "[", 
    RowBox[{"2", ",", "1"}], "]"}], " ", 
   RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{
     RowBox[{"2", " ", "k", " ", "x"}], "-", 
     RowBox[{"2", " ", "t", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
        RowBox[{"\[Epsilon]", " ", 
         RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "2"], " ", 
         RowBox[{"\[Omega]", "[", "2", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "3"], " ", 
         RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], "]"}], " ", 
   RowBox[{"\[Eta]", "[", 
    RowBox[{"2", ",", "2"}], "]"}], " ", 
   RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
  RowBox[{"3", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{
     RowBox[{"3", " ", "k", " ", "x"}], "-", 
     RowBox[{"3", " ", "t", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
        RowBox[{"\[Epsilon]", " ", 
         RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "2"], " ", 
         RowBox[{"\[Omega]", "[", "2", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "3"], " ", 
         RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], "]"}], " ", 
   RowBox[{"\[Eta]", "[", 
    RowBox[{"2", ",", "3"}], "]"}], " ", 
   RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"Sin", "[", 
     RowBox[{
      RowBox[{"k", " ", "x"}], "-", 
      RowBox[{"t", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
         RowBox[{"\[Epsilon]", " ", 
          RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["\[Epsilon]", "2"], " ", 
          RowBox[{"\[Omega]", "[", "2", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["\[Epsilon]", "3"], " ", 
          RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], "]"}], " ", 
    RowBox[{"\[Omega]", "[", "2", "]"}]}], "k"]}]], "Output",
 CellChangeTimes->{
  3.873218307921412*^9, 3.873218341873591*^9, 3.873290657017578*^9, 
   3.873290886660694*^9, 3.8732911562642097`*^9, 3.873292287911598*^9, {
   3.87330728738132*^9, 3.873307295009392*^9}, 3.8733073598511744`*^9, 
   3.8733848312023706`*^9, {3.873385043054744*^9, 3.873385055375661*^9}, 
   3.873385124623808*^9, {3.873560453528408*^9, 3.873560468588826*^9}, {
   3.8738034327630997`*^9, 3.873803477385573*^9}, 3.8738036092405767`*^9, 
   3.8738040857321587`*^9, 3.873804215040287*^9, 3.8738042853248053`*^9, 
   3.8738044025670958`*^9, {3.873804870606811*^9, 3.873804904653324*^9}, 
   3.8738160776359673`*^9, 3.873822827656085*^9, 3.87528495602807*^9},
 CellLabel->
  "Out[1584]=",ExpressionUUID->"eb51181c-1c10-4266-b16f-e4025a125c97"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"dbc", " ", "=", " ", 
   RowBox[{"CoefficientList", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Taylor", "[", 
        RowBox[{"D", "[", 
         RowBox[{"phi", ",", "t"}], "]"}], "]"}], " ", "+", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", "2"}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Taylor", "[", 
            RowBox[{"D", "[", 
             RowBox[{"phi", ",", "x"}], "]"}], "]"}], "^", "2"}], " ", "+", 
          " ", 
          RowBox[{
           RowBox[{"Taylor", "[", 
            RowBox[{"D", "[", 
             RowBox[{"phi", ",", "z"}], "]"}], "]"}], "^", "2"}]}], ")"}]}], 
       " ", "+", " ", 
       RowBox[{"g", "*", "eta"}]}], " ", "/.", " ", 
      RowBox[{"z", "->", " ", "0"}]}], ",", "\[Epsilon]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"dbc", "[", 
    RowBox[{"[", "4", "]"}], "]"}], " ", "==", " ", "0"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8732182988305817`*^9, 3.873218303682108*^9}, {
  3.873803423177636*^9, 3.873803425143968*^9}},
 CellLabel->
  "In[1585]:=",ExpressionUUID->"44d72002-f6e4-417e-b3cc-794e5758cdc2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"8", " ", "g", " ", 
    RowBox[{"Cos", "[", 
     RowBox[{
      RowBox[{"3", " ", "k", " ", "x"}], "-", 
      RowBox[{"3", " ", "t", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
         RowBox[{"\[Epsilon]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Omega]", "[", "1", "]"}], "+", 
            RowBox[{"\[Epsilon]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Omega]", "[", "2", "]"}], "+", 
               RowBox[{"\[Epsilon]", " ", 
                RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], ")"}]}]}],
         ")"}]}]}], "]"}], " ", 
    RowBox[{"\[Eta]", "[", 
     RowBox[{"3", ",", "3"}], "]"}]}], "+", 
   RowBox[{"8", " ", 
    SuperscriptBox["k", "2"], " ", 
    RowBox[{"\[Phi]", "[", 
     RowBox[{"1", ",", "1"}], "]"}], " ", 
    RowBox[{"\[Phi]", "[", 
     RowBox[{"2", ",", "1"}], "]"}]}], "+", 
   RowBox[{"4", " ", 
    RowBox[{"Cos", "[", 
     RowBox[{
      RowBox[{"2", " ", "k", " ", "x"}], "-", 
      RowBox[{"2", " ", "t", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
         RowBox[{"\[Epsilon]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Omega]", "[", "1", "]"}], "+", 
            RowBox[{"\[Epsilon]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Omega]", "[", "2", "]"}], "+", 
               RowBox[{"\[Epsilon]", " ", 
                RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], ")"}]}]}],
         ")"}]}]}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "g", " ", 
       RowBox[{"\[Eta]", "[", 
        RowBox[{"3", ",", "2"}], "]"}]}], "+", 
      RowBox[{"6", " ", 
       SuperscriptBox["k", "2"], " ", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"2", ",", "3"}], "]"}]}], "-", 
      RowBox[{"k", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Eta]", "[", 
          RowBox[{"2", ",", "1"}], "]"}], "+", 
         RowBox[{"\[Eta]", "[", 
          RowBox[{"2", ",", "3"}], "]"}]}], ")"}], " ", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", 
       RowBox[{"\[Omega]", "[", "0", "]"}]}], "-", 
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"2", ",", "1"}], "]"}], " ", 
       RowBox[{"\[Omega]", "[", "0", "]"}]}], "-", 
      RowBox[{"9", " ", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"2", ",", "3"}], "]"}], " ", 
       RowBox[{"\[Omega]", "[", "0", "]"}]}], "-", 
      RowBox[{"4", " ", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"3", ",", "2"}], "]"}], " ", 
       RowBox[{"\[Omega]", "[", "0", "]"}]}], "-", 
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", 
       RowBox[{"\[Omega]", "[", "1", "]"}]}], "-", 
      RowBox[{"4", " ", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"2", ",", "2"}], "]"}], " ", 
       RowBox[{"\[Omega]", "[", "1", "]"}]}]}], ")"}]}], "+", 
   RowBox[{
    RowBox[{"Cos", "[", 
     RowBox[{
      RowBox[{"k", " ", "x"}], "-", 
      RowBox[{"t", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
         RowBox[{"\[Epsilon]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Omega]", "[", "1", "]"}], "+", 
            RowBox[{"\[Epsilon]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Omega]", "[", "2", "]"}], "+", 
               RowBox[{"\[Epsilon]", " ", 
                RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], ")"}]}]}],
         ")"}]}]}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"8", " ", "g", " ", 
       RowBox[{"\[Eta]", "[", 
        RowBox[{"3", ",", "1"}], "]"}]}], "+", 
      RowBox[{"8", " ", 
       SuperscriptBox["k", "2"], " ", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Phi]", "[", 
          RowBox[{"1", ",", "1"}], "]"}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"\[Phi]", "[", 
           RowBox[{"2", ",", "2"}], "]"}]}]}], ")"}]}], "-", 
      RowBox[{"3", " ", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", 
       RowBox[{"\[Omega]", "[", "0", "]"}]}], "-", 
      RowBox[{"4", " ", "k", " ", 
       RowBox[{"\[Eta]", "[", 
        RowBox[{"2", ",", "2"}], "]"}], " ", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", 
       RowBox[{"\[Omega]", "[", "0", "]"}]}], "-", 
      RowBox[{"16", " ", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"2", ",", "2"}], "]"}], " ", 
       RowBox[{"\[Omega]", "[", "0", "]"}]}], "-", 
      RowBox[{"8", " ", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"3", ",", "1"}], "]"}], " ", 
       RowBox[{"\[Omega]", "[", "0", "]"}]}], "-", 
      RowBox[{"8", " ", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"2", ",", "1"}], "]"}], " ", 
       RowBox[{"\[Omega]", "[", "1", "]"}]}], "-", 
      RowBox[{"8", " ", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", 
       RowBox[{"\[Omega]", "[", "2", "]"}]}]}], ")"}]}]}], "\[Equal]", 
  RowBox[{
   RowBox[{"4", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"k", " ", 
       RowBox[{"\[Eta]", "[", 
        RowBox[{"2", ",", "1"}], "]"}], " ", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", 
       RowBox[{"\[Omega]", "[", "0", "]"}]}], "+", 
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"2", ",", "1"}], "]"}], " ", 
       RowBox[{"\[Omega]", "[", "0", "]"}]}], "+", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"4", " ", "k", " ", "x"}], "-", 
         RowBox[{"4", " ", "t", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
            RowBox[{"\[Epsilon]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Omega]", "[", "1", "]"}], "+", 
               RowBox[{"\[Epsilon]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Omega]", "[", "2", "]"}], "+", 
                  RowBox[{"\[Epsilon]", " ", 
                   RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], 
              ")"}]}]}], ")"}]}]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"k", " ", 
          RowBox[{"\[Eta]", "[", 
           RowBox[{"2", ",", "3"}], "]"}], " ", 
          RowBox[{"\[Phi]", "[", 
           RowBox[{"1", ",", "1"}], "]"}]}], "+", 
         RowBox[{"9", " ", 
          RowBox[{"\[Phi]", "[", 
           RowBox[{"2", ",", "3"}], "]"}]}]}], ")"}], " ", 
       RowBox[{"\[Omega]", "[", "0", "]"}]}], "+", 
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", 
       RowBox[{"\[Omega]", "[", "1", "]"}]}]}], ")"}]}], "+", 
   RowBox[{
    RowBox[{"Cos", "[", 
     RowBox[{
      RowBox[{"3", " ", "k", " ", "x"}], "-", 
      RowBox[{"3", " ", "t", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
         RowBox[{"\[Epsilon]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Omega]", "[", "1", "]"}], "+", 
            RowBox[{"\[Epsilon]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Omega]", "[", "2", "]"}], "+", 
               RowBox[{"\[Epsilon]", " ", 
                RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], ")"}]}]}],
         ")"}]}]}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"4", " ", "k", " ", 
          RowBox[{"\[Eta]", "[", 
           RowBox[{"2", ",", "2"}], "]"}]}]}], ")"}], " ", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", 
       RowBox[{"\[Omega]", "[", "0", "]"}]}], "+", 
      RowBox[{"8", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          RowBox[{"\[Phi]", "[", 
           RowBox[{"2", ",", "2"}], "]"}], " ", 
          RowBox[{"\[Omega]", "[", "0", "]"}]}], "+", 
         RowBox[{"3", " ", 
          RowBox[{"\[Phi]", "[", 
           RowBox[{"3", ",", "3"}], "]"}], " ", 
          RowBox[{"\[Omega]", "[", "0", "]"}]}], "+", 
         RowBox[{"3", " ", 
          RowBox[{"\[Phi]", "[", 
           RowBox[{"2", ",", "3"}], "]"}], " ", 
          RowBox[{"\[Omega]", "[", "1", "]"}]}]}], ")"}]}]}], 
     ")"}]}]}]}]], "Output",
 CellChangeTimes->{3.8738160778971243`*^9, 3.87382282791652*^9, 
  3.875285043447435*^9},
 CellLabel->
  "Out[1586]=",ExpressionUUID->"f21cee41-a837-4591-8c01-ebfe18a8d3f2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"g", " ", 
     RowBox[{"\[Eta]", "[", 
      RowBox[{"3", ",", "x", ",", "t"}], "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["\[Phi]", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "0", ",", "0", ",", "1"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"3", ",", "x", ",", "0", ",", "t"}], "]"}]}], "\[Equal]", 
   FractionBox[
    RowBox[{"g", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "4"}], " ", "g", " ", "k"}], "+", 
       SuperscriptBox["\[Omega]", "2"], "+", 
       RowBox[{"3", " ", 
        SuperscriptBox["\[Omega]", "2"], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"2", " ", "k", " ", "x"}], "-", 
          RowBox[{"2", " ", "t", " ", "\[Omega]"}]}], "]"}]}]}], ")"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       RowBox[{"k", " ", "x"}], "-", 
       RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], 
    RowBox[{"4", " ", "k", " ", 
     SuperscriptBox["\[Omega]", "2"]}]]}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.873805749768749*^9, 3.873805749774393*^9}},
 CellLabel->
  "In[1587]:=",ExpressionUUID->"492bee70-5114-4a53-b89a-a170faff1cc3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"g", " ", 
    RowBox[{"\[Eta]", "[", 
     RowBox[{"3", ",", "x", ",", "t"}], "]"}]}], "+", 
   RowBox[{
    SuperscriptBox["\[Phi]", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "0", ",", "0", ",", "1"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"3", ",", "x", ",", "0", ",", "t"}], "]"}]}], "\[Equal]", 
  FractionBox[
   RowBox[{"g", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "4"}], " ", "g", " ", "k"}], "+", 
      SuperscriptBox["\[Omega]", "2"], "+", 
      RowBox[{"3", " ", 
       SuperscriptBox["\[Omega]", "2"], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"2", " ", "k", " ", "x"}], "-", 
         RowBox[{"2", " ", "t", " ", "\[Omega]"}]}], "]"}]}]}], ")"}], " ", 
    RowBox[{"Cos", "[", 
     RowBox[{
      RowBox[{"k", " ", "x"}], "-", 
      RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], 
   RowBox[{"4", " ", "k", " ", 
    SuperscriptBox["\[Omega]", "2"]}]]}]], "Output",
 CellChangeTimes->{3.873816077915533*^9, 3.8738228279882307`*^9, 
  3.8752850435194197`*^9},
 CellLabel->
  "Out[1587]=",ExpressionUUID->"d9cc8363-2d81-4e4d-b99e-88e8972455a9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"bc3", " ", "=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Assuming", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"k", " ", "!=", " ", "0"}], " ", "&&", " ", 
       RowBox[{"g", " ", "!=", " ", "0"}], " ", "&&", " ", 
       RowBox[{"\[Omega]", " ", "!=", " ", "0"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"Simplify", "[", 
        RowBox[{"Eliminate", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"dbc", "[", 
                RowBox[{"[", "4", "]"}], "]"}], ",", "t"}], "]"}], "==", 
             "0"}], ",", 
            RowBox[{
             RowBox[{"kbc", "[", 
              RowBox[{"[", "4", "]"}], "]"}], "==", "0"}]}], "}"}], ",", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"\[Eta]", "[", 
             RowBox[{"3", ",", "x", ",", "t"}], "]"}], ",", "t"}], "]"}]}], 
         "]"}], " ", "]"}], "}"}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.87380575397246*^9, 3.873805767432578*^9}, {
   3.8738058008170633`*^9, 3.873805804695601*^9}, 3.873819199481806*^9},
 CellLabel->
  "In[1588]:=",ExpressionUUID->"9628363d-0953-4175-ab22-f4fc6fc33bbb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox[
    RowBox[{"16", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"4", " ", "k", " ", "x"}], "-", 
       RowBox[{"4", " ", "t", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
          RowBox[{"\[Epsilon]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Omega]", "[", "1", "]"}], "+", 
             RowBox[{"\[Epsilon]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[Omega]", "[", "2", "]"}], "+", 
                RowBox[{"\[Epsilon]", " ", 
                 RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], 
            ")"}]}]}], ")"}]}]}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"k", " ", 
        RowBox[{"\[Eta]", "[", 
         RowBox[{"2", ",", "3"}], "]"}], " ", 
        RowBox[{"\[Phi]", "[", 
         RowBox[{"1", ",", "1"}], "]"}]}], "+", 
       RowBox[{"3", " ", 
        RowBox[{"\[Phi]", "[", 
         RowBox[{"2", ",", "3"}], "]"}]}]}], ")"}]}], "k"], "\[Equal]", 
   RowBox[{"-", 
    RowBox[{
     FractionBox["1", 
      SuperscriptBox["k", "3"]], 
     RowBox[{"2", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"k", " ", "x"}], "-", 
        RowBox[{"t", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
           RowBox[{"\[Epsilon]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[Omega]", "[", "1", "]"}], "+", 
              RowBox[{"\[Epsilon]", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"\[Omega]", "[", "2", "]"}], "+", 
                 RowBox[{"\[Epsilon]", " ", 
                  RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], 
             ")"}]}]}], ")"}]}]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"3", " ", 
         SuperscriptBox["k", "2"], " ", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"1", ",", "1"}], "]"}]}], "+", 
        RowBox[{"8", " ", 
         SuperscriptBox["k", "3"], " ", 
         RowBox[{"\[Eta]", "[", 
          RowBox[{"2", ",", "2"}], "]"}], " ", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"1", ",", "1"}], "]"}]}], "+", 
        RowBox[{"16", " ", 
         SuperscriptBox["k", "2"], " ", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"2", ",", "2"}], "]"}]}], "+", 
        RowBox[{"4", " ", 
         SuperscriptBox["k", "2"], " ", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"3", ",", "1"}], "]"}]}], "+", 
        RowBox[{"12", " ", 
         SuperscriptBox["k", "2"], " ", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"3", ",", "3"}], "]"}]}], "-", 
        RowBox[{"4", " ", "k", " ", 
         RowBox[{"\[Eta]", "[", 
          RowBox[{"3", ",", "1"}], "]"}], " ", 
         RowBox[{"\[Omega]", "[", "0", "]"}]}], "-", 
        RowBox[{"12", " ", "k", " ", 
         RowBox[{"\[Eta]", "[", 
          RowBox[{"3", ",", "3"}], "]"}], " ", 
         RowBox[{"\[Omega]", "[", "0", "]"}]}], "-", 
        RowBox[{"4", " ", "k", " ", 
         RowBox[{"\[Eta]", "[", 
          RowBox[{"2", ",", "1"}], "]"}], " ", 
         RowBox[{"\[Omega]", "[", "1", "]"}]}], "-", 
        RowBox[{"12", " ", "k", " ", 
         RowBox[{"\[Eta]", "[", 
          RowBox[{"2", ",", "3"}], "]"}], " ", 
         RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
        RowBox[{"8", " ", "k", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"k", " ", "x"}], "-", 
           RowBox[{"t", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
              RowBox[{"\[Epsilon]", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"\[Omega]", "[", "1", "]"}], "+", 
                 RowBox[{"\[Epsilon]", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"\[Omega]", "[", "2", "]"}], "+", 
                    RowBox[{"\[Epsilon]", " ", 
                    RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], 
                ")"}]}]}], ")"}]}]}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["k", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[Eta]", "[", 
               RowBox[{"2", ",", "1"}], "]"}], "+", 
              RowBox[{"\[Eta]", "[", 
               RowBox[{"2", ",", "3"}], "]"}]}], ")"}], " ", 
            RowBox[{"\[Phi]", "[", 
             RowBox[{"1", ",", "1"}], "]"}]}], "+", 
           RowBox[{"k", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[Phi]", "[", 
               RowBox[{"2", ",", "1"}], "]"}], "+", 
              RowBox[{"3", " ", 
               RowBox[{"\[Phi]", "[", 
                RowBox[{"2", ",", "3"}], "]"}]}], "+", 
              RowBox[{"2", " ", 
               RowBox[{"\[Phi]", "[", 
                RowBox[{"3", ",", "2"}], "]"}]}]}], ")"}]}], "-", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"\[Eta]", "[", 
                RowBox[{"3", ",", "2"}], "]"}], " ", 
               RowBox[{"\[Omega]", "[", "0", "]"}]}], "+", 
              RowBox[{
               RowBox[{"\[Eta]", "[", 
                RowBox[{"2", ",", "2"}], "]"}], " ", 
               RowBox[{"\[Omega]", "[", "1", "]"}]}]}], ")"}]}]}], ")"}]}], 
        "+", 
        RowBox[{"3", " ", "k", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"2", " ", "k", " ", "x"}], "-", 
           RowBox[{"2", " ", "t", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
              RowBox[{"\[Epsilon]", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"\[Omega]", "[", "1", "]"}], "+", 
                 RowBox[{"\[Epsilon]", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"\[Omega]", "[", "2", "]"}], "+", 
                    RowBox[{"\[Epsilon]", " ", 
                    RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], 
                ")"}]}]}], ")"}]}]}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", " ", 
            SuperscriptBox["k", "2"], " ", 
            RowBox[{"\[Eta]", "[", 
             RowBox[{"2", ",", "2"}], "]"}], " ", 
            RowBox[{"\[Phi]", "[", 
             RowBox[{"1", ",", "1"}], "]"}]}], "+", 
           RowBox[{"k", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[Phi]", "[", 
               RowBox[{"1", ",", "1"}], "]"}], "+", 
              RowBox[{"8", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"\[Phi]", "[", 
                  RowBox[{"2", ",", "2"}], "]"}], "+", 
                 RowBox[{"\[Phi]", "[", 
                  RowBox[{"3", ",", "3"}], "]"}]}], ")"}]}]}], ")"}]}], "-", 
           RowBox[{"8", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"\[Eta]", "[", 
                RowBox[{"3", ",", "3"}], "]"}], " ", 
               RowBox[{"\[Omega]", "[", "0", "]"}]}], "+", 
              RowBox[{
               RowBox[{"\[Eta]", "[", 
                RowBox[{"2", ",", "3"}], "]"}], " ", 
               RowBox[{"\[Omega]", "[", "1", "]"}]}]}], ")"}]}]}], ")"}]}], 
        "-", 
        RowBox[{"4", " ", 
         RowBox[{"\[Omega]", "[", "2", "]"}]}]}], ")"}]}]}]}]}], "&&", 
  RowBox[{
   RowBox[{
    RowBox[{"Sin", "[", 
     RowBox[{
      RowBox[{"k", " ", "x"}], "-", 
      RowBox[{"t", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
         RowBox[{"\[Epsilon]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Omega]", "[", "1", "]"}], "+", 
            RowBox[{"\[Epsilon]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Omega]", "[", "2", "]"}], "+", 
               RowBox[{"\[Epsilon]", " ", 
                RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], ")"}]}]}],
         ")"}]}]}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "4"}], " ", "g", " ", 
       RowBox[{"\[Eta]", "[", 
        RowBox[{"3", ",", "1"}], "]"}]}], "-", 
      RowBox[{"12", " ", "g", " ", 
       RowBox[{"\[Eta]", "[", 
        RowBox[{"3", ",", "3"}], "]"}]}], "-", 
      RowBox[{"4", " ", 
       SuperscriptBox["k", "2"], " ", 
       SuperscriptBox[
        RowBox[{"\[Phi]", "[", 
         RowBox[{"1", ",", "1"}], "]"}], "2"]}], "-", 
      RowBox[{"8", " ", 
       SuperscriptBox["k", "2"], " ", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"2", ",", "2"}], "]"}]}], "+", 
      RowBox[{"3", " ", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", 
       RowBox[{"\[Omega]", "[", "0", "]"}]}], "+", 
      RowBox[{"8", " ", "k", " ", 
       RowBox[{"\[Eta]", "[", 
        RowBox[{"2", ",", "2"}], "]"}], " ", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", 
       RowBox[{"\[Omega]", "[", "0", "]"}]}], "+", 
      RowBox[{"16", " ", "k", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"3", " ", "k", " ", "x"}], "-", 
         RowBox[{"3", " ", "t", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
            RowBox[{"\[Epsilon]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Omega]", "[", "1", "]"}], "+", 
               RowBox[{"\[Epsilon]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Omega]", "[", "2", "]"}], "+", 
                  RowBox[{"\[Epsilon]", " ", 
                   RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], 
              ")"}]}]}], ")"}]}]}], "]"}], " ", 
       RowBox[{"\[Eta]", "[", 
        RowBox[{"2", ",", "3"}], "]"}], " ", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", 
       RowBox[{"\[Omega]", "[", "0", "]"}]}], "+", 
      RowBox[{"32", " ", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"2", ",", "2"}], "]"}], " ", 
       RowBox[{"\[Omega]", "[", "0", "]"}]}], "+", 
      RowBox[{"144", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"3", " ", "k", " ", "x"}], "-", 
         RowBox[{"3", " ", "t", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
            RowBox[{"\[Epsilon]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Omega]", "[", "1", "]"}], "+", 
               RowBox[{"\[Epsilon]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Omega]", "[", "2", "]"}], "+", 
                  RowBox[{"\[Epsilon]", " ", 
                   RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], 
              ")"}]}]}], ")"}]}]}], "]"}], " ", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"2", ",", "3"}], "]"}], " ", 
       RowBox[{"\[Omega]", "[", "0", "]"}]}], "+", 
      RowBox[{"4", " ", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"3", ",", "1"}], "]"}], " ", 
       RowBox[{"\[Omega]", "[", "0", "]"}]}], "+", 
      RowBox[{"36", " ", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"3", ",", "3"}], "]"}], " ", 
       RowBox[{"\[Omega]", "[", "0", "]"}]}], "+", 
      RowBox[{"4", " ", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"2", ",", "1"}], "]"}], " ", 
       RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
      RowBox[{"36", " ", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"2", ",", "3"}], "]"}], " ", 
       RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
      RowBox[{"8", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"k", " ", "x"}], "-", 
         RowBox[{"t", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
            RowBox[{"\[Epsilon]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Omega]", "[", "1", "]"}], "+", 
               RowBox[{"\[Epsilon]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Omega]", "[", "2", "]"}], "+", 
                  RowBox[{"\[Epsilon]", " ", 
                   RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], 
              ")"}]}]}], ")"}]}]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "g", " ", 
          RowBox[{"\[Eta]", "[", 
           RowBox[{"3", ",", "2"}], "]"}]}], "-", 
         RowBox[{"6", " ", 
          SuperscriptBox["k", "2"], " ", 
          RowBox[{"\[Phi]", "[", 
           RowBox[{"1", ",", "1"}], "]"}], " ", 
          RowBox[{"\[Phi]", "[", 
           RowBox[{"2", ",", "3"}], "]"}]}], "+", 
         RowBox[{"k", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Eta]", "[", 
             RowBox[{"2", ",", "1"}], "]"}], "+", 
            RowBox[{"3", " ", 
             RowBox[{"\[Eta]", "[", 
              RowBox[{"2", ",", "3"}], "]"}]}]}], ")"}], " ", 
          RowBox[{"\[Phi]", "[", 
           RowBox[{"1", ",", "1"}], "]"}], " ", 
          RowBox[{"\[Omega]", "[", "0", "]"}]}], "+", 
         RowBox[{
          RowBox[{"\[Phi]", "[", 
           RowBox[{"2", ",", "1"}], "]"}], " ", 
          RowBox[{"\[Omega]", "[", "0", "]"}]}], "+", 
         RowBox[{"27", " ", 
          RowBox[{"\[Phi]", "[", 
           RowBox[{"2", ",", "3"}], "]"}], " ", 
          RowBox[{"\[Omega]", "[", "0", "]"}]}], "+", 
         RowBox[{"4", " ", 
          RowBox[{"\[Phi]", "[", 
           RowBox[{"3", ",", "2"}], "]"}], " ", 
          RowBox[{"\[Omega]", "[", "0", "]"}]}], "+", 
         RowBox[{
          RowBox[{"\[Phi]", "[", 
           RowBox[{"1", ",", "1"}], "]"}], " ", 
          RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
         RowBox[{"4", " ", 
          RowBox[{"\[Phi]", "[", 
           RowBox[{"2", ",", "2"}], "]"}], " ", 
          RowBox[{"\[Omega]", "[", "1", "]"}]}]}], ")"}]}], "+", 
      RowBox[{"3", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"2", " ", "k", " ", "x"}], "-", 
         RowBox[{"2", " ", "t", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
            RowBox[{"\[Epsilon]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Omega]", "[", "1", "]"}], "+", 
               RowBox[{"\[Epsilon]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Omega]", "[", "2", "]"}], "+", 
                  RowBox[{"\[Epsilon]", " ", 
                   RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], 
              ")"}]}]}], ")"}]}]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "8"}], " ", "g", " ", 
          RowBox[{"\[Eta]", "[", 
           RowBox[{"3", ",", "3"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"4", " ", "k", " ", 
             RowBox[{"\[Eta]", "[", 
              RowBox[{"2", ",", "2"}], "]"}]}]}], ")"}], " ", 
          RowBox[{"\[Phi]", "[", 
           RowBox[{"1", ",", "1"}], "]"}], " ", 
          RowBox[{"\[Omega]", "[", "0", "]"}]}], "+", 
         RowBox[{"8", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", 
             RowBox[{"\[Phi]", "[", 
              RowBox[{"2", ",", "2"}], "]"}], " ", 
             RowBox[{"\[Omega]", "[", "0", "]"}]}], "+", 
            RowBox[{"3", " ", 
             RowBox[{"\[Phi]", "[", 
              RowBox[{"3", ",", "3"}], "]"}], " ", 
             RowBox[{"\[Omega]", "[", "0", "]"}]}], "+", 
            RowBox[{"3", " ", 
             RowBox[{"\[Phi]", "[", 
              RowBox[{"2", ",", "3"}], "]"}], " ", 
             RowBox[{"\[Omega]", "[", "1", "]"}]}]}], ")"}]}]}], ")"}]}], "+", 
      RowBox[{"4", " ", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", 
       RowBox[{"\[Omega]", "[", "2", "]"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
      RowBox[{"\[Epsilon]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Omega]", "[", "1", "]"}], "+", 
         RowBox[{"\[Epsilon]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Omega]", "[", "2", "]"}], "+", 
            RowBox[{"\[Epsilon]", " ", 
             RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], ")"}]}]}], 
     ")"}]}], "\[Equal]", "0"}]}]], "Output",
 CellChangeTimes->{3.873805805661832*^9, 3.873816078404892*^9, 
  3.873819200639738*^9, 3.8738228284729233`*^9, 3.875285066097344*^9},
 CellLabel->
  "Out[1588]=",ExpressionUUID->"a0e9bfc5-3135-49a6-a4ba-15dd5594e246"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Solving for Third Solution", "Section",
 CellChangeTimes->{{3.873805959976576*^9, 
  3.873805968752687*^9}},ExpressionUUID->"da0baece-ce1d-4be2-bfc0-\
532fe3422f07"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Phi]", "[", 
     RowBox[{"3", ",", "x", ",", "z", ",", "t"}], "]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"0", " ", "*", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"3", " ", "k", " ", "x"}], " ", "-", " ", 
        RowBox[{"3", " ", "\[Omega]", " ", "t"}]}], "]"}], " ", "*", " ", 
      RowBox[{"Exp", "[", 
       RowBox[{"3", " ", "k", " ", "z"}], "]"}]}], " ", "+", " ", 
     RowBox[{"0", "*", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"k", " ", "x"}], " ", "-", "  ", 
        RowBox[{"\[Omega]", " ", "t"}]}], "]"}], "*", 
      RowBox[{"Exp", "[", 
       RowBox[{"k", " ", "z"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Recompute", " ", "BC"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kbc", " ", "=", " ", 
   RowBox[{"TrigReduce", "[", 
    RowBox[{"CoefficientList", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"eta", ",", "t"}], "]"}], " ", "+", " ", 
        RowBox[{
         RowBox[{"Taylor", "[", 
          RowBox[{"D", "[", 
           RowBox[{"phi", ",", "x"}], "]"}], "]"}], 
         RowBox[{"D", "[", 
          RowBox[{"eta", ",", "x"}], "]"}]}], " ", "-", " ", 
        RowBox[{"Taylor", "[", 
         RowBox[{"D", "[", 
          RowBox[{"phi", ",", "z"}], "]"}], "]"}]}], " ", "/.", " ", 
       RowBox[{"z", "->", "0"}]}], ",", "\[Epsilon]"}], "]"}], " ", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dbc", " ", "=", " ", 
   RowBox[{"CoefficientList", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Taylor", "[", 
        RowBox[{"D", "[", 
         RowBox[{"phi", ",", "t"}], "]"}], "]"}], " ", "+", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", "2"}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Taylor", "[", 
            RowBox[{"D", "[", 
             RowBox[{"phi", ",", "x"}], "]"}], "]"}], "^", "2"}], " ", "+", 
          " ", 
          RowBox[{
           RowBox[{"Taylor", "[", 
            RowBox[{"D", "[", 
             RowBox[{"phi", ",", "z"}], "]"}], "]"}], "^", "2"}]}], ")"}]}], 
       " ", "+", " ", 
       RowBox[{"g", "*", "eta"}]}], " ", "/.", " ", 
      RowBox[{"z", "->", " ", "0"}]}], ",", "\[Epsilon]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"bc3", " ", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Assuming", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"k", " ", "!=", " ", "0"}], " ", "&&", " ", 
          RowBox[{"g", " ", "!=", " ", "0"}], " ", "&&", " ", 
          RowBox[{"\[Omega]", " ", "!=", " ", "0"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"Simplify", "[", 
           RowBox[{"Eliminate", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"dbc", "[", 
                   RowBox[{"[", "4", "]"}], "]"}], ",", "t"}], "]"}], "==", 
                "0"}], ",", 
               RowBox[{
                RowBox[{"kbc", "[", 
                 RowBox[{"[", "4", "]"}], "]"}], "==", "0"}]}], "}"}], ",", 
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"\[Eta]", "[", 
                RowBox[{"3", ",", "x", ",", "t"}], "]"}], ",", "t"}], "]"}]}],
             "]"}], " ", "]"}], "}"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], " ", "/.", " ", 
      RowBox[{"\[Omega]", " ", "->", " ", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"g", " ", "k"}], "]"}]}]}], "]"}], ")"}], " ", "/.", " ", 
   RowBox[{
    RowBox[{"Sqrt", "[", 
     RowBox[{"g", " ", "k"}], "]"}], " ", "->", " ", 
    "\[Omega]"}]}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.873805976442676*^9, 3.873806028975121*^9}, {
  3.873806281934464*^9, 3.8738063505363617`*^9}, {3.8738064959046926`*^9, 
  3.87380650710433*^9}, {3.8738065496242247`*^9, 3.873806579277844*^9}, {
  3.873807051470586*^9, 3.873807056733306*^9}, {3.873807099237694*^9, 
  3.8738071018038273`*^9}, {3.873816635138131*^9, 3.873816639655135*^9}, {
  3.873816691071504*^9, 3.873816706035947*^9}, {3.873816787498178*^9, 
  3.873816788489677*^9}, {3.8738173201296997`*^9, 3.873817320504146*^9}, {
  3.8738179492688828`*^9, 3.873818010465187*^9}},
 CellLabel->
  "In[1589]:=",ExpressionUUID->"74c01240-e321-4611-bdf7-5ddde4ca801c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox[
    RowBox[{"16", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"4", " ", "k", " ", "x"}], "-", 
       RowBox[{"4", " ", "t", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
          RowBox[{"\[Epsilon]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Omega]", "[", "1", "]"}], "+", 
             RowBox[{"\[Epsilon]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[Omega]", "[", "2", "]"}], "+", 
                RowBox[{"\[Epsilon]", " ", 
                 RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], 
            ")"}]}]}], ")"}]}]}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"k", " ", 
        RowBox[{"\[Eta]", "[", 
         RowBox[{"2", ",", "3"}], "]"}], " ", 
        RowBox[{"\[Phi]", "[", 
         RowBox[{"1", ",", "1"}], "]"}]}], "+", 
       RowBox[{"3", " ", 
        RowBox[{"\[Phi]", "[", 
         RowBox[{"2", ",", "3"}], "]"}]}]}], ")"}]}], "k"], "\[Equal]", 
   RowBox[{"-", 
    RowBox[{
     FractionBox["1", 
      SuperscriptBox["k", "3"]], 
     RowBox[{"2", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"k", " ", "x"}], "-", 
        RowBox[{"t", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
           RowBox[{"\[Epsilon]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[Omega]", "[", "1", "]"}], "+", 
              RowBox[{"\[Epsilon]", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"\[Omega]", "[", "2", "]"}], "+", 
                 RowBox[{"\[Epsilon]", " ", 
                  RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], 
             ")"}]}]}], ")"}]}]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"3", " ", 
         SuperscriptBox["k", "2"], " ", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"1", ",", "1"}], "]"}]}], "+", 
        RowBox[{"8", " ", 
         SuperscriptBox["k", "3"], " ", 
         RowBox[{"\[Eta]", "[", 
          RowBox[{"2", ",", "2"}], "]"}], " ", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"1", ",", "1"}], "]"}]}], "+", 
        RowBox[{"16", " ", 
         SuperscriptBox["k", "2"], " ", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"2", ",", "2"}], "]"}]}], "+", 
        RowBox[{"4", " ", 
         SuperscriptBox["k", "2"], " ", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"3", ",", "1"}], "]"}]}], "+", 
        RowBox[{"12", " ", 
         SuperscriptBox["k", "2"], " ", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"3", ",", "3"}], "]"}]}], "-", 
        RowBox[{"4", " ", "k", " ", 
         RowBox[{"\[Eta]", "[", 
          RowBox[{"3", ",", "1"}], "]"}], " ", 
         RowBox[{"\[Omega]", "[", "0", "]"}]}], "-", 
        RowBox[{"12", " ", "k", " ", 
         RowBox[{"\[Eta]", "[", 
          RowBox[{"3", ",", "3"}], "]"}], " ", 
         RowBox[{"\[Omega]", "[", "0", "]"}]}], "-", 
        RowBox[{"4", " ", "k", " ", 
         RowBox[{"\[Eta]", "[", 
          RowBox[{"2", ",", "1"}], "]"}], " ", 
         RowBox[{"\[Omega]", "[", "1", "]"}]}], "-", 
        RowBox[{"12", " ", "k", " ", 
         RowBox[{"\[Eta]", "[", 
          RowBox[{"2", ",", "3"}], "]"}], " ", 
         RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
        RowBox[{"8", " ", "k", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"k", " ", "x"}], "-", 
           RowBox[{"t", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
              RowBox[{"\[Epsilon]", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"\[Omega]", "[", "1", "]"}], "+", 
                 RowBox[{"\[Epsilon]", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"\[Omega]", "[", "2", "]"}], "+", 
                    RowBox[{"\[Epsilon]", " ", 
                    RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], 
                ")"}]}]}], ")"}]}]}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"k", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"k", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"\[Eta]", "[", 
                  RowBox[{"2", ",", "1"}], "]"}], "+", 
                 RowBox[{"\[Eta]", "[", 
                  RowBox[{"2", ",", "3"}], "]"}]}], ")"}], " ", 
               RowBox[{"\[Phi]", "[", 
                RowBox[{"1", ",", "1"}], "]"}]}], "+", 
              RowBox[{"\[Phi]", "[", 
               RowBox[{"2", ",", "1"}], "]"}], "+", 
              RowBox[{"3", " ", 
               RowBox[{"\[Phi]", "[", 
                RowBox[{"2", ",", "3"}], "]"}]}], "+", 
              RowBox[{"2", " ", 
               RowBox[{"\[Phi]", "[", 
                RowBox[{"3", ",", "2"}], "]"}]}]}], ")"}]}], "-", 
           RowBox[{"2", " ", 
            RowBox[{"\[Eta]", "[", 
             RowBox[{"3", ",", "2"}], "]"}], " ", 
            RowBox[{"\[Omega]", "[", "0", "]"}]}], "-", 
           RowBox[{"2", " ", 
            RowBox[{"\[Eta]", "[", 
             RowBox[{"2", ",", "2"}], "]"}], " ", 
            RowBox[{"\[Omega]", "[", "1", "]"}]}]}], ")"}]}], "+", 
        RowBox[{"3", " ", "k", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"2", " ", "k", " ", "x"}], "-", 
           RowBox[{"2", " ", "t", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
              RowBox[{"\[Epsilon]", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"\[Omega]", "[", "1", "]"}], "+", 
                 RowBox[{"\[Epsilon]", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"\[Omega]", "[", "2", "]"}], "+", 
                    RowBox[{"\[Epsilon]", " ", 
                    RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], 
                ")"}]}]}], ")"}]}]}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"k", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"4", " ", "k", " ", 
               RowBox[{"\[Eta]", "[", 
                RowBox[{"2", ",", "2"}], "]"}]}]}], ")"}], " ", 
            RowBox[{"\[Phi]", "[", 
             RowBox[{"1", ",", "1"}], "]"}]}], "+", 
           RowBox[{"8", " ", "k", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[Phi]", "[", 
               RowBox[{"2", ",", "2"}], "]"}], "+", 
              RowBox[{"\[Phi]", "[", 
               RowBox[{"3", ",", "3"}], "]"}]}], ")"}]}], "-", 
           RowBox[{"8", " ", 
            RowBox[{"\[Eta]", "[", 
             RowBox[{"3", ",", "3"}], "]"}], " ", 
            RowBox[{"\[Omega]", "[", "0", "]"}]}], "-", 
           RowBox[{"8", " ", 
            RowBox[{"\[Eta]", "[", 
             RowBox[{"2", ",", "3"}], "]"}], " ", 
            RowBox[{"\[Omega]", "[", "1", "]"}]}]}], ")"}]}], "-", 
        RowBox[{"4", " ", 
         RowBox[{"\[Omega]", "[", "2", "]"}]}]}], ")"}]}]}]}]}], "&&", 
  RowBox[{
   RowBox[{
    RowBox[{"Sin", "[", 
     RowBox[{
      RowBox[{"k", " ", "x"}], "-", 
      RowBox[{"t", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
         RowBox[{"\[Epsilon]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Omega]", "[", "1", "]"}], "+", 
            RowBox[{"\[Epsilon]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Omega]", "[", "2", "]"}], "+", 
               RowBox[{"\[Epsilon]", " ", 
                RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], ")"}]}]}],
         ")"}]}]}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "4"}], " ", "g", " ", 
       RowBox[{"\[Eta]", "[", 
        RowBox[{"3", ",", "1"}], "]"}]}], "-", 
      RowBox[{"12", " ", "g", " ", 
       RowBox[{"\[Eta]", "[", 
        RowBox[{"3", ",", "3"}], "]"}]}], "-", 
      RowBox[{"4", " ", 
       SuperscriptBox["k", "2"], " ", 
       SuperscriptBox[
        RowBox[{"\[Phi]", "[", 
         RowBox[{"1", ",", "1"}], "]"}], "2"]}], "-", 
      RowBox[{"8", " ", 
       SuperscriptBox["k", "2"], " ", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"2", ",", "2"}], "]"}]}], "+", 
      RowBox[{"3", " ", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", 
       RowBox[{"\[Omega]", "[", "0", "]"}]}], "+", 
      RowBox[{"8", " ", "k", " ", 
       RowBox[{"\[Eta]", "[", 
        RowBox[{"2", ",", "2"}], "]"}], " ", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", 
       RowBox[{"\[Omega]", "[", "0", "]"}]}], "+", 
      RowBox[{"16", " ", "k", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"3", " ", "k", " ", "x"}], "-", 
         RowBox[{"3", " ", "t", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
            RowBox[{"\[Epsilon]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Omega]", "[", "1", "]"}], "+", 
               RowBox[{"\[Epsilon]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Omega]", "[", "2", "]"}], "+", 
                  RowBox[{"\[Epsilon]", " ", 
                   RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], 
              ")"}]}]}], ")"}]}]}], "]"}], " ", 
       RowBox[{"\[Eta]", "[", 
        RowBox[{"2", ",", "3"}], "]"}], " ", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", 
       RowBox[{"\[Omega]", "[", "0", "]"}]}], "+", 
      RowBox[{"32", " ", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"2", ",", "2"}], "]"}], " ", 
       RowBox[{"\[Omega]", "[", "0", "]"}]}], "+", 
      RowBox[{"144", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"3", " ", "k", " ", "x"}], "-", 
         RowBox[{"3", " ", "t", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
            RowBox[{"\[Epsilon]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Omega]", "[", "1", "]"}], "+", 
               RowBox[{"\[Epsilon]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Omega]", "[", "2", "]"}], "+", 
                  RowBox[{"\[Epsilon]", " ", 
                   RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], 
              ")"}]}]}], ")"}]}]}], "]"}], " ", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"2", ",", "3"}], "]"}], " ", 
       RowBox[{"\[Omega]", "[", "0", "]"}]}], "+", 
      RowBox[{"4", " ", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"3", ",", "1"}], "]"}], " ", 
       RowBox[{"\[Omega]", "[", "0", "]"}]}], "+", 
      RowBox[{"36", " ", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"3", ",", "3"}], "]"}], " ", 
       RowBox[{"\[Omega]", "[", "0", "]"}]}], "+", 
      RowBox[{"4", " ", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"2", ",", "1"}], "]"}], " ", 
       RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
      RowBox[{"36", " ", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"2", ",", "3"}], "]"}], " ", 
       RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
      RowBox[{"8", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"k", " ", "x"}], "-", 
         RowBox[{"t", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
            RowBox[{"\[Epsilon]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Omega]", "[", "1", "]"}], "+", 
               RowBox[{"\[Epsilon]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Omega]", "[", "2", "]"}], "+", 
                  RowBox[{"\[Epsilon]", " ", 
                   RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], 
              ")"}]}]}], ")"}]}]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "g", " ", 
          RowBox[{"\[Eta]", "[", 
           RowBox[{"3", ",", "2"}], "]"}]}], "-", 
         RowBox[{"6", " ", 
          SuperscriptBox["k", "2"], " ", 
          RowBox[{"\[Phi]", "[", 
           RowBox[{"1", ",", "1"}], "]"}], " ", 
          RowBox[{"\[Phi]", "[", 
           RowBox[{"2", ",", "3"}], "]"}]}], "+", 
         RowBox[{"k", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Eta]", "[", 
             RowBox[{"2", ",", "1"}], "]"}], "+", 
            RowBox[{"3", " ", 
             RowBox[{"\[Eta]", "[", 
              RowBox[{"2", ",", "3"}], "]"}]}]}], ")"}], " ", 
          RowBox[{"\[Phi]", "[", 
           RowBox[{"1", ",", "1"}], "]"}], " ", 
          RowBox[{"\[Omega]", "[", "0", "]"}]}], "+", 
         RowBox[{
          RowBox[{"\[Phi]", "[", 
           RowBox[{"2", ",", "1"}], "]"}], " ", 
          RowBox[{"\[Omega]", "[", "0", "]"}]}], "+", 
         RowBox[{"27", " ", 
          RowBox[{"\[Phi]", "[", 
           RowBox[{"2", ",", "3"}], "]"}], " ", 
          RowBox[{"\[Omega]", "[", "0", "]"}]}], "+", 
         RowBox[{"4", " ", 
          RowBox[{"\[Phi]", "[", 
           RowBox[{"3", ",", "2"}], "]"}], " ", 
          RowBox[{"\[Omega]", "[", "0", "]"}]}], "+", 
         RowBox[{
          RowBox[{"\[Phi]", "[", 
           RowBox[{"1", ",", "1"}], "]"}], " ", 
          RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
         RowBox[{"4", " ", 
          RowBox[{"\[Phi]", "[", 
           RowBox[{"2", ",", "2"}], "]"}], " ", 
          RowBox[{"\[Omega]", "[", "1", "]"}]}]}], ")"}]}], "+", 
      RowBox[{"3", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"2", " ", "k", " ", "x"}], "-", 
         RowBox[{"2", " ", "t", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
            RowBox[{"\[Epsilon]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Omega]", "[", "1", "]"}], "+", 
               RowBox[{"\[Epsilon]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Omega]", "[", "2", "]"}], "+", 
                  RowBox[{"\[Epsilon]", " ", 
                   RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], 
              ")"}]}]}], ")"}]}]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "8"}], " ", "g", " ", 
          RowBox[{"\[Eta]", "[", 
           RowBox[{"3", ",", "3"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Phi]", "[", 
             RowBox[{"1", ",", "1"}], "]"}], "+", 
            RowBox[{"4", " ", "k", " ", 
             RowBox[{"\[Eta]", "[", 
              RowBox[{"2", ",", "2"}], "]"}], " ", 
             RowBox[{"\[Phi]", "[", 
              RowBox[{"1", ",", "1"}], "]"}]}], "+", 
            RowBox[{"16", " ", 
             RowBox[{"\[Phi]", "[", 
              RowBox[{"2", ",", "2"}], "]"}]}], "+", 
            RowBox[{"24", " ", 
             RowBox[{"\[Phi]", "[", 
              RowBox[{"3", ",", "3"}], "]"}]}]}], ")"}], " ", 
          RowBox[{"\[Omega]", "[", "0", "]"}]}], "+", 
         RowBox[{"24", " ", 
          RowBox[{"\[Phi]", "[", 
           RowBox[{"2", ",", "3"}], "]"}], " ", 
          RowBox[{"\[Omega]", "[", "1", "]"}]}]}], ")"}]}], "+", 
      RowBox[{"4", " ", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", 
       RowBox[{"\[Omega]", "[", "2", "]"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
      RowBox[{"\[Epsilon]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Omega]", "[", "1", "]"}], "+", 
         RowBox[{"\[Epsilon]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Omega]", "[", "2", "]"}], "+", 
            RowBox[{"\[Epsilon]", " ", 
             RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], ")"}]}]}], 
     ")"}]}], "\[Equal]", "0"}]}]], "Output",
 CellChangeTimes->{
  3.8738064345986*^9, 3.873806510229789*^9, {3.8738065517535143`*^9, 
   3.873806580855686*^9}, 3.8738070613676767`*^9, 3.873807106076981*^9, 
   3.873816078589669*^9, 3.873816640907648*^9, 3.873816707382468*^9, 
   3.873816792028286*^9, 3.873817321188051*^9, 3.873817955501212*^9, 
   3.873818011421131*^9, 3.873818998345142*^9, 3.873822828568207*^9, 
   3.875285137672804*^9},
 CellLabel->
  "Out[1592]=",ExpressionUUID->"de4c9fec-9510-4b10-a191-be14f481996a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TrigReduce", "[", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"dbc", "[", 
        RowBox[{"[", "4", "]"}], "]"}], " ", "==", " ", "0"}], ",", " ", 
      RowBox[{"\[Eta]", "[", 
       RowBox[{"3", ",", "x", ",", "t"}], "]"}]}], "]"}], " ", "/.", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"k", " ", "x"}], " ", "-", " ", 
         RowBox[{"\[Omega]", " ", "t"}]}], ")"}], " ", "->", " ", 
       "\[Theta]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"2", "k", " ", "x"}], " ", "-", " ", 
        RowBox[{"2", " ", "\[Omega]", " ", "t"}]}], " ", "->", " ", 
       RowBox[{"2", "\[Theta]"}]}], ",", " ", 
      RowBox[{"\[Omega]", " ", "->", " ", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"g", " ", "k"}], "]"}]}]}], "}"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.873806377147025*^9, 3.873806386994934*^9}, {
   3.873806526663589*^9, 3.873806541589506*^9}, {3.873806893555106*^9, 
   3.873806962759501*^9}, {3.8738070812768383`*^9, 3.87380709353067*^9}, 
   3.8738166309137793`*^9, {3.873816915164222*^9, 3.873816920980193*^9}, {
   3.87381734975169*^9, 3.873817378085094*^9}, {3.873818027928645*^9, 
   3.873818290338118*^9}, {3.87381891764285*^9, 3.873818924017603*^9}},
 CellLabel->
  "In[1593]:=",ExpressionUUID->"e171f9eb-6db3-47e6-8754-c7c474a89f46"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{{3.873818132910099*^9, 3.873818291824868*^9}, 
   3.873818924464532*^9, 3.873819002222638*^9, 3.873822828588952*^9, 
   3.875285138015793*^9},
 CellLabel->
  "Out[1593]=",ExpressionUUID->"6d6a3d81-02c1-4d77-a91a-05ab7c446dcc"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "Scratch", "*)"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.873559910919359*^9, 3.873559913275982*^9}, {
   3.8738188834342127`*^9, 3.8738188951942263`*^9}, 3.873818935173424*^9},
 CellLabel->
  "In[1594]:=",ExpressionUUID->"62003d93-2616-458f-8116-014764e321da"],

Cell["\<\
I\[CloseCurlyQuote]m running into a bit of a problem here. I know that there \
should be no third order contribution to the velocity potential, hence 0, but \
the combined BC in the section above won\[CloseCurlyQuote]t be satisfied if \
that\[CloseCurlyQuote]s true. This is most likely because \
it\[CloseCurlyQuote]s at this order where changes to \[Omega] that come out \
of time derivatives will start to show up to third order. Therefore, the way \
I\[CloseCurlyQuote]ve been going about this is not entirely right, because it \
matches everything to powers of \[Epsilon] but assumes that everything else \
is order 1. \
\>", "Text",
 CellChangeTimes->{
  3.873818933780315*^9, {3.8738193131548023`*^9, 3.873819441751302*^9}},
 NumberMarks->False,ExpressionUUID->"9104de84-62e8-4860-8a12-49c2c01c78be"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Solve Laplace\[CloseCurlyQuote]s Eq. with BC at each Order", "Section",
 CellChangeTimes->{{3.872680795466733*^9, 3.872680796154861*^9}, {
  3.8726809472377872`*^9, 3.872680953062263*^9}, {3.872681097234797*^9, 
  3.872681098001719*^9}, {3.872681141240919*^9, 3.872681227629107*^9}, {
  3.87268557488763*^9, 3.872685584326208*^9}, {3.87268594778747*^9, 
  3.8726859677139473`*^9}, {3.872686283962945*^9, 3.8726862846396914`*^9}, {
  3.87269361041891*^9, 3.872693629962452*^9}, {3.872697892154241*^9, 
  3.8726978948983927`*^9}, {3.872786797205165*^9, 
  3.872786799388935*^9}},ExpressionUUID->"0d59ae0e-75b4-475f-be58-\
0055d3427f68"],

Cell["\<\
Now we set our boundary conditions to apply at z=0, so we can solve Laplace\
\[CloseCurlyQuote]s equation more easily.\
\>", "Text",
 CellChangeTimes->{{3.872786807716743*^9, 
  3.872786827956827*^9}},ExpressionUUID->"beb639e8-ef69-484c-8105-\
39903374d2cc"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"We", " ", "know", " ", "lowest", " ", "order"}], ",", " ", 
    RowBox[{
    "but", " ", "can", " ", "also", " ", "combine", " ", "bc", " ", "to", " ",
      "remove", " ", "\[Eta]"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"bc1", " ", "=", " ", 
   RowBox[{"Eliminate", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"dbc", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", "t"}], "]"}], "==", "0"}], 
       ",", 
       RowBox[{
        RowBox[{"kbc", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "==", "0"}]}], "}"}], ",", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"\[Eta]", "[", 
        RowBox[{"1", ",", "x", ",", "t"}], "]"}], ",", "t"}], "]"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.872788240677607*^9, 3.872788271206172*^9}, {
  3.87278833013957*^9, 3.87278836838853*^9}, {3.872788407162757*^9, 
  3.8727884492917767`*^9}, {3.87278848097579*^9, 3.872788494510352*^9}},
 CellLabel->
  "In[1595]:=",ExpressionUUID->"ca3210d9-9235-4b75-82e1-522edc8ebd3f"],

Cell[BoxData[
 TemplateBox[{
  "General", "ivar", 
   "\"\\!\\(\\*RowBox[{\\\"0\\\"}]\\) is not a valid variable.\"", 2, 1595, 
   91, 29504127468218165255, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.873290657220058*^9, 3.87329088740376*^9, 3.873291156767387*^9, 
   3.873292288477078*^9, {3.873307287759775*^9, 3.873307295347273*^9}, 
   3.873307360212775*^9, 3.873384831694437*^9, {3.873803432893038*^9, 
   3.873803477514948*^9}, 3.873803609348564*^9, 3.873804085841654*^9, 
   3.873804215126624*^9, 3.8738042854052153`*^9, 3.873804403072318*^9, 
   3.873816078664899*^9, 3.87382282864023*^9, 3.8752851380725613`*^9},
 CellLabel->
  "During evaluation of \
In[1595]:=",ExpressionUUID->"c8f26110-61c1-46e0-b132-4d92d2efff76"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Sin", "[", 
     RowBox[{
      RowBox[{"k", " ", "x"}], "-", 
      RowBox[{"t", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
         RowBox[{"\[Epsilon]", " ", 
          RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["\[Epsilon]", "2"], " ", 
          RowBox[{"\[Omega]", "[", "2", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["\[Epsilon]", "3"], " ", 
          RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], "]"}], " ", 
    RowBox[{"\[Phi]", "[", 
     RowBox[{"1", ",", "1"}], "]"}]}], "\[Equal]", 
   FractionBox[
    RowBox[{
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"k", " ", "x"}], "-", 
       RowBox[{"t", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
          RowBox[{"\[Epsilon]", " ", 
           RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
          RowBox[{
           SuperscriptBox["\[Epsilon]", "2"], " ", 
           RowBox[{"\[Omega]", "[", "2", "]"}]}], "+", 
          RowBox[{
           SuperscriptBox["\[Epsilon]", "3"], " ", 
           RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], "]"}], " ", 
     RowBox[{"\[Omega]", "[", "0", "]"}]}], 
    SuperscriptBox["k", "2"]]}], "&&", 
  RowBox[{
   RowBox[{"\[Epsilon]", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{
      RowBox[{"k", " ", "x"}], "-", 
      RowBox[{"t", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
         RowBox[{"\[Epsilon]", " ", 
          RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["\[Epsilon]", "2"], " ", 
          RowBox[{"\[Omega]", "[", "2", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["\[Epsilon]", "3"], " ", 
          RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{"g", "-", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"\[Omega]", "[", "0", "]"}], "2"], "k"]}], ")"}], " ", 
    RowBox[{"\[Omega]", "[", "1", "]"}]}], "\[Equal]", 
   RowBox[{
    RowBox[{"Sin", "[", 
     RowBox[{
      RowBox[{"k", " ", "x"}], "-", 
      RowBox[{"t", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
         RowBox[{"\[Epsilon]", " ", 
          RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["\[Epsilon]", "2"], " ", 
          RowBox[{"\[Omega]", "[", "2", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["\[Epsilon]", "3"], " ", 
          RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "g"}], " ", 
       RowBox[{"\[Omega]", "[", "0", "]"}]}], "+", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"\[Omega]", "[", "0", "]"}], "3"], "k"], "-", 
      RowBox[{"g", " ", 
       SuperscriptBox["\[Epsilon]", "2"], " ", 
       RowBox[{"\[Omega]", "[", "2", "]"}]}], "+", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[Epsilon]", "2"], " ", 
        SuperscriptBox[
         RowBox[{"\[Omega]", "[", "0", "]"}], "2"], " ", 
        RowBox[{"\[Omega]", "[", "2", "]"}]}], "k"], "-", 
      RowBox[{"g", " ", 
       SuperscriptBox["\[Epsilon]", "3"], " ", 
       RowBox[{"\[Omega]", "[", "3", "]"}]}], "+", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[Epsilon]", "3"], " ", 
        SuperscriptBox[
         RowBox[{"\[Omega]", "[", "0", "]"}], "2"], " ", 
        RowBox[{"\[Omega]", "[", "3", "]"}]}], "k"]}], ")"}]}]}], "&&", 
  RowBox[{"k", "\[NotEqual]", "0"}]}]], "Output",
 CellChangeTimes->{
  3.872788369323968*^9, {3.87278842688013*^9, 3.872788450087862*^9}, 
   3.872788495762123*^9, 3.8732906572420273`*^9, 3.8732908874276047`*^9, 
   3.873291156791559*^9, 3.873292288499186*^9, {3.8733072877840776`*^9, 
   3.87330729536989*^9}, 3.8733073602256107`*^9, 3.873384831705049*^9, {
   3.873803432905368*^9, 3.8738034775254374`*^9}, 3.87380360935923*^9, 
   3.873804085852872*^9, 3.873804215137936*^9, 3.873804285419064*^9, 
   3.8738044030840673`*^9, 3.8738160786765623`*^9, 3.873822828653113*^9, 
   3.8752851380887623`*^9},
 CellLabel->
  "Out[1595]=",ExpressionUUID->"e6c4af49-a918-437d-b060-33cc267d3913"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sol", " ", "=", " ", 
  RowBox[{"DSolveValue", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"laplace", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "==", "0"}], ",", "bc1"}], "}"}], ",", 
    RowBox[{"\[Phi]", "[", 
     RowBox[{"1", ",", "x", ",", "z", ",", "t"}], "]"}], ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "z"}], "}"}], "\[Element]", " ", 
     RowBox[{"Rectangle", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.872693644727715*^9, 3.872693646746153*^9}, {
   3.872697301934421*^9, 3.872697314448123*^9}, {3.8726976662905684`*^9, 
   3.872697727424883*^9}, {3.872697791766266*^9, 3.872697795734581*^9}, 
   3.872697865468214*^9, {3.872697966313066*^9, 3.872697994911955*^9}, {
   3.872700660425107*^9, 3.872700698293839*^9}, {3.872700743558298*^9, 
   3.872700752067506*^9}, {3.872700873473709*^9, 3.872700883863351*^9}, {
   3.8727012484907637`*^9, 3.8727013466156187`*^9}, {3.872701602735317*^9, 
   3.872701638136058*^9}, {3.872701803427588*^9, 3.872701813952693*^9}, {
   3.8727022286855917`*^9, 3.872702270402216*^9}, {3.872702483340808*^9, 
   3.872702503034721*^9}, {3.872702809486753*^9, 3.87270284404678*^9}, {
   3.872770162297042*^9, 3.872770223568071*^9}, {3.872770297774149*^9, 
   3.872770328517054*^9}, {3.872770386884671*^9, 3.872770416153862*^9}, {
   3.8727704464507227`*^9, 3.8727704544731407`*^9}, {3.872770554441564*^9, 
   3.872770555029799*^9}, 3.872770892930172*^9, {3.872771525110516*^9, 
   3.872771525837797*^9}, {3.8727720671711197`*^9, 3.872772103562394*^9}, {
   3.8727721688960733`*^9, 3.872772180822348*^9}, 3.8727723946947727`*^9, {
   3.872772536898789*^9, 3.87277258999992*^9}, {3.872788126700288*^9, 
   3.872788225600178*^9}, {3.8727885286552973`*^9, 3.872788529389926*^9}},
 CellLabel->
  "In[1596]:=",ExpressionUUID->"ffac39f8-af49-43a5-88bf-fde620caa63c"],

Cell[BoxData[
 TemplateBox[{
  "Part", "partw", 
   "\"Part \\!\\(\\*RowBox[{\\\"2\\\"}]\\) of \\!\\(\\*RowBox[{\\\"{\\\", \
\\\"}\\\"}]\\) does not exist.\"", 2, 1596, 92, 29504127468218165255, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.873290657291429*^9, 3.8732908874824333`*^9, 3.873291156869012*^9, 
   3.873292288554295*^9, {3.8733072878449917`*^9, 3.873307295430334*^9}, 
   3.8733073604156523`*^9, 3.873384831724722*^9, {3.873803432923565*^9, 
   3.873803477562331*^9}, 3.873803609375917*^9, 3.873804085870481*^9, 
   3.873804215156011*^9, 3.8738042854365177`*^9, 3.873804403100799*^9, 
   3.873816078715425*^9, 3.8738228286902647`*^9, 3.87528513811386*^9},
 CellLabel->
  "During evaluation of \
In[1596]:=",ExpressionUUID->"5fc63437-931f-4445-92c6-db8ce4dc7613"],

Cell[BoxData[
 TemplateBox[{
  "DSolveValue", "dsfun", "\"The function specification is not valid.\"", 2, 
   1596, 93, 29504127468218165255, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.873290657291429*^9, 3.8732908874824333`*^9, 3.873291156869012*^9, 
   3.873292288554295*^9, {3.8733072878449917`*^9, 3.873307295430334*^9}, 
   3.8733073604156523`*^9, 3.873384831724722*^9, {3.873803432923565*^9, 
   3.873803477562331*^9}, 3.873803609375917*^9, 3.873804085870481*^9, 
   3.873804215156011*^9, 3.8738042854365177`*^9, 3.873804403100799*^9, 
   3.873816078715425*^9, 3.8738228286902647`*^9, 3.8752851381283407`*^9},
 CellLabel->
  "During evaluation of \
In[1596]:=",ExpressionUUID->"de293771-f25a-4830-9012-d89f6d67e909"],

Cell[BoxData[
 RowBox[{"DSolveValue", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", "}"}], "\[LeftDoubleBracket]", "2", 
       "\[RightDoubleBracket]"}], "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"k", " ", "x"}], "-", 
          RowBox[{"t", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
             RowBox[{"\[Epsilon]", " ", 
              RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
             RowBox[{
              SuperscriptBox["\[Epsilon]", "2"], " ", 
              RowBox[{"\[Omega]", "[", "2", "]"}]}], "+", 
             RowBox[{
              SuperscriptBox["\[Epsilon]", "3"], " ", 
              RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], "]"}], " ", 
        
        RowBox[{"\[Phi]", "[", 
         RowBox[{"1", ",", "1"}], "]"}]}], "\[Equal]", 
       FractionBox[
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"k", " ", "x"}], "-", 
           RowBox[{"t", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
              RowBox[{"\[Epsilon]", " ", 
               RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
              RowBox[{
               SuperscriptBox["\[Epsilon]", "2"], " ", 
               RowBox[{"\[Omega]", "[", "2", "]"}]}], "+", 
              RowBox[{
               SuperscriptBox["\[Epsilon]", "3"], " ", 
               RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], "]"}], " ", 
         RowBox[{"\[Omega]", "[", "0", "]"}]}], 
        SuperscriptBox["k", "2"]]}], "&&", 
      RowBox[{
       RowBox[{"\[Epsilon]", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"k", " ", "x"}], "-", 
          RowBox[{"t", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
             RowBox[{"\[Epsilon]", " ", 
              RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
             RowBox[{
              SuperscriptBox["\[Epsilon]", "2"], " ", 
              RowBox[{"\[Omega]", "[", "2", "]"}]}], "+", 
             RowBox[{
              SuperscriptBox["\[Epsilon]", "3"], " ", 
              RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], "]"}], " ", 
        
        RowBox[{"(", 
         RowBox[{"g", "-", 
          FractionBox[
           SuperscriptBox[
            RowBox[{"\[Omega]", "[", "0", "]"}], "2"], "k"]}], ")"}], " ", 
        RowBox[{"\[Omega]", "[", "1", "]"}]}], "\[Equal]", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"k", " ", "x"}], "-", 
          RowBox[{"t", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Omega]", "[", "0", "]"}], "+", 
             RowBox[{"\[Epsilon]", " ", 
              RowBox[{"\[Omega]", "[", "1", "]"}]}], "+", 
             RowBox[{
              SuperscriptBox["\[Epsilon]", "2"], " ", 
              RowBox[{"\[Omega]", "[", "2", "]"}]}], "+", 
             RowBox[{
              SuperscriptBox["\[Epsilon]", "3"], " ", 
              RowBox[{"\[Omega]", "[", "3", "]"}]}]}], ")"}]}]}], "]"}], " ", 
        
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "g"}], " ", 
           RowBox[{"\[Omega]", "[", "0", "]"}]}], "+", 
          FractionBox[
           SuperscriptBox[
            RowBox[{"\[Omega]", "[", "0", "]"}], "3"], "k"], "-", 
          RowBox[{"g", " ", 
           SuperscriptBox["\[Epsilon]", "2"], " ", 
           RowBox[{"\[Omega]", "[", "2", "]"}]}], "+", 
          FractionBox[
           RowBox[{
            SuperscriptBox["\[Epsilon]", "2"], " ", 
            SuperscriptBox[
             RowBox[{"\[Omega]", "[", "0", "]"}], "2"], " ", 
            RowBox[{"\[Omega]", "[", "2", "]"}]}], "k"], "-", 
          RowBox[{"g", " ", 
           SuperscriptBox["\[Epsilon]", "3"], " ", 
           RowBox[{"\[Omega]", "[", "3", "]"}]}], "+", 
          FractionBox[
           RowBox[{
            SuperscriptBox["\[Epsilon]", "3"], " ", 
            SuperscriptBox[
             RowBox[{"\[Omega]", "[", "0", "]"}], "2"], " ", 
            RowBox[{"\[Omega]", "[", "3", "]"}]}], "k"]}], ")"}]}]}], "&&", 
      RowBox[{"k", "\[NotEqual]", "0"}]}]}], "}"}], ",", "1", ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", "z"}], "}"}], "\[Element]", 
    RowBox[{"Rectangle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", 
        RowBox[{"-", "1"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.8727703292263203`*^9, {3.872770387286809*^9, 3.872770416697279*^9}, {
   3.872770447450014*^9, 3.8727704549637423`*^9}, {3.872770555687169*^9, 
   3.8727705595520887`*^9}, 3.872770725107173*^9, 3.872770893402926*^9, 
   3.872771527547018*^9, {3.872772083660479*^9, 3.872772104079178*^9}, 
   3.872772182320363*^9, 3.87277239516247*^9, {3.87277254838529*^9, 
   3.872772590377039*^9}, {3.8727881462480497`*^9, 3.8727881774332867`*^9}, 
   3.872788226591741*^9, 3.872788531492332*^9, 3.873290657313401*^9, 
   3.8732908875085983`*^9, 3.8732911568917933`*^9, 3.873292288577038*^9, {
   3.873307287867762*^9, 3.87330729545289*^9}, 3.873307360426044*^9, 
   3.873384831735209*^9, {3.87380343293607*^9, 3.87380347757308*^9}, 
   3.873803609386047*^9, 3.87380408588183*^9, 3.873804215169642*^9, 
   3.8738042854473467`*^9, 3.8738044031120043`*^9, 3.873816078727208*^9, 
   3.873822828703022*^9, 3.875285138144704*^9},
 CellLabel->
  "Out[1596]=",ExpressionUUID->"b06ed8db-0d85-433c-8cfd-fe9f46e59c41"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DSolveValue", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Phi]", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "2", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"1", ",", "x", ",", "z", ",", "t"}], "]"}], "+", 
      RowBox[{
       SuperscriptBox["\[Phi]", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "2", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"1", ",", "x", ",", "z", ",", "t"}], "]"}]}], "\[Equal]", 
     "0"}], "}"}], ",", "\[Phi]", ",", 
   RowBox[{"{", " ", 
    RowBox[{",", "x", ",", "z", ",", "t"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8727022027321777`*^9, 3.872702203012106*^9}},
 CellLabel->
  "In[1597]:=",ExpressionUUID->"48cbda8f-5c3f-4350-a8c6-87022269fdc2"],

Cell[BoxData[
 TemplateBox[{
  "DSolveValue", "deqx", 
   "\"Supplied equations are not differential or integral equations of the \
given functions.\"", 2, 1597, 94, 29504127468218165255, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.872702204233244*^9, 3.873290657344235*^9, 3.87329088754138*^9, 
   3.873291156925304*^9, 3.873292288608058*^9, {3.87330728789865*^9, 
   3.87330729550307*^9}, 3.8733848317756777`*^9, {3.8738034329808903`*^9, 
   3.873803477591634*^9}, 3.8738036094096613`*^9, 3.8738040859162292`*^9, 
   3.8738042152063837`*^9, 3.873804285481979*^9, 3.873804403150773*^9, 
   3.873816078746014*^9, 3.873822828723399*^9, 3.875285138190184*^9},
 CellLabel->
  "During evaluation of \
In[1597]:=",ExpressionUUID->"829b306c-62d5-4b44-ae99-479ed94fe6d6"],

Cell[BoxData[
 RowBox[{"DSolveValue", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Phi]", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "2", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"1", ",", "x", ",", "z", ",", "t"}], "]"}], "+", 
      RowBox[{
       SuperscriptBox["\[Phi]", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "2", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"1", ",", "x", ",", "z", ",", "t"}], "]"}]}], "\[Equal]", 
     "0"}], "}"}], ",", "\[Phi]", ",", 
   RowBox[{"{", 
    RowBox[{"Null", ",", "x", ",", "z", ",", "t"}], "}"}]}], "]"}]], "Output",\

 CellChangeTimes->{
  3.873290657366128*^9, 3.873290887564466*^9, 3.873291156947007*^9, 
   3.87329228863004*^9, {3.873307287921089*^9, 3.8733072955259113`*^9}, 
   3.873384831786583*^9, {3.8738034329919157`*^9, 3.873803477604927*^9}, 
   3.873803609421185*^9, 3.873804085927305*^9, 3.873804215217677*^9, 
   3.8738042854930553`*^9, 3.873804403162394*^9, 3.873816078757215*^9, 
   3.87382282873514*^9, 3.875285138204968*^9},
 CellLabel->
  "Out[1597]=",ExpressionUUID->"b6ea6ca4-4892-4b65-94d7-4e4aef3711cf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DSolveValue", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Phi]", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "2", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"1", ",", "x", ",", "z", ",", "t"}], "]"}], "+", 
      RowBox[{
       SuperscriptBox["\[Phi]", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "2", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"1", ",", "x", ",", "z", ",", "t"}], "]"}]}], "\[Equal]", 
     "0"}], "}"}], ",", "\[Phi]", ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "z", ",", "t"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.872702781712679*^9, 3.8727027904969378`*^9}},
 CellLabel->
  "In[1598]:=",ExpressionUUID->"3600d42f-a03f-412a-a48a-4449efef0515"],

Cell[BoxData[
 RowBox[{"DSolveValue", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Phi]", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "2", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"1", ",", "x", ",", "z", ",", "t"}], "]"}], "+", 
      RowBox[{
       SuperscriptBox["\[Phi]", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "2", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"1", ",", "x", ",", "z", ",", "t"}], "]"}]}], "\[Equal]", 
     "0"}], "}"}], ",", "\[Phi]", ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "z", ",", "t"}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.87270279134536*^9, 3.873290657415954*^9, 3.87329088762164*^9, 
   3.873291156994668*^9, 3.873292288681885*^9, {3.873307288030518*^9, 
   3.8733072955699797`*^9}, 3.873384831858159*^9, {3.8738034330107718`*^9, 
   3.873803477641214*^9}, 3.87380360943785*^9, 3.87380408594447*^9, 
   3.873804215236356*^9, 3.873804285510613*^9, 3.87380440318187*^9, 
   3.87381607879659*^9, 3.873822828772101*^9, 3.875285138229003*^9},
 CellLabel->
  "Out[1598]=",ExpressionUUID->"c15041af-8498-4d40-8478-c01e5565acde"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DSolveValue", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Laplacian", "[", 
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"x", ",", "y"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y"}], "}"}]}], "]"}], "==", "0"}], ",", " ", 
     RowBox[{"DirichletCondition", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"x", ",", "y"}], "]"}], "==", "1"}], ",", "True"}], "]"}]}], 
    "}"}], ",", 
   RowBox[{"T", "[", 
    RowBox[{"x", ",", "y"}], "]"}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}], " ", "\[Element]", " ", 
    RowBox[{"Rectangle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}]}], "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8727019105475397`*^9, 3.872701915188861*^9}, {
   3.8727021761801577`*^9, 3.8727021931318417`*^9}, {3.8727704264987097`*^9, 
   3.872770428241497*^9}, {3.872770650379174*^9, 3.8727706692500153`*^9}, 
   3.872770963051203*^9, {3.872772116217368*^9, 3.872772127208078*^9}, {
   3.872772189991404*^9, 3.872772200437598*^9}, {3.8727724027200737`*^9, 
   3.872772433549279*^9}, 3.872781775914712*^9, {3.872787874621481*^9, 
   3.872787896505808*^9}, {3.872787929859495*^9, 3.8727879302521687`*^9}, {
   3.8727879605130033`*^9, 3.872787963120144*^9}, {3.872787997207733*^9, 
   3.872788100323553*^9}},
 CellLabel->
  "In[1599]:=",ExpressionUUID->"8658832d-206f-4a44-90c6-0952a12bcaac"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{
  3.8727817781851263`*^9, {3.872787880114581*^9, 3.872787897205467*^9}, 
   3.8727879638171043`*^9, {3.872788008870398*^9, 3.8727881007546453`*^9}, 
   3.873290657465464*^9, 3.8732908876705914`*^9, 3.873291157042158*^9, 
   3.873292288734157*^9, {3.8733072880940247`*^9, 3.873307295658347*^9}, 
   3.873307360516078*^9, 3.873384831904189*^9, {3.873803433059206*^9, 
   3.873803477677164*^9}, 3.873803609465262*^9, 3.873804085978774*^9, 
   3.873804215273018*^9, 3.873804285544457*^9, 3.873804403221528*^9, 
   3.8738160788375177`*^9, 3.8738228288104258`*^9, 3.875285138275413*^9},
 CellLabel->
  "Out[1599]=",ExpressionUUID->"e3e1bb06-0ed1-427b-89aa-1fc0df921070"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DSolve", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        SuperscriptBox["T", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "2"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y"}], "]"}], "+", 
       RowBox[{
        SuperscriptBox["T", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"2", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y"}], "]"}]}], "\[Equal]", "0"}], ",", 
     RowBox[{"DirichletCondition", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"x", ",", "y"}], "]"}], "==", "0"}], ",", "True"}], "]"}]}], 
    "}"}], ",", 
   RowBox[{"T", "[", 
    RowBox[{"x", ",", "y"}], "]"}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}], " ", "\[Element]", " ", 
    RowBox[{"Rectangle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "L"}], ",", 
        RowBox[{"-", "h"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"L", ",", "0"}], "}"}]}], "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.872774519535153*^9, 3.8727745204716463`*^9}, {
   3.872774553503786*^9, 3.872774644071663*^9}, {3.872781656972665*^9, 
   3.8727816789862022`*^9}, {3.872781718635748*^9, 3.872781747849126*^9}, {
   3.8727877549701366`*^9, 3.872787766198744*^9}, 3.8727878114796333`*^9},
 CellLabel->
  "In[1600]:=",ExpressionUUID->"0c60b59b-6e24-4c62-a466-21987d49c29a"],

Cell[BoxData[
 RowBox[{"DSolve", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        SuperscriptBox["T", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "2"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y"}], "]"}], "+", 
       RowBox[{
        SuperscriptBox["T", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"2", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y"}], "]"}]}], "\[Equal]", "0"}], ",", 
     RowBox[{"DirichletCondition", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"x", ",", "y"}], "]"}], "\[Equal]", "0"}], ",", "True"}], 
      "]"}]}], "}"}], ",", 
   RowBox[{"T", "[", 
    RowBox[{"x", ",", "y"}], "]"}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}], "\[Element]", 
    RowBox[{"Rectangle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "L"}], ",", 
        RowBox[{"-", "h"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"L", ",", "0"}], "}"}]}], "]"}]}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.8727745213540897`*^9, {3.8727745590627327`*^9, 3.872774581094612*^9}, {
   3.872774617822332*^9, 3.872774640875022*^9}, 3.8727815158947763`*^9, {
   3.8727816730648746`*^9, 3.872781679412128*^9}, {3.872781719897894*^9, 
   3.872781748613545*^9}, 3.8727877677335377`*^9, 3.872787811976529*^9, 
   3.873290657515683*^9, 3.8732908879030437`*^9, 3.873291157089016*^9, 
   3.87329228878615*^9, {3.8733072881487713`*^9, 3.8733072957023087`*^9}, 
   3.873384831947674*^9, {3.87380343310669*^9, 3.873803477713381*^9}, 
   3.8738036094883003`*^9, 3.87380408601433*^9, 3.8738042153101397`*^9, 
   3.873804285579609*^9, 3.873804403261818*^9, 3.87381607887875*^9, 
   3.873822828847105*^9, 3.8752851383223047`*^9},
 CellLabel->
  "Out[1600]=",ExpressionUUID->"7172edb7-ba6e-461f-afb3-bb6af13e7d4a"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8726835837806797`*^9, 3.872683626269375*^9}, 
   3.87268595779274*^9},
 CellLabel->
  "In[1601]:=",ExpressionUUID->"72991f45-0e2b-4b91-9871-27fe23ce9f49"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{791, 792},
WindowMargins->{{283, Automatic}, {Automatic, 0}},
FrontEndVersion->"13.1 for Mac OS X x86 (64-bit) (June 16, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"22284fe3-5080-4a3d-83b4-42fd98a02797"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 181, 3, 98, "Title",ExpressionUUID->"b00a80b6-6bb9-45e9-b949-0996d304dd9f"],
Cell[764, 27, 221, 6, 85, "Subtitle",ExpressionUUID->"171d7166-04ce-4e9b-8e0e-f9bc540ed745"],
Cell[988, 35, 274, 5, 30, "Input",ExpressionUUID->"492a0b1f-8802-4cde-8d5f-2482156ea0af"],
Cell[CellGroupData[{
Cell[1287, 44, 164, 3, 67, "Section",ExpressionUUID->"cb9d3b79-5f20-4de2-bc64-6f2a6441573d"],
Cell[1454, 49, 12428, 307, 698, "Text",ExpressionUUID->"6db499c1-8a50-4e78-a4b5-b29203035bf3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13919, 361, 215, 4, 67, "Section",ExpressionUUID->"9274f81e-b79a-4ee0-9378-ac8ed9446c36"],
Cell[CellGroupData[{
Cell[14159, 369, 3780, 92, 262, "Input",ExpressionUUID->"d28214ab-a569-432c-a31f-35f9e89de257"],
Cell[17942, 463, 6620, 188, 236, "Output",ExpressionUUID->"258c6b7d-8a13-45d5-8aea-e7183b83f31b"],
Cell[24565, 653, 5891, 170, 221, "Output",ExpressionUUID->"b6b1b259-4063-4c97-9947-34fbecb789f5"]
}, Open  ]],
Cell[30471, 826, 1172, 25, 52, "Input",ExpressionUUID->"5ba5cfe9-4bc8-4cd9-bfb5-ea8e872d2c62"],
Cell[CellGroupData[{
Cell[31668, 855, 535, 14, 52, "Input",ExpressionUUID->"cf63aacc-b963-469f-8e31-f049253fe51c"],
Cell[32206, 871, 1471, 22, 48, "Output",ExpressionUUID->"58a0faf0-84d3-4ba1-b7e4-b74488f6e979"]
}, Open  ]],
Cell[33692, 896, 1797, 40, 73, "Input",ExpressionUUID->"8807aa22-4d2e-4014-a94f-30409f739391"],
Cell[35492, 938, 198, 4, 30, "Input",ExpressionUUID->"803ba42d-4eb9-443a-a73c-d7f38ae1c9bf"],
Cell[CellGroupData[{
Cell[35715, 946, 1539, 32, 52, "Input",ExpressionUUID->"e631a0b0-cb2a-4fb1-a5aa-c78fbcbf322f"],
Cell[37257, 980, 1704, 43, 70, "Output",ExpressionUUID->"a2329da9-cbb9-4f17-8640-ebefc523f12d"]
}, Open  ]],
Cell[38976, 1026, 249, 4, 30, "Input",ExpressionUUID->"28ff057a-a164-4bc4-8b5d-5bd4380047f1"],
Cell[39228, 1032, 1497, 39, 115, "Input",ExpressionUUID->"abaa8b3b-256f-4398-abaa-3194e8aa4a48"],
Cell[CellGroupData[{
Cell[40750, 1075, 955, 22, 52, "Input",ExpressionUUID->"f571322c-de27-41cc-8a37-f8a06f98dc94"],
Cell[41708, 1099, 2008, 47, 70, "Output",ExpressionUUID->"7366b5cc-eab3-482b-ac6b-99f015d1002b"]
}, Open  ]],
Cell[43731, 1149, 225, 4, 30, "Input",ExpressionUUID->"300d3410-9514-45e5-a308-c44fbd42b001"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43993, 1158, 264, 4, 67, "Section",ExpressionUUID->"c33935e2-bfb4-49c5-92c1-568e82b64ca6"],
Cell[44260, 1164, 486, 9, 35, "Text",ExpressionUUID->"e9b48876-698c-418c-98ac-ffc875955536"],
Cell[44749, 1175, 1581, 39, 52, "Input",ExpressionUUID->"81e5b6cc-555c-407d-95e5-43d479fd6595"],
Cell[CellGroupData[{
Cell[46355, 1218, 1661, 38, 95, "Input",ExpressionUUID->"ce41a24e-d0a8-462f-a932-fc689416550e"],
Cell[48019, 1258, 869, 23, 70, "Output",ExpressionUUID->"35e1293b-b2e3-4f92-8958-7aaa58c78927"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48925, 1286, 1879, 50, 73, "Input",ExpressionUUID->"3e702687-dba8-4ed4-9858-6d4ecf5ac6c3"],
Cell[50807, 1338, 670, 16, 48, "Output",ExpressionUUID->"3db87317-8d03-48fb-913d-bbc56d7f5ad1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51514, 1359, 2073, 52, 73, "Input",ExpressionUUID->"80023062-7256-40f5-ae9e-af9ea0aeac8d"],
Cell[53590, 1413, 592, 14, 48, "Output",ExpressionUUID->"ef7575da-e248-4aad-b934-d5a05fc42bfb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[54219, 1432, 1269, 26, 52, "Input",ExpressionUUID->"566dc369-8ab9-41ab-8f9c-3c5d1db95472"],
Cell[55491, 1460, 230, 4, 48, "Output",ExpressionUUID->"79aca984-8611-405c-9924-12f0d92f68d8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[55758, 1469, 1754, 45, 73, InheritFromParent,ExpressionUUID->"c40f17a5-fe34-476e-bd11-03345b1febd2"],
Cell[57515, 1516, 562, 13, 73, "Output",ExpressionUUID->"678762bc-90f9-4250-94cf-5d65737817ee"],
Cell[58080, 1531, 431, 8, 34, "Output",ExpressionUUID->"f8f18423-0e8c-4dfe-b06d-d025732bb3a6"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[58560, 1545, 195, 3, 67, "Section",ExpressionUUID->"280102cf-3c68-4a18-baa9-3286f4703e1d"],
Cell[CellGroupData[{
Cell[58780, 1552, 2265, 56, 178, InheritFromParent,ExpressionUUID->"3cc05013-3a75-4c94-8359-6621ef659c2d"],
Cell[61048, 1610, 623, 16, 63, "Output",ExpressionUUID->"7f1841b8-f8df-4425-8db8-0ecce47b5bd1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[61708, 1631, 3369, 85, 283, "Input",ExpressionUUID->"8be3d68a-9c7b-4f3b-b6cd-5154ac6d4a48"],
Cell[65080, 1718, 775, 17, 48, "Output",ExpressionUUID->"06ab8acc-6aa0-41f6-8e57-1285e412ff61"]
}, Open  ]],
Cell[CellGroupData[{
Cell[65892, 1740, 2125, 58, 199, "Input",ExpressionUUID->"ce37bee1-f4dc-4fef-8753-ff09d1e68c21"],
Cell[68020, 1800, 1196, 23, 48, "Output",ExpressionUUID->"3236ed43-a0c8-4a7a-9795-f4ae1c06a851"]
}, Open  ]],
Cell[69231, 1826, 448, 6, 35, "Text",ExpressionUUID->"f0f3b849-c736-4075-926a-fea16d52ef7a"],
Cell[CellGroupData[{
Cell[69704, 1836, 1962, 49, 115, "Input",ExpressionUUID->"282d3dcb-3bae-4527-990d-4678b1077e6e"],
Cell[71669, 1887, 759, 16, 73, "Output",ExpressionUUID->"f655cefb-59d4-4f84-9c8e-49b64154e974"],
Cell[72431, 1905, 803, 17, 49, "Output",ExpressionUUID->"7bd4aa14-2b87-414c-9601-4b3125f40ee3"],
Cell[73237, 1924, 858, 17, 62, "Message",ExpressionUUID->"aefff90d-d121-4e45-a5a6-29d02b0189f8"],
Cell[74098, 1943, 658, 15, 42, "Message",ExpressionUUID->"542c8d76-7afd-46a0-9947-092da6d47dcf"],
Cell[74759, 1960, 859, 16, 42, "Message",ExpressionUUID->"0bc749ca-81df-4d24-a782-bdd6058f14c7"],
Cell[75621, 1978, 569, 13, 34, "Output",ExpressionUUID->"b4794b4d-b7cf-457d-b7cf-b7da0ea4e63a"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[76239, 1997, 681, 10, 67, "Section",ExpressionUUID->"7d3ad541-0dc3-494d-a7c8-19da8886e329"],
Cell[CellGroupData[{
Cell[76945, 2011, 2501, 61, 199, "Input",ExpressionUUID->"de2de41c-b57f-490c-967a-718f76d99e95"],
Cell[79449, 2074, 477, 14, 64, "Output",ExpressionUUID->"48f9fd8c-87c4-4639-b45f-60474de1e13c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[79963, 2093, 2268, 60, 241, "Input",ExpressionUUID->"4d1e3475-2976-473b-8df6-30ef539a8d9e"],
Cell[82234, 2155, 530, 14, 48, "Output",ExpressionUUID->"f16039d6-59cf-437b-b2fb-b5b67b4c8b78"]
}, Open  ]],
Cell[CellGroupData[{
Cell[82801, 2174, 2926, 74, 241, InheritFromParent,ExpressionUUID->"7aed649f-08c5-44b0-a640-c83afa618a8a"],
Cell[85730, 2250, 610, 19, 69, "Output",ExpressionUUID->"60d1661a-e753-4c46-a234-d719706a4f29"]
}, Open  ]],
Cell[CellGroupData[{
Cell[86377, 2274, 1781, 47, 115, "Text",ExpressionUUID->"d1f86c52-7ddf-4d55-9c7f-46463580375c"],
Cell[88161, 2323, 467, 12, 73, "Output",ExpressionUUID->"f5d95681-8ae4-4e59-8bf7-4a83bd25bc29"],
Cell[88631, 2337, 862, 24, 64, "Output",ExpressionUUID->"6e7b6a34-86a9-496a-9e30-58e9b8da0678"]
}, Open  ]],
Cell[89508, 2364, 239, 5, 30, "Text",ExpressionUUID->"866d3bef-4a28-41ea-963b-dd4ff4352543"]
}, Open  ]],
Cell[CellGroupData[{
Cell[89784, 2374, 307, 5, 67, "Section",ExpressionUUID->"7482126b-1ebb-48d4-a4e9-e393e6739f5d"],
Cell[90094, 2381, 347, 5, 35, "Text",ExpressionUUID->"26b0bbb3-f100-40c8-a921-d8f7616718ba"],
Cell[CellGroupData[{
Cell[90466, 2390, 2295, 52, 136, "Input",ExpressionUUID->"8e432576-bdbd-4270-b8c2-989a518a0eae"],
Cell[92764, 2444, 2006, 42, 1275, "Output",ExpressionUUID->"7cb71671-22c2-434c-a8eb-d7e4bcd9d7a0"]
}, Open  ]],
Cell[94785, 2489, 303, 5, 30, "Input",ExpressionUUID->"78464b50-4f75-459b-b2ba-794dd084b928"],
Cell[95091, 2496, 302, 5, 30, "Input",ExpressionUUID->"e2800158-3cd5-4c50-8c9f-120860157783"],
Cell[CellGroupData[{
Cell[95418, 2505, 403, 9, 30, "Input",ExpressionUUID->"f01e29bf-10de-43b7-af62-538c0c39958a"],
Cell[95824, 2516, 12397, 330, 369, "Output",ExpressionUUID->"c0056f70-0b22-41d7-ab5a-1acd07398b6f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[108258, 2851, 3272, 85, 241, "Input",ExpressionUUID->"fdb0cb0d-31d8-416d-91f9-2a1de88543b2"],
Cell[111533, 2938, 598, 10, 48, "Output",ExpressionUUID->"9965fb58-e465-4a59-b801-2eda68a6dd8e"],
Cell[112134, 2950, 601, 10, 48, "Output",ExpressionUUID->"dc51f159-6f61-40d1-88b6-99dcce62c574"],
Cell[112738, 2962, 599, 10, 34, "Output",ExpressionUUID->"2282210a-268d-4d69-98f7-8fb78dc30c98"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[113386, 2978, 172, 3, 67, "Section",ExpressionUUID->"49ce2238-68a3-4723-898e-dbb6fd81056c"],
Cell[113561, 2983, 176, 3, 30, InheritFromParent,ExpressionUUID->"856f20d0-34e1-432f-af91-14bcd53ed645"],
Cell[113740, 2988, 293, 7, 35, "Text",ExpressionUUID->"570a3c73-9078-43e9-bdbf-ec78f7814338"],
Cell[CellGroupData[{
Cell[114058, 2999, 4017, 108, 262, "Input",ExpressionUUID->"2aca4a3a-95da-499a-acb2-25f649ce45ef"],
Cell[118078, 3109, 9089, 246, 269, "Output",ExpressionUUID->"364b7d64-cb4d-4bb0-b4c7-0f0a47fd0622"]
}, Open  ]],
Cell[127182, 3358, 329, 7, 35, "Text",ExpressionUUID->"37e07e2c-f9a1-4721-b9c3-38a5844d411f"],
Cell[CellGroupData[{
Cell[127536, 3369, 1891, 46, 115, "Text",ExpressionUUID->"b197d847-52d6-4cb6-9869-54ec49f46bd6"],
Cell[129430, 3417, 396, 9, 28, "Message",ExpressionUUID->"7c8ee40e-a0be-498c-89d7-9aaa5d0b3cd9"],
Cell[129829, 3428, 441, 8, 48, "Output",ExpressionUUID->"2428727e-cd13-47e0-8a2b-053a9a6a3586"]
}, Open  ]],
Cell[CellGroupData[{
Cell[130307, 3441, 432, 9, 73, "Text",ExpressionUUID->"232cf917-2ae2-4efc-8ed0-810410d79a25"],
Cell[130742, 3452, 6237, 170, 190, "Output",ExpressionUUID->"ec5c08b0-90f4-4de9-8869-5275e7a661b0"],
Cell[136982, 3624, 5650, 156, 209, "Output",ExpressionUUID->"83a5deb3-2fd7-418f-a453-114b84dfe404"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[142681, 3786, 179, 3, 67, "Section",ExpressionUUID->"0c61ca42-2ef7-4493-af30-cce583d837b2"],
Cell[142863, 3791, 1169, 31, 53, "Text",ExpressionUUID->"898818ec-2765-4383-a253-7301d5937b42"],
Cell[144035, 3824, 202, 4, 30, "Input",ExpressionUUID->"ee7e8782-3e46-40ab-b203-ed8bf6d7ce23"],
Cell[CellGroupData[{
Cell[144262, 3832, 1349, 33, 136, "Input",ExpressionUUID->"9a44e161-517f-423b-8e3d-15c972194446"],
Cell[145614, 3867, 15844, 435, 614, "Output",ExpressionUUID->"eb51181c-1c10-4266-b16f-e4025a125c97"]
}, Open  ]],
Cell[CellGroupData[{
Cell[161495, 4307, 1244, 35, 115, "Input",ExpressionUUID->"44d72002-f6e4-417e-b3cc-794e5758cdc2"],
Cell[162742, 4344, 8872, 248, 288, "Output",ExpressionUUID->"f21cee41-a837-4591-8c01-ebfe18a8d3f2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[171651, 4597, 1254, 36, 79, InheritFromParent,ExpressionUUID->"492bee70-5114-4a53-b89a-a170faff1cc3"],
Cell[172908, 4635, 1215, 36, 71, "Output",ExpressionUUID->"d9cc8363-2d81-4e4d-b99e-88e8972455a9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[174160, 4676, 1286, 34, 73, InheritFromParent,ExpressionUUID->"9628363d-0953-4175-ab22-f4fc6fc33bbb"],
Cell[175449, 4712, 17115, 451, 482, "Output",ExpressionUUID->"a0e9bfc5-3135-49a6-a4ba-15dd5594e246"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[192613, 5169, 171, 3, 67, "Section",ExpressionUUID->"da0baece-ce1d-4be2-bfc0-532fe3422f07"],
Cell[CellGroupData[{
Cell[192809, 5176, 4564, 119, 346, "Input",ExpressionUUID->"74c01240-e321-4611-bdf7-5ddde4ca801c"],
Cell[197376, 5297, 16930, 441, 497, "Output",ExpressionUUID->"de4c9fec-9510-4b10-a191-be14f481996a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[214343, 5743, 1439, 34, 73, "Input",ExpressionUUID->"e171f9eb-6db3-47e6-8754-c7c474a89f46"],
Cell[215785, 5779, 291, 6, 48, "Output",ExpressionUUID->"6d6a3d81-02c1-4d77-a91a-05ab7c446dcc"]
}, Open  ]],
Cell[216091, 5788, 319, 6, 52, "Input",ExpressionUUID->"62003d93-2616-458f-8116-014764e321da"],
Cell[216413, 5796, 817, 13, 127, "Text",ExpressionUUID->"9104de84-62e8-4860-8a12-49c2c01c78be"]
}, Open  ]],
Cell[CellGroupData[{
Cell[217267, 5814, 640, 9, 67, "Section",ExpressionUUID->"0d59ae0e-75b4-475f-be58-0055d3427f68"],
Cell[217910, 5825, 268, 6, 35, "Text",ExpressionUUID->"beb639e8-ef69-484c-8105-39903374d2cc"],
Cell[CellGroupData[{
Cell[218203, 5835, 1154, 31, 52, "Input",ExpressionUUID->"ca3210d9-9235-4b75-82e1-522edc8ebd3f"],
Cell[219360, 5868, 759, 15, 28, "Message",ExpressionUUID->"c8f26110-61c1-46e0-b132-4d92d2efff76"],
Cell[220122, 5885, 4364, 116, 199, "Output",ExpressionUUID->"e6c4af49-a918-437d-b060-33cc267d3913"]
}, Open  ]],
Cell[CellGroupData[{
Cell[224523, 6006, 2091, 41, 52, "Input",ExpressionUUID->"ffac39f8-af49-43a5-88bf-fde620caa63c"],
Cell[226617, 6049, 804, 15, 28, "Message",ExpressionUUID->"5fc63437-931f-4445-92c6-db8ce4dc7613"],
Cell[227424, 6066, 754, 14, 28, "Message",ExpressionUUID->"de293771-f25a-4830-9012-d89f6d67e909"],
Cell[228181, 6082, 5752, 143, 234, "Output",ExpressionUUID->"b06ed8db-0d85-433c-8cfd-fe9f46e59c41"]
}, Open  ]],
Cell[CellGroupData[{
Cell[233970, 6230, 943, 27, 33, "Input",ExpressionUUID->"48cbda8f-5c3f-4350-a8c6-87022269fdc2"],
Cell[234916, 6259, 795, 15, 28, "Message",ExpressionUUID->"829b306c-62d5-4b44-ae99-479ed94fe6d6"],
Cell[235714, 6276, 1306, 34, 37, "Output",ExpressionUUID->"b6ea6ca4-4892-4b65-94d7-4e4aef3711cf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[237057, 6315, 1002, 29, 33, "Input",ExpressionUUID->"3600d42f-a03f-412a-a48a-4449efef0515"],
Cell[238062, 6346, 1376, 35, 51, "Output",ExpressionUUID->"c15041af-8498-4d40-8478-c01e5565acde"]
}, Open  ]],
Cell[CellGroupData[{
Cell[239475, 6386, 1569, 39, 52, "Input",ExpressionUUID->"8658832d-206f-4a44-90c6-0952a12bcaac"],
Cell[241047, 6427, 713, 11, 48, "Output",ExpressionUUID->"e3e1bb06-0ed1-427b-89aa-1fc0df921070"]
}, Open  ]],
Cell[CellGroupData[{
Cell[241797, 6443, 1581, 47, 56, "Input",ExpressionUUID->"0c60b59b-6e24-4c62-a466-21987d49c29a"],
Cell[243381, 6492, 2015, 54, 74, "Output",ExpressionUUID->"7172edb7-ba6e-461f-afb3-bb6af13e7d4a"]
}, Open  ]],
Cell[245411, 6549, 203, 4, 60, "Input",ExpressionUUID->"72991f45-0e2b-4b91-9871-27fe23ce9f49"]
}, Open  ]]
}, Open  ]]
}
]
*)

