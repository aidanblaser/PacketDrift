(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     97962,       2614]
NotebookOptionsPosition[     89447,       2472]
NotebookOutlinePosition[     89839,       2488]
CellTagsIndexPosition[     89796,       2485]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Stokes Waves in Eulerian Coordinates", "Title",
 CellChangeTimes->{{3.8726167911979227`*^9, 
  3.872616813652995*^9}},ExpressionUUID->"b00a80b6-6bb9-45e9-b949-\
0996d304dd9f"],

Cell["\<\
Written by: Aidan Blaser (ablaser@ucsd.edu)
Last Edited: 09/19/2022\
\>", "Subtitle",
 CellChangeTimes->{{3.872616827956628*^9, 
  3.872616848669795*^9}},ExpressionUUID->"171d7166-04ce-4e9b-8e0e-\
f9bc540ed745"],

Cell[BoxData[
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.872616862260195*^9, 3.872616863764624*^9}, {
  3.872680770659586*^9, 3.8726807756920443`*^9}},
 CellLabel->
  "In[1846]:=",ExpressionUUID->"492a0b1f-8802-4cde-8d5f-2482156ea0af"],

Cell[CellGroupData[{

Cell["Equations of Motion", "Section",
 CellChangeTimes->{{3.872616874586975*^9, 
  3.872616878686367*^9}},ExpressionUUID->"cb9d3b79-5f20-4de2-bc64-\
6f2a6441573d"],

Cell[TextData[{
 "We first begin with irrotational, incompressible, inviscid Navier-Stokes in \
2D\n\nx: ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[<|"boxes" -> FormBox[
        RowBox[{
          FractionBox[
           RowBox[{
             StyleBox["D", "TI"], 
             StyleBox["u", "TI"]}], 
           RowBox[{
             StyleBox["D", "TI"], 
             StyleBox["t", "TI"]}]], "\[LongEqual]", "-", 
          FractionBox[
           SubscriptBox[
            StyleBox["p", "TI"], 
            StyleBox["x", "TI"]], "\[Rho]"]}], TraditionalForm], 
      "errors" -> {}, "input" -> "\\frac{Du}{Dt} = -\\frac{p_x}{\\rho}", 
      "state" -> "Boxes"|>,
     "TeXAssistantTemplate"], " "}], TraditionalForm]],ExpressionUUID->
  "afd55268-aa9a-4c12-bf73-9f1c3ddcd742"],
 "\nz: ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         FractionBox[
          RowBox[{
            StyleBox["D", "TI"], 
            StyleBox["w", "TI"]}], 
          RowBox[{
            StyleBox["D", "TI"], 
            StyleBox["t", "TI"]}]], "\[LongEqual]", "-", 
         FractionBox[
          SubscriptBox[
           StyleBox["p", "TI"], 
           StyleBox["z", "TI"]], "\[Rho]"], "-", 
         StyleBox["g", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\frac{Dw}{Dt} = -\\frac{p_z}{\\rho} - g", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "35c67917-207f-40e0-bf9f-dd214f994afc"],
 "\nsince irrotational, we can write a velocity potential ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Phi]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\phi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "3f988e22-245b-463c-8501-dca83a4f4d92"],
 " s.t. ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["u", FontSlant -> "Bold"], "\[LongEqual]", "\[Del]", 
         "\[Phi]"}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\mathbf{u} = \\nabla \\phi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "573f60cc-bbf3-4aaf-b782-34b1f9472ee1"],
 "\nsince incompressible, ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SuperscriptBox["\[Del]", "2"], "\[Phi]", "\[LongEqual]", "0"}], 
       TraditionalForm], "errors" -> {}, "input" -> "\\nabla^2 \\phi = 0", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "8ddd322f-dc38-4f49-b919-40abdb9bc552"],
 "\n\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["w", "TI"], "\[LongEqual]", 
         FractionBox[
          RowBox[{
            StyleBox["D", "TI"], 
            StyleBox["z", "TI"]}], 
          RowBox[{
            StyleBox["D", "TI"], 
            StyleBox["t", "TI"]}]]}], TraditionalForm], "errors" -> {}, 
     "input" -> "w = \\frac{Dz}{Dt}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "52f1ebd1-3fd4-4586-8304-f648c84c5f07"],
 " so at the surface ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["z", "TI"], "\[LongEqual]", "\[Eta]"}], TraditionalForm], 
     "errors" -> {}, "input" -> "z=\\eta", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "bf967a73-338d-432b-97c9-475809590596"],
 ", ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["w", "TI"], "\[LongEqual]", 
         SubscriptBox["\[Phi]", 
          StyleBox["z", "TI"]], "\[LongEqual]", 
         FractionBox[
          RowBox[{
            StyleBox["D", "TI"], "\[Eta]"}], 
          RowBox[{
            StyleBox["D", "TI"], 
            StyleBox["t", "TI"]}]], "\[LongEqual]", 
         SubscriptBox["\[Eta]", 
          StyleBox["t", "TI"]], "+", 
         SubscriptBox["\[Phi]", 
          StyleBox["x", "TI"]], 
         SubscriptBox["\[Eta]", 
          StyleBox["x", "TI"]]}], TraditionalForm], "errors" -> {}, "input" -> 
     "w = \\phi_z = \\frac{D\\eta}{Dt} = \\eta_t + \\phi_x \\eta_x", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "244f38a6-d743-4b9e-a33e-3bdb5e4388e0"],
 " \n\nFrom Bernoulli\[CloseCurlyQuote]s Law for potential flow: ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         FractionBox[
          RowBox[{"\[PartialD]", "\[Phi]"}], 
          RowBox[{"\[PartialD]", 
            StyleBox["t", "TI"]}]], "+", 
         FractionBox["1", "2"], 
         SuperscriptBox[
          RowBox[{"(", 
            RowBox[{"\[Del]", "\[Phi]"}], ")"}], "2"], "+", 
         FractionBox[
          StyleBox["p", "TI"], "\[Rho]"], "+", 
         StyleBox["g", "TI"], 
         StyleBox["z", "TI"], "\[LongEqual]", 
         StyleBox["f", "TI"], 
         RowBox[{"(", 
           StyleBox["t", "TI"], ")"}]}], TraditionalForm], "errors" -> {}, 
     "input" -> 
     "\\frac{\\partial \\phi}{\\partial t} + \\frac{1}{2} (\\nabla  \\phi)^2 \
+ \\frac{p}{\\rho} + g z = f(t)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "ce12785a-0a84-4b7d-aae3-1833af37dac5"],
 "\nAt the surface, let ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["p", "TI"], "\[LongEqual]", "0"}], TraditionalForm], 
     "errors" -> {}, "input" -> "p=0", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "094cb4f1-5428-45d8-968c-d1406fcade0e"],
 " and also let the Bernoulli constant ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["f", "TI"], 
         RowBox[{"(", 
           StyleBox["t", "TI"], ")"}], "\[LongEqual]", "0"}], 
       TraditionalForm], "errors" -> {}, "input" -> "f(t)=0", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "2b609b64-7265-41a4-804b-cc538e304119"],
 " \n(since velocity comes from gradient, f is arbitrary gauge and does not \
change velocity, so we can ignore it)\n\nTo solve, we expand the potential \
asymptotically about a state of rest (",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[Phi]", "\[LongEqual]", "0"}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\phi=0", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "17eab96b-a71d-4beb-a4b5-9cc86cc99a2b"],
 ")\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[Phi]", "\[LongEqual]", "0", "+", 
         SubscriptBox["\[Epsilon]\[Phi]", "1"], 
         RowBox[{"(", 
           RowBox[{
             StyleBox["x", "TI"], ",", 
             StyleBox["z", "TI"], ",", 
             StyleBox["t", "TI"]}], ")"}], "+", 
         SuperscriptBox["\[Epsilon]", "2"], 
         SubscriptBox["\[Phi]", "2"], 
         RowBox[{"(", 
           RowBox[{
             StyleBox["x", "TI"], ",", 
             StyleBox["z", "TI"], ",", 
             StyleBox["t", "TI"]}], ")"}], "+", "..."}], TraditionalForm], 
     "errors" -> {}, "input" -> 
     "\\phi = 0 + \\epsilon \\phi_1(x,z,t) + \\epsilon^2 \\phi_2(x,z,t) + \
...", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "d026eb29-9c18-48a8-bfd0-f900373c3c99"],
 "\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[Eta]", "\[LongEqual]", "0", "+", 
         SubscriptBox["\[Epsilon]\[Eta]", "1"], 
         RowBox[{"(", 
           RowBox[{
             StyleBox["x", "TI"], ",", 
             StyleBox["z", "TI"], ",", 
             StyleBox["t", "TI"]}], ")"}], "+", 
         SuperscriptBox["\[Epsilon]", "2"], 
         SubscriptBox["\[Eta]", "2"], 
         RowBox[{"(", 
           RowBox[{
             StyleBox["x", "TI"], ",", 
             StyleBox["z", "TI"], ",", 
             StyleBox["t", "TI"]}], ")"}], "+", "..."}], TraditionalForm], 
     "errors" -> {}, "input" -> 
     "\\eta = 0 + \\epsilon \\eta_1(x,z,t) + \\epsilon^2 \\eta_2(x,z,t) + \
...", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "5d91c1bf-23e1-4099-8c7a-e24421c83639"],
 "\n\nSo our boundary conditions are (at order \[Epsilon])\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox["\[Eta]", 
          StyleBox["t", "TI"]], "\[LongEqual]", 
         StyleBox["w", "TI"], "\[LongEqual]", 
         SubscriptBox["\[Phi]", 
          StyleBox["z", "TI"]], "  ", "@", 
         StyleBox["z", "TI"], "\[LongEqual]", "\[Eta]"}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\eta_t = w = \\phi_z \\quad @z=\\eta", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "2a6e03d2-353c-4d18-b52c-febbc5ec1b3e"],
 " (velocity at surface is height changing)\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox["\[Phi]", 
          StyleBox["z", "TI"]], "\[Rule]", "0  ", "as", " ", 
         StyleBox["z", "TI"], "\[Rule]", "-", "\[Infinity]"}], 
       TraditionalForm], "errors" -> {}, "input" -> 
     "\\phi_z \\rightarrow 0 \\quad \\text{as} \\, z \\rightarrow -\\infty", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "13307335-7c6d-4e15-b1ee-15e820b2d928"],
 "\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox["\[Phi]", 
          StyleBox["t", "TI"]], "+", 
         StyleBox["g", "TI"], "\[Eta]", "\[LongEqual]", "0  ", "@", 
         StyleBox["z", "TI"], "\[LongEqual]", "\[Eta]"}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\phi_t  + g\\eta = 0 \\quad @ z=\\eta", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "20e5a489-c48b-4149-8096-b9fdb374b2df"],
 " (from Bernoulli, velocity small since small slope expansion)\n\nAnother \
Issue that will arise is that we evaluate our B.C. at \[Eta] which changes.\n\
We get around this by remembering that we also expanded \[Eta] so\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[Phi]", 
         RowBox[{"(", 
           RowBox[{
             StyleBox["z", "TI"], "\[LongEqual]", "\[Eta]"}], ")"}], 
         "\[LongEqual]", "\[Phi]", 
         RowBox[{"(", "0", ")"}], "+", 
         SubscriptBox["\[Phi]", 
          StyleBox["z", "TI"]], 
         RowBox[{"(", "0", ")"}], 
         RowBox[{"(", 
           RowBox[{
             SubscriptBox["\[Epsilon]\[Eta]", "1"], "+", 
             SuperscriptBox["\[Epsilon]", "2"], 
             SubscriptBox["\[Eta]", "2"], "+", "..."}], ")"}], "+", "..."}], 
       TraditionalForm], "errors" -> {}, "input" -> 
     "\\phi (z = \\eta) = \\phi(0) + \\phi_z(0) (\\epsilon \\eta_1 + \
\\epsilon^2 \\eta_2 + ...) + ...", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "859064bf-e515-4344-8b34-13f00f478b7d"],
 " via a standard Taylor expansion\n"
}], "Text",
 CellChangeTimes->{{3.8726168897642193`*^9, 3.87261690565034*^9}, {
   3.872617403362317*^9, 3.872617434730317*^9}, {3.872617469553533*^9, 
   3.872617474911139*^9}, {3.8726175057679853`*^9, 3.87261750949504*^9}, {
   3.872617748103174*^9, 3.872617754118582*^9}, 3.8726177940845633`*^9, {
   3.872617853339507*^9, 3.872617855482437*^9}, {3.872618496375654*^9, 
   3.872618548270265*^9}, {3.872618590442992*^9, 3.872618598083027*^9}, {
   3.872618748125887*^9, 3.872618769325946*^9}, {3.872620430910647*^9, 
   3.8726204474623957`*^9}, {3.872620539980077*^9, 3.8726206033773413`*^9}, {
   3.872620772859462*^9, 3.872620837252962*^9}, {3.8726208895683823`*^9, 
   3.872620897151587*^9}, {3.872680109626584*^9, 3.872680152885179*^9}, {
   3.872680281209968*^9, 3.872680315195107*^9}, {3.872687487045652*^9, 
   3.872687522202713*^9}, {3.872687560755286*^9, 3.8726875687177973`*^9}, {
   3.87268761640129*^9, 3.8726876771695757`*^9}, {3.8726877451607637`*^9, 
   3.872687745464056*^9}, {3.872698030133856*^9, 3.872698031901926*^9}, 
   3.872700431277384*^9, {3.872783831752803*^9, 3.872783888054954*^9}, {
   3.8727839734358664`*^9, 
   3.872783980100155*^9}},ExpressionUUID->"6db499c1-8a50-4e78-a4b5-\
b29203035bf3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Boundary Conditions", "Section",
 CellChangeTimes->{{3.872680414335019*^9, 3.872680415255184*^9}, {
  3.872688804329184*^9, 
  3.8726888078496103`*^9}},ExpressionUUID->"9274f81e-b79a-4ee0-9378-\
ac8ed9446c36"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Define", " ", "variables"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"order", " ", "=", " ", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"phi", "[", 
    RowBox[{"x_", ",", "z_", ",", "t_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{"n", "=", "1"}], "order"], 
    RowBox[{
     RowBox[{"\[Epsilon]", "^", "n"}], " ", 
     RowBox[{"\[Phi]", "[", 
      RowBox[{"n", ",", "x", ",", "z", ",", "t"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phi", "=", " ", 
   RowBox[{"phi", "[", 
    RowBox[{"x", ",", "z", ",", "t"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"eta", "[", 
    RowBox[{"x_", ",", "z_", ",", "t_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{"n", "=", "1"}], "order"], 
    RowBox[{
     RowBox[{"\[Epsilon]", "^", "n"}], " ", 
     RowBox[{"\[Eta]", "[", 
      RowBox[{"n", ",", "x", ",", "t"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eta", "=", " ", 
   RowBox[{"eta", "[", 
    RowBox[{"x", ",", "z", ",", "t"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.872680420587098*^9, 3.872680490381316*^9}, {
  3.872680543811681*^9, 3.872680603410541*^9}, {3.87268063464824*^9, 
  3.8726806618238163`*^9}, {3.872680698054575*^9, 3.872680818442637*^9}, {
  3.872681008933825*^9, 3.872681115663733*^9}, {3.8726888225831413`*^9, 
  3.872688840969386*^9}, {3.872701776959146*^9, 3.872701780490205*^9}, {
  3.872701821431881*^9, 3.872701822987059*^9}, {3.872784152759347*^9, 
  3.872784154430393*^9}, {3.872785555393237*^9, 3.872785555569529*^9}, {
  3.873218164565428*^9, 3.873218165095379*^9}},
 CellLabel->
  "In[1847]:=",ExpressionUUID->"d28214ab-a569-432c-a31f-35f9e89de257"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Define", " ", "Taylor", " ", "Expansion"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Taylor", "[", "phi_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"Normal", "[", 
     RowBox[{"Series", "[", 
      RowBox[{"phi", ",", 
       RowBox[{"{", 
        RowBox[{"z", ",", "0", ",", "order"}], "}"}]}], "]"}], "]"}], " ", "/.",
     " ", 
    RowBox[{"z", " ", "->", " ", "eta"}]}]}]}]], "Input",
 CellChangeTimes->{{3.87278415809452*^9, 3.872784173693617*^9}, {
  3.8727848319905443`*^9, 3.872784842136733*^9}, {3.872784890452794*^9, 
  3.872784901437533*^9}, {3.8727849426117477`*^9, 3.872784953427904*^9}, {
  3.8727850118588448`*^9, 3.8727850202407417`*^9}, {3.872785083198824*^9, 
  3.872785087322277*^9}, {3.872785176949741*^9, 3.8727852030511837`*^9}, {
  3.872785249081381*^9, 3.8727852760083838`*^9}},
 CellLabel->
  "In[1853]:=",ExpressionUUID->"5ba5cfe9-4bc8-4cd9-bfb5-ea8e872d2c62"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Define", " ", "Laplacian"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"laplace", " ", "=", " ", 
   RowBox[{"CoefficientList", "[", 
    RowBox[{
     RowBox[{"Laplacian", "[", 
      RowBox[{"phi", ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "z"}], "}"}]}], "]"}], ",", "\[Epsilon]"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.872697914914721*^9, 3.872697948792777*^9}},
 CellLabel->
  "In[1854]:=",ExpressionUUID->"cf63aacc-b963-469f-8e31-f049253fe51c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[Phi]", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "0", ",", "2", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"1", ",", "x", ",", "z", ",", "t"}], "]"}], "+", 
    RowBox[{
     SuperscriptBox["\[Phi]", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "2", ",", "0", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"1", ",", "x", ",", "z", ",", "t"}], "]"}]}], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[Phi]", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "0", ",", "2", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"2", ",", "x", ",", "z", ",", "t"}], "]"}], "+", 
    RowBox[{
     SuperscriptBox["\[Phi]", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "2", ",", "0", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"2", ",", "x", ",", "z", ",", "t"}], "]"}]}], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[Phi]", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "0", ",", "2", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"3", ",", "x", ",", "z", ",", "t"}], "]"}], "+", 
    RowBox[{
     SuperscriptBox["\[Phi]", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "2", ",", "0", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"3", ",", "x", ",", "z", ",", "t"}], "]"}]}]}], "}"}]], "Output",\

 CellChangeTimes->{{3.872697932889616*^9, 3.872697950856391*^9}, 
   3.872701367226235*^9, 3.872701786908018*^9, 3.872701834150105*^9, 
   3.87270285132966*^9, 3.872770722971074*^9, 3.872785561549799*^9, 
   3.8727864070432053`*^9, 3.872786509392206*^9, 3.87278657300193*^9, 
   3.8727866649086018`*^9, 3.873218171518611*^9, 3.873287437594262*^9, 
   3.8732885874830513`*^9, 3.873288712880385*^9, 3.873289065741167*^9, 
   3.873289109316538*^9, 3.8732906557892227`*^9, 3.8732908841373377`*^9, 
   3.873291154035914*^9, 3.8732922859748793`*^9, {3.873307285948243*^9, 
   3.873307293663383*^9}},
 CellLabel->
  "Out[1854]=",ExpressionUUID->"fbb88b27-90a2-4366-9857-48a46685f659"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Kinematic", " ", "BC", " ", "at", " ", "all", " ", "orders"}], 
    " ", "-", " ", 
    RowBox[{
    "Particles", " ", "on", " ", "Surface", " ", "Stay", " ", "on", " ", 
     "Surface"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"kbc", " ", "=", " ", 
    RowBox[{"CoefficientList", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"eta", ",", "t"}], "]"}], " ", "+", " ", 
        RowBox[{
         RowBox[{"Taylor", "[", 
          RowBox[{"D", "[", 
           RowBox[{"phi", ",", "x"}], "]"}], "]"}], 
         RowBox[{"D", "[", 
          RowBox[{"eta", ",", "x"}], "]"}]}], " ", "-", " ", 
        RowBox[{"Taylor", "[", 
         RowBox[{"D", "[", 
          RowBox[{"phi", ",", "z"}], "]"}], "]"}]}], " ", "/.", " ", 
       RowBox[{"z", "->", "0"}]}], ",", "\[Epsilon]"}], "]"}]}], " ", 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.872688851465135*^9, 3.872688957029265*^9}, {
   3.872689203886367*^9, 3.8726892048155823`*^9}, {3.872689263330344*^9, 
   3.872689334504347*^9}, {3.87269292186558*^9, 3.872692927739745*^9}, {
   3.872693006543254*^9, 3.8726930791163588`*^9}, {3.872693134787072*^9, 
   3.872693136435277*^9}, 3.8726931742900143`*^9, {3.872784145979796*^9, 
   3.872784146710601*^9}, {3.872784813271494*^9, 3.872784885903113*^9}, {
   3.8727852834081287`*^9, 3.87278529165593*^9}, {3.8727853277755003`*^9, 
   3.8727853660140038`*^9}, {3.872786482035153*^9, 3.872786484512539*^9}, 
   3.872786530862131*^9, {3.872786623386347*^9, 3.872786656978847*^9}},
 CellLabel->
  "In[1855]:=",ExpressionUUID->"8807aa22-4d2e-4014-a94f-30409f739391"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Ex", ".", " ", "KBC"}], " ", "at", " ", "order", " ", 
    RowBox[{"\[Epsilon]", "^", "2"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"kbc", "[", 
    RowBox[{"[", "3", "]"}], "]"}], " ", "==", " ", "0", " "}]}]], "Input",
 CellChangeTimes->{{3.87269294812772*^9, 3.872692992199749*^9}, {
  3.872693061838728*^9, 3.872693106163747*^9}, {3.8726931449063473`*^9, 
  3.872693166889838*^9}, {3.8727853114711113`*^9, 3.8727853464855433`*^9}, {
  3.872785376982472*^9, 3.872785391860241*^9}, {3.872786583854434*^9, 
  3.872786584596858*^9}, {3.872786671299727*^9, 3.872786675449852*^9}, {
  3.872788380915379*^9, 3.872788397849161*^9}, {3.873216676001627*^9, 
  3.873216692178653*^9}},
 CellLabel->
  "In[1856]:=",ExpressionUUID->"e631a0b0-cb2a-4fb1-a5aa-c78fbcbf322f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    SuperscriptBox["\[Eta]", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "0", ",", "1"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"2", ",", "x", ",", "t"}], "]"}], "-", 
   RowBox[{
    SuperscriptBox["\[Phi]", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"2", ",", "x", ",", "0", ",", "t"}], "]"}], "-", 
   RowBox[{
    RowBox[{"\[Eta]", "[", 
     RowBox[{"1", ",", "x", ",", "t"}], "]"}], " ", 
    RowBox[{
     SuperscriptBox["\[Phi]", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "0", ",", "2", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"1", ",", "x", ",", "0", ",", "t"}], "]"}]}], "+", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[Eta]", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "1", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"1", ",", "x", ",", "t"}], "]"}], " ", 
    RowBox[{
     SuperscriptBox["\[Phi]", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"1", ",", "x", ",", "0", ",", "t"}], "]"}]}]}], "\[Equal]", 
  "0"}]], "Output",
 CellChangeTimes->{
  3.872786634769825*^9, {3.872786668212693*^9, 3.87278667634015*^9}, {
   3.8727883813514023`*^9, 3.872788398441391*^9}, {3.873216683036249*^9, 
   3.8732166895225487`*^9}, 3.8732906558884478`*^9, 3.873290884240068*^9, 
   3.873291154113896*^9, 3.87329228606092*^9, {3.873307286000469*^9, 
   3.873307293713792*^9}},
 CellLabel->
  "Out[1856]=",ExpressionUUID->"5f6e804e-49d4-4f9a-85b9-fd3e79b2235c"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8727866100599318`*^9, 3.87278661208454*^9}, 
   3.872786701315563*^9, {3.873198165380142*^9, 3.873198201950828*^9}},
 CellLabel->
  "In[1857]:=",ExpressionUUID->"28ff057a-a164-4bc4-8b5d-5bd4380047f1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Dynamic", " ", "BC", " ", "at", " ", "all", " ", "orders"}], " ",
     "-", " ", "Bernoulli"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"dbc", " ", "=", " ", 
    RowBox[{"CoefficientList", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Taylor", "[", 
         RowBox[{"D", "[", 
          RowBox[{"phi", ",", "t"}], "]"}], "]"}], " ", "+", " ", 
        RowBox[{"0.5", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Taylor", "[", 
             RowBox[{"D", "[", 
              RowBox[{"phi", ",", "x"}], "]"}], "]"}], "^", "2"}], " ", "+", 
           " ", 
           RowBox[{
            RowBox[{"Taylor", "[", 
             RowBox[{"D", "[", 
              RowBox[{"phi", ",", "z"}], "]"}], "]"}], "^", "2"}]}], ")"}]}], 
        " ", "+", " ", 
        RowBox[{"g", "*", "eta"}]}], " ", "/.", " ", 
       RowBox[{"z", "->", " ", "0"}]}], ",", "\[Epsilon]"}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.872689037977941*^9, 3.872689052051692*^9}, {
  3.8726931398105583`*^9, 3.87269314112287*^9}, {3.872693208832328*^9, 
  3.872693280991514*^9}, {3.87278540391761*^9, 3.8727854296518106`*^9}, {
  3.872786706733953*^9, 3.872786765687708*^9}},
 CellLabel->
  "In[1858]:=",ExpressionUUID->"abaa8b3b-256f-4398-abaa-3194e8aa4a48"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Ex", ".", " ", "DBC"}], " ", "at", " ", "order", " ", 
    RowBox[{"\[Epsilon]", "^", "2"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"dbc", "[", 
     RowBox[{"[", "3", "]"}], "]"}], " ", "==", " ", "0"}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.872693289422493*^9, 3.872693312541183*^9}, {
  3.8727883879792128`*^9, 3.872788401425115*^9}, {3.872788457454895*^9, 
  3.872788471738634*^9}, {3.873216694101863*^9, 3.873216710001731*^9}, {
  3.873216782452545*^9, 3.873216785170919*^9}},
 CellLabel->
  "In[1859]:=",ExpressionUUID->"f571322c-de27-41cc-8a37-f8a06f98dc94"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"g", " ", 
    RowBox[{"\[Eta]", "[", 
     RowBox[{"2", ",", "x", ",", "t"}], "]"}]}], "+", 
   RowBox[{
    SuperscriptBox["\[Phi]", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "0", ",", "0", ",", "1"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"2", ",", "x", ",", "0", ",", "t"}], "]"}], "+", 
   RowBox[{"0.5`", " ", 
    SuperscriptBox[
     RowBox[{
      SuperscriptBox["\[Phi]", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"1", ",", "x", ",", "0", ",", "t"}], "]"}], "2"]}], "+", 
   RowBox[{
    RowBox[{"\[Eta]", "[", 
     RowBox[{"1", ",", "x", ",", "t"}], "]"}], " ", 
    RowBox[{
     SuperscriptBox["\[Phi]", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "0", ",", "1", ",", "1"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"1", ",", "x", ",", "0", ",", "t"}], "]"}]}], "+", 
   RowBox[{"0.5`", " ", 
    SuperscriptBox[
     RowBox[{
      SuperscriptBox["\[Phi]", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"1", ",", "x", ",", "0", ",", "t"}], "]"}], "2"]}]}], 
  "\[Equal]", "0"}]], "Output",
 CellChangeTimes->{
  3.8732179591936073`*^9, 3.873290656004251*^9, 3.873290884340975*^9, 
   3.87329115420048*^9, 3.8732922861629467`*^9, {3.8733072861076307`*^9, 
   3.873307293789461*^9}},
 CellLabel->
  "Out[1859]=",ExpressionUUID->"d30e0e73-d71e-4880-a78e-4d9c2693810a"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.873217965929145*^9, 3.873217981419924*^9}, {
  3.873218137854621*^9, 3.873218155838015*^9}},
 CellLabel->
  "In[1860]:=",ExpressionUUID->"300d3410-9514-45e5-a308-c44fbd42b001"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Finding First Solution", "Section",
 CellChangeTimes->{{3.873217989387823*^9, 3.873218045718646*^9}, {
  3.873218138914061*^9, 3.873218159799596*^9}, {3.873286394320117*^9, 
  3.8732863997080927`*^9}},ExpressionUUID->"c33935e2-bfb4-49c5-92c1-\
568e82b64ca6"],

Cell[TextData[{
 "To find our first solution, we recognize that our decay to -\[Infinity] \
boundary conditions pretty much tell us our solutions will be of the form\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[Phi]", "\[LongEqual]", 
         StyleBox["A", "TI"], "sin", 
         RowBox[{"(", 
           RowBox[{
             StyleBox["k", "TI"], 
             StyleBox["x", "TI"], "+", 
             StyleBox["b", "TI"], 
             RowBox[{"(", 
               StyleBox["t", "TI"], ")"}]}], ")"}], 
         SuperscriptBox[
          StyleBox["e", "TI"], 
          RowBox[{
            StyleBox["k", "TI"], 
            StyleBox["z", "TI"]}]]}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\phi = A \\sin(kx + b(t)) e^{k z}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "2710abcf-030e-469b-8f38-350fff64fd3d"],
 " for constants A,b. We know that we will have an \[Omega] t term also.\
\[LineSeparator]\nThe trick though is that we don\[CloseCurlyQuote]t want to \
guess the solution for \[Eta]. We can combine our BC at first order to \
eliminate \[Eta]"
}], "Text",
 CellChangeTimes->{{3.8732864054424562`*^9, 3.873286446894617*^9}, {
  3.8732864920482397`*^9, 3.873286606869063*^9}, {3.873289114828835*^9, 
  3.873289117712195*^9}, {3.8732901701412373`*^9, 
  3.873290170213377*^9}},ExpressionUUID->"e9b48876-698c-418c-98ac-\
ffc875955536"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"bc1", " ", "=", " ", 
  RowBox[{"Eliminate", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"dbc", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "t"}], "]"}], "==", "0"}], ",", 
      RowBox[{
       RowBox[{"kbc", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "==", "0"}]}], "}"}], ",", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"\[Eta]", "[", 
       RowBox[{"1", ",", "x", ",", "t"}], "]"}], ",", "t"}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.873286574870007*^9, 3.873286574877419*^9}, {
   3.873287425105015*^9, 3.873287428473373*^9}, 3.8732874836451273`*^9},
 CellLabel->
  "In[1861]:=",ExpressionUUID->"81e5b6cc-555c-407d-95e5-43d479fd6595"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "g"}], " ", 
   RowBox[{
    SuperscriptBox["\[Phi]", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"1", ",", "x", ",", "0", ",", "t"}], "]"}]}], "\[Equal]", 
  RowBox[{
   SuperscriptBox["\[Phi]", 
    TagBox[
     RowBox[{"(", 
      RowBox[{"0", ",", "0", ",", "0", ",", "2"}], ")"}],
     Derivative],
    MultilineFunction->None], "[", 
   RowBox[{"1", ",", "x", ",", "0", ",", "t"}], "]"}]}]], "Output",
 CellChangeTimes->{{3.872688958257125*^9, 3.872688971669195*^9}, 
   3.872693277080749*^9, 3.872693313057736*^9, 3.8726936661835318`*^9, 
   3.872785436944097*^9, 3.8727855790537148`*^9, 3.87278677288909*^9, 
   3.872788388352805*^9, 3.872788458663096*^9, 3.8732166982043133`*^9, {
   3.873216775816297*^9, 3.8732167856576853`*^9}, {3.873287429150056*^9, 
   3.8732874433954897`*^9}, 3.8732874870928288`*^9, {3.873287894515472*^9, 
   3.8732879015051613`*^9}, 3.87328859674608*^9, 3.8732887181658154`*^9, 
   3.873289072628591*^9, 3.873289119497369*^9, 3.8732906560831337`*^9, 
   3.8732908844152393`*^9, 3.8732911542774897`*^9, 3.873292286244508*^9, {
   3.873307286180045*^9, 3.873307293840149*^9}},
 CellLabel->
  "Out[1861]=",ExpressionUUID->"fab3d729-b2d9-4985-ab83-aef2d664ad9d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]", "[", 
    RowBox[{"1", ",", "x", ",", "z", ",", "t"}], "]"}], " ", "=", " ", 
   RowBox[{"A", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{
      RowBox[{"k", " ", "x"}], " ", "-", " ", 
      RowBox[{"\[Omega]", " ", "t"}]}], "]"}], 
    RowBox[{"Exp", "[", 
     RowBox[{"k", " ", "z"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.873287455582718*^9, 3.873287458992227*^9}, {
  3.8732874964985332`*^9, 3.87328755922113*^9}, {3.873287886730433*^9, 
  3.873287887836314*^9}, {3.873288146483859*^9, 3.8732881496330233`*^9}},
 CellLabel->
  "In[1862]:=",ExpressionUUID->"80023062-7256-40f5-ae9e-af9ea0aeac8d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Recompute", " ", "BC"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"kbc", " ", "=", " ", 
     RowBox[{"CoefficientList", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{"eta", ",", "t"}], "]"}], " ", "+", " ", 
         RowBox[{
          RowBox[{"Taylor", "[", 
           RowBox[{"D", "[", 
            RowBox[{"phi", ",", "x"}], "]"}], "]"}], 
          RowBox[{"D", "[", 
           RowBox[{"eta", ",", "x"}], "]"}]}], " ", "-", " ", 
         RowBox[{"Taylor", "[", 
          RowBox[{"D", "[", 
           RowBox[{"phi", ",", "z"}], "]"}], "]"}]}], " ", "/.", " ", 
        RowBox[{"z", "->", "0"}]}], ",", "\[Epsilon]"}], "]"}]}], " ", ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dbc", " ", "=", " ", 
     RowBox[{"CoefficientList", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Taylor", "[", 
          RowBox[{"D", "[", 
           RowBox[{"phi", ",", "t"}], "]"}], "]"}], " ", "+", " ", 
         RowBox[{"0.5", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Taylor", "[", 
              RowBox[{"D", "[", 
               RowBox[{"phi", ",", "x"}], "]"}], "]"}], "^", "2"}], " ", "+", 
            " ", 
            RowBox[{
             RowBox[{"Taylor", "[", 
              RowBox[{"D", "[", 
               RowBox[{"phi", ",", "z"}], "]"}], "]"}], "^", "2"}]}], ")"}]}],
          " ", "+", " ", 
         RowBox[{"g", "*", "eta"}]}], " ", "/.", " ", 
        RowBox[{"z", "->", " ", "0"}]}], ",", "\[Epsilon]"}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.873287563387429*^9, 3.873287563861031*^9}, {
  3.873287952944936*^9, 3.873287967650855*^9}, {3.8732880043218603`*^9, 
  3.873288016273699*^9}, {3.873288085573702*^9, 3.873288178513015*^9}},
 CellLabel->
  "In[1863]:=",ExpressionUUID->"566dc369-8ab9-41ab-8f9c-3c5d1db95472"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"bc1", " ", "=", " ", 
  RowBox[{"Eliminate", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"dbc", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "t"}], "]"}], "==", "0"}], ",", 
      RowBox[{
       RowBox[{"kbc", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "==", "0"}]}], "}"}], ",", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"\[Eta]", "[", 
       RowBox[{"1", ",", "x", ",", "t"}], "]"}], ",", "t"}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{3.873288091598976*^9},
 CellLabel->
  "In[1865]:=",ExpressionUUID->"ce37bee1-f4dc-4fef-8753-ff09d1e68c21"],

Cell[BoxData[
 RowBox[{
  RowBox[{"A", " ", 
   SuperscriptBox["\[Omega]", "2"], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{
     RowBox[{"k", " ", "x"}], "-", 
     RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "\[Equal]", 
  RowBox[{"A", " ", "g", " ", "k", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{
     RowBox[{"k", " ", "x"}], "-", 
     RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.8732882108604116`*^9, 3.873288603111691*^9, 3.873288723756504*^9, 
   3.873289078683069*^9, 3.87328912466031*^9, 3.873290656313717*^9, 
   3.873290884645763*^9, 3.8732911545014477`*^9, 3.873292286474345*^9, {
   3.87330728638171*^9, 3.873307294042186*^9}},
 CellLabel->
  "Out[1865]=",ExpressionUUID->"33d8abf0-eba0-4a71-bc06-f2cc5dd71b6b"]
}, Open  ]],

Cell[TextData[{
 "From here we see that, to first order, if ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SuperscriptBox["\[Omega]", "2"], "\[LongEqual]", 
         StyleBox["g", "TI"], 
         StyleBox["k", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\omega^2 = g k", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "70dec50a-8daa-4fbf-8600-aefc5de7e33c"],
 ", the equation is satisfied for arbitrary A. So we fixed b(t).\nNext we \
want to use our DBC to solve for \[Eta]"
}], "Text",
 CellChangeTimes->{{3.873288194319007*^9, 3.873288204583302*^9}, {
  3.8732882354873743`*^9, 3.873288238661471*^9}, {3.8732883508304157`*^9, 
  3.873288426311364*^9}, {3.8732884898688*^9, 3.873288496845263*^9}, {
  3.8732901628695383`*^9, 
  3.873290164510159*^9}},ExpressionUUID->"f0f3b849-c736-4075-926a-\
fea16d52ef7a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"eta1", " ", "=", " ", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"dbc", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "==", "0"}], ",", 
    RowBox[{"\[Eta]", "[", 
     RowBox[{"1", ",", "x", ",", "t"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Eta]", "[", 
    RowBox[{"1", ",", "x", ",", "t"}], "]"}], " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Eta]", "[", 
       RowBox[{"1", ",", "x", ",", "t"}], "]"}], " ", "/.", " ", "eta1"}], 
     ")"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]"}], "Input",\

 CellChangeTimes->{{3.873288502628001*^9, 3.873288572607266*^9}, {
   3.8732886331295424`*^9, 3.8732886554323893`*^9}, {3.873288692021409*^9, 
   3.873288693266102*^9}, 3.8732887309300127`*^9, {3.87328897639797*^9, 
   3.8732889786699257`*^9}, {3.8732890975809298`*^9, 3.873289099073709*^9}},
 CellLabel->
  "In[1866]:=",ExpressionUUID->"282d3dcb-3bae-4527-990d-4678b1077e6e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[Eta]", "[", 
     RowBox[{"1", ",", "x", ",", "t"}], "]"}], "\[Rule]", 
    FractionBox[
     RowBox[{"A", " ", "\[Omega]", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"k", " ", "x"}], "-", 
        RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "g"]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.873288731423085*^9, 3.873288984466977*^9, {3.873289025451055*^9, 
   3.873289038889534*^9}, {3.87328908091085*^9, 3.873289126413619*^9}, 
   3.8732906563815327`*^9, 3.87329088470463*^9, 3.873291154565909*^9, 
   3.873292286541299*^9, {3.873307286425873*^9, 3.87330729408327*^9}},
 CellLabel->
  "Out[1866]=",ExpressionUUID->"6a453810-7249-4979-bb23-9aa3459604b0"],

Cell[BoxData[
 TemplateBox[{
  "$RecursionLimit", "reclim2", 
   "\"Recursion depth of \\!\\(\\*RowBox[{\\\"1024\\\"}]\\) exceeded during \
evaluation of \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"\[Eta]\\\", \
\\\"[\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"x\\\", \\\",\\\", \\\"t\\\"}], \
\\\"]\\\"}], \\\"\[Rule]\\\", FractionBox[RowBox[{\\\"A\\\", \\\" \\\", \\\"\
\[Omega]\\\", \\\" \\\", RowBox[{\\\"Cos\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"k\\\", \\\" \\\", \\\"x\\\"}], \\\"-\\\", RowBox[{\\\"t\\\
\", \\\" \\\", \\\"\[Omega]\\\"}]}], \\\"]\\\"}]}], \\\"g\\\"]}], \\\"}\\\"}]\
\\).\"", 2, 1338, 168, 29496185747949257067, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.87328864760608*^9, 
  3.873288665253942*^9}},ExpressionUUID->"0bc749ca-81df-4d24-a782-\
bdd6058f14c7"],

Cell[BoxData[
 RowBox[{"Hold", "[", 
  RowBox[{
   RowBox[{"\[Eta]", "[", 
    RowBox[{"1", ",", "x", ",", "t"}], "]"}], "=", 
   RowBox[{"eta1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
  "]"}]], "Output",
 CellChangeTimes->{
  3.873288124291361*^9, 3.873288160571287*^9, 3.8732882054023323`*^9, 
   3.873288239188439*^9, 3.873288517323443*^9, {3.873288563440302*^9, 
   3.873288574575507*^9}, 3.873288606032444*^9, {3.873288647628718*^9, 
   3.873288656078002*^9}},
 CellLabel->
  "Out[1338]=",ExpressionUUID->"b4794b4d-b7cf-457d-b7cf-b7da0ea4e63a"]
}, Open  ]],

Cell[TextData[{
 "At this point we have to make a choice on what our constant A is, as it is \
free since at this order, our system is linear.\nWhile not explicitly written \
here, I chose ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[Epsilon]", "\[LongEqual]", 
         StyleBox["a", "TI"], 
         StyleBox["k", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\epsilon = ak", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "f181a344-553e-4687-b404-e7021908c896"],
 ", where a is the amplitude (length scale) of the wave.\n\nI know that I \
want the amplitude of \[Eta] to be the amplitude of the wave, since that\
\[CloseCurlyQuote]s how it\[CloseCurlyQuote]s defined, so we can constrain \
A."
}], "Text",
 CellChangeTimes->{{3.873288612984063*^9, 3.8732886166893873`*^9}, {
  3.873288670488246*^9, 3.87328868469446*^9}, {3.873288739101612*^9, 
  3.873288745397089*^9}, {3.873288809179596*^9, 3.873288819858453*^9}, {
  3.873288891121681*^9, 3.873288982152445*^9}, {3.8732890166039953`*^9, 
  3.8732890598173447`*^9}, {3.873289189190447*^9, 3.873289209054446*^9}, {
  3.873289708913876*^9, 3.873289725948861*^9}, {3.873289959772946*^9, 
  3.873290032802484*^9}, {3.873290085424821*^9, 
  3.87329020888463*^9}},ExpressionUUID->"7d3ad541-0dc3-494d-a7c8-\
19da8886e329"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"solveA", " ", "=", " ", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"a", "==", 
      RowBox[{
       RowBox[{"CoefficientList", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Eta]", "[", 
           RowBox[{"1", ",", "x", ",", "t"}], "]"}], "*", " ", "a", "*", 
          "k"}], ",", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"k", " ", "x"}], " ", "-", " ", 
           RowBox[{"\[Omega]", " ", "t"}]}], "]"}]}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ",", "A"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Eta]", "[", 
    RowBox[{"1", ",", "x", ",", "t"}], "]"}], " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Eta]", "[", 
       RowBox[{"1", ",", "x", ",", "t"}], "]"}], " ", "/.", " ", "solveA"}], 
     ")"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Phi]", "[", 
     RowBox[{"1", ",", "x", ",", "z", ",", "t"}], "]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"1", ",", "x", ",", "z", ",", "t"}], "]"}], " ", "/.", " ", 
       "solveA"}], ")"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Print", " ", "results", " ", "so", " ", "far"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", "phi", "\[IndentingNewLine]", 
 RowBox[{"eta", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8732902358060226`*^9, 3.873290599176958*^9}, {
  3.873290633279603*^9, 3.8732906710618467`*^9}, {3.873290740156164*^9, 
  3.873290742267352*^9}, {3.873290830049067*^9, 3.8732908920224247`*^9}, {
  3.8732909270582867`*^9, 3.873291149652454*^9}, {3.873291261993147*^9, 
  3.873291272018808*^9}},
 CellLabel->
  "In[1868]:=",ExpressionUUID->"de2de41c-b57f-490c-967a-718f76d99e95"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"k", " ", "z"}]], " ", "g", " ", "\[Epsilon]", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{
      RowBox[{"k", " ", "x"}], "-", 
      RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], 
   RowBox[{"k", " ", "\[Omega]"}]], "+", 
  RowBox[{
   SuperscriptBox["\[Epsilon]", "2"], " ", 
   RowBox[{"\[Phi]", "[", 
    RowBox[{"2", ",", "x", ",", "z", ",", "t"}], "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["\[Epsilon]", "3"], " ", 
   RowBox[{"\[Phi]", "[", 
    RowBox[{"3", ",", "x", ",", "z", ",", "t"}], "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.8732908924115677`*^9, {3.873290934495368*^9, 3.873290951207828*^9}, {
   3.873290985039119*^9, 3.873291010434074*^9}, 3.873291040906128*^9, {
   3.873291094064101*^9, 3.87329110578153*^9}, 3.873291154604279*^9, 
   3.8732922865882263`*^9, {3.873307286461581*^9, 3.873307294141242*^9}},
 CellLabel->
  "Out[1871]=",ExpressionUUID->"e40cb349-7268-4cd7-a51f-fb4d98022795"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"\[Epsilon]", " ", 
    RowBox[{"Cos", "[", 
     RowBox[{
      RowBox[{"k", " ", "x"}], "-", 
      RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "k"], "+", 
  RowBox[{
   SuperscriptBox["\[Epsilon]", "2"], " ", 
   RowBox[{"\[Eta]", "[", 
    RowBox[{"2", ",", "x", ",", "t"}], "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["\[Epsilon]", "3"], " ", 
   RowBox[{"\[Eta]", "[", 
    RowBox[{"3", ",", "x", ",", "t"}], "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.8732908924115677`*^9, {3.873290934495368*^9, 3.873290951207828*^9}, {
   3.873290985039119*^9, 3.873291010434074*^9}, 3.873291040906128*^9, {
   3.873291094064101*^9, 3.87329110578153*^9}, 3.873291154604279*^9, 
   3.8732922865882263`*^9, {3.873307286461581*^9, 3.873307294160041*^9}},
 CellLabel->
  "Out[1872]=",ExpressionUUID->"f08c7a53-2503-4962-be69-45395da869a7"]
}, Open  ]],

Cell["", "Text",ExpressionUUID->"4d1e3475-2976-473b-8df6-30ef539a8d9e"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"\[Epsilon]", " ", 
    RowBox[{"Cos", "[", 
     RowBox[{
      RowBox[{"k", " ", "x"}], "-", 
      RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "k"], "+", 
  RowBox[{
   SuperscriptBox["\[Epsilon]", "2"], " ", 
   RowBox[{"\[Eta]", "[", 
    RowBox[{"2", ",", "x", ",", "t"}], "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["\[Epsilon]", "3"], " ", 
   RowBox[{"\[Eta]", "[", 
    RowBox[{"3", ",", "x", ",", "t"}], "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.8732908924115677`*^9, {3.873290934495368*^9, 3.873290951207828*^9}, {
   3.873290985039119*^9, 3.873291010434074*^9}, 3.873291040906128*^9, {
   3.873291094064101*^9, 3.87329110578153*^9}, 3.873291154604279*^9, 
   3.87329228660896*^9},
 CellLabel->
  "Out[1676]=",ExpressionUUID->"7aed649f-08c5-44b0-a640-c83afa618a8a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Knowing First Solution, Next BC", "Section",
 CellChangeTimes->{{3.872693617220345*^9, 3.8726936182989283`*^9}, {
  3.873197117713191*^9, 3.873197134126687*^9}, {3.8732863821721287`*^9, 
  3.873286383468438*^9}},ExpressionUUID->"7482126b-1ebb-48d4-a4e9-\
e393e6739f5d"],

Cell[TextData[{
 "We just calculated the first order solutions to be\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox["\[Eta]", "1"], "\[LongEqual]", 
         FractionBox["\[Epsilon]", 
          StyleBox["k", "TI"]], "cos", 
         RowBox[{"(", 
           SubscriptBox["\[Theta]", "0"], ")"}]}], TraditionalForm], 
     "errors" -> {}, "input" -> 
     "\\eta_1 = \\frac{\\epsilon}{k} \\cos(\\theta_0)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "0c90382d-1e70-4a93-8a92-98e6a9d44610"],
 ", ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox["\[Phi]", "1"], "\[LongEqual]", 
         FractionBox[
          SubscriptBox["\[Epsilon]\[Omega]", "0"], 
          SuperscriptBox[
           StyleBox["k", "TI"], "2"]], 
         SuperscriptBox[
          StyleBox["e", "TI"], 
          RowBox[{
            StyleBox["k", "TI"], 
            StyleBox["z", "TI"]}]], "sin", 
         RowBox[{"(", 
           SubscriptBox["\[Theta]", "0"], ")"}]}], TraditionalForm], 
     "errors" -> {}, "input" -> 
     "\\phi_1 = \\frac{\\epsilon \\omega_0}{k^2} e^{k z} \\sin(\\theta_0)", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "2661c794-482c-46f2-8550-7e56a9d13a8a"],
 " with ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox["\[Theta]", "0"], "\[LongEqual]", 
         StyleBox["k", "TI"], 
         StyleBox["x", "TI"], "-", "\[Omega]", 
         StyleBox["t", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\theta_0 = k x - \\omega t", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "ed309a5d-eea5-4c72-86d9-b93c4dc810b7"],
 "\nSo, knowing this, we can substitute in our BC to 2nd order"
}], "Text",
 CellChangeTimes->{{3.8731971443499613`*^9, 3.8731971868020487`*^9}, {
  3.873197224451056*^9, 3.873197265875926*^9}, {3.8732913273108873`*^9, 
  3.873291331230732*^9}},ExpressionUUID->"26b0bbb3-f100-40c8-a921-\
d8f7616718ba"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.873197271803306*^9, 3.873197342592513*^9}, {
   3.873197497268159*^9, 3.873197500068378*^9}, {3.8731982075663347`*^9, 
   3.873198207627133*^9}, {3.873216492561418*^9, 3.873216492976789*^9}, 
   3.873290870180469*^9},
 CellLabel->
  "In[1873]:=",ExpressionUUID->"8e432576-bdbd-4270-b8c2-989a518a0eae"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.873197353316656*^9, 3.8731974174936457`*^9}, {
   3.87319821070885*^9, 3.8731982124354563`*^9}, {3.873216496495124*^9, 
   3.8732164969845448`*^9}, 3.873290868067608*^9},
 CellLabel->
  "In[1874]:=",ExpressionUUID->"78464b50-4f75-459b-b2ba-794dd084b928"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Recompute", " ", "BC"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"kbc", " ", "=", " ", 
    RowBox[{"CoefficientList", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"eta", ",", "t"}], "]"}], " ", "+", " ", 
        RowBox[{
         RowBox[{"Taylor", "[", 
          RowBox[{"D", "[", 
           RowBox[{"phi", ",", "x"}], "]"}], "]"}], 
         RowBox[{"D", "[", 
          RowBox[{"eta", ",", "x"}], "]"}]}], " ", "-", " ", 
        RowBox[{"Taylor", "[", 
         RowBox[{"D", "[", 
          RowBox[{"phi", ",", "z"}], "]"}], "]"}]}], " ", "/.", " ", 
       RowBox[{"z", "->", "0"}]}], ",", "\[Epsilon]"}], "]"}]}], " ", 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.8731974260662403`*^9, 3.87319742842131*^9}, {
  3.8731975483140993`*^9, 3.8731975680444613`*^9}, {3.873197657568778*^9, 
  3.87319766486976*^9}},
 CellLabel->
  "In[1875]:=",ExpressionUUID->"e2800158-3cd5-4c50-8c9f-120860157783"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"kbc", "[", 
    RowBox[{"[", "3", "]"}], "]"}], " ", "==", " ", "0"}], "]"}]], "Input",
 CellChangeTimes->{{3.8731975711334133`*^9, 3.873197582360099*^9}, {
  3.873197671172983*^9, 3.873197671861027*^9}, {3.8731982255315523`*^9, 
  3.873198244834237*^9}},
 CellLabel->
  "In[1876]:=",ExpressionUUID->"f01e29bf-10de-43b7-af62-538c0c39958a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox[
    RowBox[{"g", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"2", " ", "k", " ", "x"}], "-", 
       RowBox[{"2", " ", "t", " ", "\[Omega]"}]}], "]"}]}], "\[Omega]"], "+", 
   
   RowBox[{
    SuperscriptBox["\[Phi]", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"2", ",", "x", ",", "0", ",", "t"}], "]"}]}], "\[Equal]", 
  RowBox[{
   SuperscriptBox["\[Eta]", 
    TagBox[
     RowBox[{"(", 
      RowBox[{"0", ",", "0", ",", "1"}], ")"}],
     Derivative],
    MultilineFunction->None], "[", 
   RowBox[{"2", ",", "x", ",", "t"}], "]"}]}]], "Output",
 CellChangeTimes->{
  3.873197603503313*^9, 3.8731976358140163`*^9, 3.8731976729521523`*^9, {
   3.873198221487949*^9, 3.8731982453287287`*^9}, 3.873216253042474*^9, 
   3.8732165042358303`*^9, 3.873290656660555*^9, 3.8732908850221167`*^9, 
   3.873291154872089*^9, 3.873292286858767*^9, {3.873307286705958*^9, 
   3.873307294391824*^9}},
 CellLabel->
  "Out[1876]=",ExpressionUUID->"fd2ded5c-0f87-4eaa-b4bb-03c19ba9bf37"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"dbc", " ", "=", " ", 
   RowBox[{"CoefficientList", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Taylor", "[", 
        RowBox[{"D", "[", 
         RowBox[{"phi", ",", "t"}], "]"}], "]"}], " ", "+", " ", 
       RowBox[{"0.5", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Taylor", "[", 
            RowBox[{"D", "[", 
             RowBox[{"phi", ",", "x"}], "]"}], "]"}], "^", "2"}], " ", "+", 
          " ", 
          RowBox[{
           RowBox[{"Taylor", "[", 
            RowBox[{"D", "[", 
             RowBox[{"phi", ",", "z"}], "]"}], "]"}], "^", "2"}]}], ")"}]}], 
       " ", "+", " ", 
       RowBox[{"g", "*", "eta"}]}], " ", "/.", " ", 
      RowBox[{"z", "->", " ", "0"}]}], ",", "\[Epsilon]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"dbc", "[", 
        RowBox[{"[", "3", "]"}], "]"}], " ", "==", " ", "0"}], " ", "/.", " ", 
      RowBox[{"\[Omega]", " ", "->", " ", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"g", " ", "k"}], "]"}]}]}], "]"}], " ", "/.", " ", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{"g", " ", "k"}], "]"}], " ", "->", " ", "\[Omega]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"bc2", " ", "=", 
  RowBox[{
   RowBox[{"Assuming", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"k", " ", "!=", " ", "0"}], " ", "&&", " ", 
      RowBox[{"g", " ", "!=", " ", "0"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"Simplify", "[", 
       RowBox[{
        RowBox[{"Eliminate", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"dbc", "[", 
                RowBox[{"[", "3", "]"}], "]"}], ",", "t"}], "]"}], "==", 
             "0"}], ",", 
            RowBox[{
             RowBox[{"kbc", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "==", "0"}]}], "}"}], ",", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"\[Eta]", "[", 
             RowBox[{"2", ",", "x", ",", "t"}], "]"}], ",", "t"}], "]"}]}], 
         "]"}], " ", "/.", " ", 
        RowBox[{"\[Omega]", " ", "->", " ", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"g", " ", "k"}], "]"}]}]}], "]"}], "}"}]}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.873197620138723*^9, 3.873197627918486*^9}, {
  3.873199725856077*^9, 3.8731997278308277`*^9}, {3.87321489451473*^9, 
  3.873214909454652*^9}, {3.8732152730745277`*^9, 3.873215278160652*^9}, {
  3.873216374874628*^9, 3.873216376961013*^9}, {3.873291354525922*^9, 
  3.873291382284927*^9}, {3.873292250052804*^9, 3.8732922505102453`*^9}, {
  3.873293005654513*^9, 3.873293171513871*^9}, {3.873293841330463*^9, 
  3.8732938778925533`*^9}, {3.873305178760812*^9, 3.873305210519382*^9}, {
  3.873305917365736*^9, 3.87330625031677*^9}, {3.873306280940248*^9, 
  3.8733063388338223`*^9}},
 CellLabel->
  "In[1877]:=",ExpressionUUID->"fdb0cb0d-31d8-416d-91f9-2a1de88543b2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["\[Phi]", 
    TagBox[
     RowBox[{"(", 
      RowBox[{"0", ",", "0", ",", "0", ",", "2"}], ")"}],
     Derivative],
    MultilineFunction->None], "[", 
   RowBox[{"2", ",", "x", ",", "0", ",", "t"}], "]"}], "\[Equal]", 
  RowBox[{
   RowBox[{"-", "1.`"}], " ", "g", " ", 
   RowBox[{
    SuperscriptBox["\[Phi]", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"2", ",", "x", ",", "0", ",", "t"}], "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.87330721876647*^9, {3.873307286860201*^9, 3.8733072945439034`*^9}},
 CellLabel->
  "Out[1879]=",ExpressionUUID->"3c896c38-a023-48a1-81b0-a392f801240f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Solving For Second Solution", "Section",
 CellChangeTimes->{{3.873307208095193*^9, 
  3.873307216475486*^9}},ExpressionUUID->"49ce2238-68a3-4723-898e-\
dbb6fd81056c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["\[Phi]", 
    TagBox[
     RowBox[{"(", 
      RowBox[{"0", ",", "0", ",", "0", ",", "2"}], ")"}],
     Derivative],
    MultilineFunction->None], "[", 
   RowBox[{"2", ",", "x", ",", "0", ",", "t"}], "]"}], "\[Equal]", 
  RowBox[{
   RowBox[{"-", "1.`"}], " ", "g", " ", 
   RowBox[{
    SuperscriptBox["\[Phi]", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"2", ",", "x", ",", "0", ",", "t"}], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.873306288177701*^9, 3.873306295928894*^9}, {
  3.873306332080557*^9, 3.873306339518289*^9}},
 CellLabel->
  "Out[1775]=",ExpressionUUID->"856f20d0-34e1-432f-af91-14bcd53ed645"],

Cell["Once again, we can assume the classic solution for \[Phi]2", "Text",
 CellChangeTimes->{{3.873306512105328*^9, 
  3.873306533418418*^9}},ExpressionUUID->"570a3c73-9078-43e9-bdbf-\
ec78f7814338"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]", "[", 
    RowBox[{"2", ",", "x", ",", "z", ",", "t"}], "]"}], " ", "=", " ", 
   RowBox[{"B", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{
      RowBox[{"k", " ", "x"}], " ", "-", " ", 
      RowBox[{"\[Omega]", " ", "t"}]}], "]"}], " ", 
    RowBox[{"Exp", "[", 
     RowBox[{"k", " ", "z"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kbc", " ", "=", " ", 
   RowBox[{"CoefficientList", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"eta", ",", "t"}], "]"}], " ", "+", " ", 
       RowBox[{
        RowBox[{"Taylor", "[", 
         RowBox[{"D", "[", 
          RowBox[{"phi", ",", "x"}], "]"}], "]"}], 
        RowBox[{"D", "[", 
         RowBox[{"eta", ",", "x"}], "]"}]}], " ", "-", " ", 
       RowBox[{"Taylor", "[", 
        RowBox[{"D", "[", 
         RowBox[{"phi", ",", "z"}], "]"}], "]"}]}], " ", "/.", " ", 
      RowBox[{"z", "->", "0"}]}], ",", "\[Epsilon]"}], "]"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dbc", " ", "=", " ", 
   RowBox[{"CoefficientList", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Taylor", "[", 
        RowBox[{"D", "[", 
         RowBox[{"phi", ",", "t"}], "]"}], "]"}], " ", "+", " ", 
       RowBox[{"0.5", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Taylor", "[", 
            RowBox[{"D", "[", 
             RowBox[{"phi", ",", "x"}], "]"}], "]"}], "^", "2"}], " ", "+", 
          " ", 
          RowBox[{
           RowBox[{"Taylor", "[", 
            RowBox[{"D", "[", 
             RowBox[{"phi", ",", "z"}], "]"}], "]"}], "^", "2"}]}], ")"}]}], 
       " ", "+", " ", 
       RowBox[{"g", "*", "eta"}]}], " ", "/.", " ", 
      RowBox[{"z", "->", " ", "0"}]}], ",", "\[Epsilon]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"bc2", " ", "=", 
  RowBox[{
   RowBox[{"Assuming", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"k", " ", "!=", " ", "0"}], " ", "&&", " ", 
      RowBox[{"g", " ", "!=", " ", "0"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"Simplify", "[", 
       RowBox[{
        RowBox[{"Eliminate", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"dbc", "[", 
                RowBox[{"[", "3", "]"}], "]"}], ",", "t"}], "]"}], "==", 
             "0"}], ",", 
            RowBox[{
             RowBox[{"kbc", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "==", "0"}]}], "}"}], ",", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"\[Eta]", "[", 
             RowBox[{"2", ",", "x", ",", "t"}], "]"}], ",", "t"}], "]"}]}], 
         "]"}], " ", "/.", " ", 
        RowBox[{"\[Omega]", " ", "->", " ", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"g", " ", "k"}], "]"}]}]}], "]"}], "}"}]}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.873306545263898*^9, 3.873306545271605*^9}, {
  3.873306618400363*^9, 3.873306689293696*^9}, {3.873306724793344*^9, 
  3.87330677671513*^9}},
 CellLabel->
  "In[1880]:=",ExpressionUUID->"2aca4a3a-95da-499a-acb2-25f649ce45ef"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.8733067578595533`*^9, 3.873306777366563*^9}, 
   3.873307222711265*^9, {3.8733072870658493`*^9, 3.8733072947451067`*^9}},
 CellLabel->
  "Out[1883]=",ExpressionUUID->"111b97fb-5113-4ec7-aa06-8a8b318e625d"]
}, Open  ]],

Cell[BoxData[""], "Text", "Input",
 CellChangeTimes->{{3.873306503145933*^9, 3.873306504997334*^9}},
 CellLabel->
  "In[1884]:=",ExpressionUUID->"b197d847-52d6-4cb6-9869-54ec49f46bd6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Knowing Second Solution, next BC", "Section",
 CellChangeTimes->{{3.8732181091320677`*^9, 
  3.873218120639409*^9}},ExpressionUUID->"0c61ca42-2ef7-4493-af30-\
cce583d837b2"],

Cell[TextData[{
 "The second solution is relatively straightforward to solve if we realize \
that ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox["\[Phi]", "2"], "\[LongEqual]", "0"}], TraditionalForm],
      "errors" -> {}, "input" -> "\\phi_2 = 0", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "130a3aed-a780-43d3-a2d8-6b2717077ede"],
 " is a solution which makes ,\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox["\[Eta]", "2"], "\[LongEqual]", 
         FractionBox["1", 
          RowBox[{"2", 
            StyleBox["k", "TI"]}]], "cos", 
         RowBox[{"(", 
           RowBox[{"2", 
             SubscriptBox["\[Theta]", "0"]}], ")"}]}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\eta_2 = \\frac{1}{2k} \\cos(2\\theta_0)", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "ea1c7e8d-71e3-499e-8143-671da93806d6"]
}], "Text",
 CellChangeTimes->{
  3.873218135262595*^9, {3.873299076705035*^9, 
   3.8732990785366087`*^9}},ExpressionUUID->"898818ec-2765-4383-a253-\
7301d5937b42"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.873218190315588*^9, 3.873218239046197*^9}, 
   3.873292282094611*^9},
 CellLabel->
  "In[1885]:=",ExpressionUUID->"ee7e8782-3e46-40ab-b203-ed8bf6d7ce23"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Recompute", " ", "BC"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"kbc", " ", "=", " ", 
     RowBox[{"CoefficientList", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{"eta", ",", "t"}], "]"}], " ", "+", " ", 
         RowBox[{
          RowBox[{"Taylor", "[", 
           RowBox[{"D", "[", 
            RowBox[{"phi", ",", "x"}], "]"}], "]"}], 
          RowBox[{"D", "[", 
           RowBox[{"eta", ",", "x"}], "]"}]}], " ", "-", " ", 
         RowBox[{"Taylor", "[", 
          RowBox[{"D", "[", 
           RowBox[{"phi", ",", "z"}], "]"}], "]"}]}], " ", "/.", " ", 
        RowBox[{"z", "->", "0"}]}], ",", "\[Epsilon]"}], "]"}]}], " ", ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Expand", "[", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"kbc", "[", 
       RowBox[{"[", "4", "]"}], "]"}], " ", "==", " ", "0"}], "]"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.873218257943774*^9, 3.8732182890754642`*^9}, {
  3.873218338722736*^9, 3.873218341440793*^9}},
 CellLabel->
  "In[1886]:=",ExpressionUUID->"9a44e161-517f-423b-8e3d-15c972194446"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox[
    RowBox[{"3", " ", "g", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"3", " ", "k", " ", "x"}], "-", 
       RowBox[{"3", " ", "t", " ", "\[Omega]"}]}], "]"}]}], "\[Omega]"], "+", 
   
   RowBox[{"8", " ", "B", " ", "k", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{
      RowBox[{"2", " ", "k", " ", "x"}], "-", 
      RowBox[{"2", " ", "t", " ", "\[Omega]"}]}], "]"}]}], "+", 
   FractionBox[
    RowBox[{"3", " ", "g", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"k", " ", "x"}], "-", 
       RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "\[Omega]"], "+", 
   FractionBox[
    RowBox[{"8", " ", "g", " ", "k", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"k", " ", "x"}], "-", 
       RowBox[{"t", " ", "\[Omega]"}]}], "]"}], " ", 
     RowBox[{"\[Eta]", "[", 
      RowBox[{"2", ",", "x", ",", "t"}], "]"}]}], "\[Omega]"], "-", 
   RowBox[{"8", " ", 
    RowBox[{
     SuperscriptBox["\[Eta]", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "0", ",", "1"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"3", ",", "x", ",", "t"}], "]"}]}], "-", 
   FractionBox[
    RowBox[{"8", " ", "g", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       RowBox[{"k", " ", "x"}], "-", 
       RowBox[{"t", " ", "\[Omega]"}]}], "]"}], " ", 
     RowBox[{
      SuperscriptBox["\[Eta]", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"2", ",", "x", ",", "t"}], "]"}]}], "\[Omega]"], "+", 
   RowBox[{"8", " ", 
    RowBox[{
     SuperscriptBox["\[Phi]", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"3", ",", "x", ",", "0", ",", "t"}], "]"}]}]}], "\[Equal]", 
  "0"}]], "Output",
 CellChangeTimes->{
  3.873218307921412*^9, 3.873218341873591*^9, 3.873290657017578*^9, 
   3.873290886660694*^9, 3.8732911562642097`*^9, 3.873292287911598*^9, {
   3.87330728738132*^9, 3.873307295009392*^9}},
 CellLabel->
  "Out[1887]=",ExpressionUUID->"66804d23-2ad8-4d63-ae1e-8fc80bb3327d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"dbc", " ", "=", " ", 
   RowBox[{"CoefficientList", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Taylor", "[", 
        RowBox[{"D", "[", 
         RowBox[{"phi", ",", "t"}], "]"}], "]"}], " ", "+", " ", 
       RowBox[{"0.5", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Taylor", "[", 
            RowBox[{"D", "[", 
             RowBox[{"phi", ",", "x"}], "]"}], "]"}], "^", "2"}], " ", "+", 
          " ", 
          RowBox[{
           RowBox[{"Taylor", "[", 
            RowBox[{"D", "[", 
             RowBox[{"phi", ",", "z"}], "]"}], "]"}], "^", "2"}]}], ")"}]}], 
       " ", "+", " ", 
       RowBox[{"g", "*", "eta"}]}], " ", "/.", " ", 
      RowBox[{"z", "->", " ", "0"}]}], ",", "\[Epsilon]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"dbc", "[", 
    RowBox[{"[", "4", "]"}], "]"}], " ", "==", " ", "0"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8732182988305817`*^9, 3.873218303682108*^9}},
 CellLabel->
  "In[1888]:=",ExpressionUUID->"44d72002-f6e4-417e-b3cc-794e5758cdc2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox[
    RowBox[{"1.`", " ", "B", " ", "g", " ", "k"}], "\[Omega]"], "-", 
   RowBox[{"0.5`", " ", "B", " ", "\[Omega]"}], "-", 
   FractionBox[
    RowBox[{"0.125`", " ", "g", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       RowBox[{"3", " ", "k", " ", "x"}], "-", 
       RowBox[{"3", " ", "t", " ", "\[Omega]"}]}], "]"}]}], "k"], "-", 
   RowBox[{"0.5`", " ", "B", " ", "\[Omega]", " ", 
    RowBox[{"Cos", "[", 
     RowBox[{
      RowBox[{"2", " ", "k", " ", "x"}], "-", 
      RowBox[{"2", " ", "t", " ", "\[Omega]"}]}], "]"}]}], "-", 
   FractionBox[
    RowBox[{"0.375`", " ", "g", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       RowBox[{"k", " ", "x"}], "-", 
       RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "k"], "+", 
   FractionBox[
    RowBox[{"1.`", " ", 
     SuperscriptBox["g", "2"], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       RowBox[{"k", " ", "x"}], "-", 
       RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], 
    SuperscriptBox["\[Omega]", "2"]], "-", 
   RowBox[{"1.`", " ", "g", " ", 
    RowBox[{"Cos", "[", 
     RowBox[{
      RowBox[{"k", " ", "x"}], "-", 
      RowBox[{"t", " ", "\[Omega]"}]}], "]"}], " ", 
    RowBox[{"\[Eta]", "[", 
     RowBox[{"2", ",", "x", ",", "t"}], "]"}]}], "+", 
   RowBox[{"1.`", " ", "g", " ", 
    RowBox[{"\[Eta]", "[", 
     RowBox[{"3", ",", "x", ",", "t"}], "]"}]}], "+", 
   RowBox[{"1.`", " ", 
    RowBox[{
     SuperscriptBox["\[Phi]", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "0", ",", "0", ",", "1"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"3", ",", "x", ",", "0", ",", "t"}], "]"}]}]}], "\[Equal]", 
  "0"}]], "Output",
 CellChangeTimes->{{3.873218269983889*^9, 3.873218304585101*^9}, 
   3.873290657189972*^9, 3.873290887372602*^9, 3.873291156724688*^9, 
   3.873292288445402*^9, {3.873307287711651*^9, 3.873307295297858*^9}},
 CellLabel->
  "Out[1889]=",ExpressionUUID->"e7628887-c028-4803-b96e-d41275c4357a"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Solve Laplace\[CloseCurlyQuote]s Eq. with BC at each Order", "Section",
 CellChangeTimes->{{3.872680795466733*^9, 3.872680796154861*^9}, {
  3.8726809472377872`*^9, 3.872680953062263*^9}, {3.872681097234797*^9, 
  3.872681098001719*^9}, {3.872681141240919*^9, 3.872681227629107*^9}, {
  3.87268557488763*^9, 3.872685584326208*^9}, {3.87268594778747*^9, 
  3.8726859677139473`*^9}, {3.872686283962945*^9, 3.8726862846396914`*^9}, {
  3.87269361041891*^9, 3.872693629962452*^9}, {3.872697892154241*^9, 
  3.8726978948983927`*^9}, {3.872786797205165*^9, 
  3.872786799388935*^9}},ExpressionUUID->"0d59ae0e-75b4-475f-be58-\
0055d3427f68"],

Cell["\<\
Now we set our boundary conditions to apply at z=0, so we can solve Laplace\
\[CloseCurlyQuote]s equation more easily.\
\>", "Text",
 CellChangeTimes->{{3.872786807716743*^9, 
  3.872786827956827*^9}},ExpressionUUID->"beb639e8-ef69-484c-8105-\
39903374d2cc"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"We", " ", "know", " ", "lowest", " ", "order"}], ",", " ", 
    RowBox[{
    "but", " ", "can", " ", "also", " ", "combine", " ", "bc", " ", "to", " ",
      "remove", " ", "\[Eta]"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"bc1", " ", "=", " ", 
   RowBox[{"Eliminate", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"dbc", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", "t"}], "]"}], "==", "0"}], 
       ",", 
       RowBox[{
        RowBox[{"kbc", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "==", "0"}]}], "}"}], ",", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"\[Eta]", "[", 
        RowBox[{"1", ",", "x", ",", "t"}], "]"}], ",", "t"}], "]"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.872788240677607*^9, 3.872788271206172*^9}, {
  3.87278833013957*^9, 3.87278836838853*^9}, {3.872788407162757*^9, 
  3.8727884492917767`*^9}, {3.87278848097579*^9, 3.872788494510352*^9}},
 CellLabel->
  "In[1890]:=",ExpressionUUID->"ca3210d9-9235-4b75-82e1-522edc8ebd3f"],

Cell[BoxData[
 TemplateBox[{
  "General", "ivar", 
   "\"\\!\\(\\*FractionBox[RowBox[{\\\"\[Omega]\\\", \\\" \\\", \
RowBox[{\\\"Sin\\\", \\\"[\\\", RowBox[{RowBox[{\\\"k\\\", \\\" \\\", \\\"x\\\
\"}], \\\"-\\\", RowBox[{\\\"t\\\", \\\" \\\", \\\"\[Omega]\\\"}]}], \
\\\"]\\\"}]}], \\\"k\\\"]\\) is not a valid variable.\"", 2, 1890, 215, 
   29496185747949257067, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.873290657220058*^9, 3.87329088740376*^9, 3.873291156767387*^9, 
   3.873292288477078*^9, {3.873307287759775*^9, 3.873307295347273*^9}},
 CellLabel->
  "During evaluation of \
In[1890]:=",ExpressionUUID->"32860a5b-9a1b-4f36-b92a-a961a33597fc"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"g", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{
      RowBox[{"k", " ", "x"}], "-", 
      RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "\[Equal]", 
   FractionBox[
    RowBox[{
     SuperscriptBox["\[Omega]", "2"], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"k", " ", "x"}], "-", 
       RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "k"]}], "&&", 
  RowBox[{"k", "\[NotEqual]", "0"}], "&&", 
  RowBox[{"\[Omega]", "\[NotEqual]", "0"}]}]], "Output",
 CellChangeTimes->{
  3.872788369323968*^9, {3.87278842688013*^9, 3.872788450087862*^9}, 
   3.872788495762123*^9, 3.8732906572420273`*^9, 3.8732908874276047`*^9, 
   3.873291156791559*^9, 3.873292288499186*^9, {3.8733072877840776`*^9, 
   3.87330729536989*^9}},
 CellLabel->
  "Out[1890]=",ExpressionUUID->"293d3f30-b0aa-4e40-8b7f-c88cce03b684"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sol", " ", "=", " ", 
  RowBox[{"DSolveValue", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"laplace", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "==", "0"}], ",", "bc1"}], "}"}], ",", 
    RowBox[{"\[Phi]", "[", 
     RowBox[{"1", ",", "x", ",", "z", ",", "t"}], "]"}], ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "z"}], "}"}], "\[Element]", " ", 
     RowBox[{"Rectangle", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.872693644727715*^9, 3.872693646746153*^9}, {
   3.872697301934421*^9, 3.872697314448123*^9}, {3.8726976662905684`*^9, 
   3.872697727424883*^9}, {3.872697791766266*^9, 3.872697795734581*^9}, 
   3.872697865468214*^9, {3.872697966313066*^9, 3.872697994911955*^9}, {
   3.872700660425107*^9, 3.872700698293839*^9}, {3.872700743558298*^9, 
   3.872700752067506*^9}, {3.872700873473709*^9, 3.872700883863351*^9}, {
   3.8727012484907637`*^9, 3.8727013466156187`*^9}, {3.872701602735317*^9, 
   3.872701638136058*^9}, {3.872701803427588*^9, 3.872701813952693*^9}, {
   3.8727022286855917`*^9, 3.872702270402216*^9}, {3.872702483340808*^9, 
   3.872702503034721*^9}, {3.872702809486753*^9, 3.87270284404678*^9}, {
   3.872770162297042*^9, 3.872770223568071*^9}, {3.872770297774149*^9, 
   3.872770328517054*^9}, {3.872770386884671*^9, 3.872770416153862*^9}, {
   3.8727704464507227`*^9, 3.8727704544731407`*^9}, {3.872770554441564*^9, 
   3.872770555029799*^9}, 3.872770892930172*^9, {3.872771525110516*^9, 
   3.872771525837797*^9}, {3.8727720671711197`*^9, 3.872772103562394*^9}, {
   3.8727721688960733`*^9, 3.872772180822348*^9}, 3.8727723946947727`*^9, {
   3.872772536898789*^9, 3.87277258999992*^9}, {3.872788126700288*^9, 
   3.872788225600178*^9}, {3.8727885286552973`*^9, 3.872788529389926*^9}},
 CellLabel->
  "In[1891]:=",ExpressionUUID->"ffac39f8-af49-43a5-88bf-fde620caa63c"],

Cell[BoxData[
 TemplateBox[{
  "DSolveValue", "dsfun", "\"The function specification is not valid.\"", 2, 
   1891, 216, 29496185747949257067, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.873290657291429*^9, 3.8732908874824333`*^9, 3.873291156869012*^9, 
   3.873292288554295*^9, {3.8733072878449917`*^9, 3.873307295430334*^9}},
 CellLabel->
  "During evaluation of \
In[1891]:=",ExpressionUUID->"01df70bc-5331-401a-8f07-50048af1fbb6"],

Cell[BoxData[
 RowBox[{"DSolveValue", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        SuperscriptBox["\[Phi]", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "0", ",", "2", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"1", ",", "x", ",", "z", ",", "t"}], "]"}], "+", 
       RowBox[{
        SuperscriptBox["\[Phi]", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "2", ",", "0", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"1", ",", "x", ",", "z", ",", "t"}], "]"}]}], "\[Equal]", 
      "0"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"g", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"k", " ", "x"}], "-", 
          RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "\[Equal]", 
       FractionBox[
        RowBox[{
         SuperscriptBox["\[Omega]", "2"], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"k", " ", "x"}], "-", 
           RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "k"]}], "&&", 
      RowBox[{"k", "\[NotEqual]", "0"}], "&&", 
      RowBox[{"\[Omega]", "\[NotEqual]", "0"}]}]}], "}"}], ",", 
   FractionBox[
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"k", " ", "z"}]], " ", "g", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"k", " ", "x"}], "-", 
       RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], 
    RowBox[{"k", " ", "\[Omega]"}]], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", "z"}], "}"}], "\[Element]", 
    RowBox[{"Rectangle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", 
        RowBox[{"-", "1"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.8727703292263203`*^9, {3.872770387286809*^9, 3.872770416697279*^9}, {
   3.872770447450014*^9, 3.8727704549637423`*^9}, {3.872770555687169*^9, 
   3.8727705595520887`*^9}, 3.872770725107173*^9, 3.872770893402926*^9, 
   3.872771527547018*^9, {3.872772083660479*^9, 3.872772104079178*^9}, 
   3.872772182320363*^9, 3.87277239516247*^9, {3.87277254838529*^9, 
   3.872772590377039*^9}, {3.8727881462480497`*^9, 3.8727881774332867`*^9}, 
   3.872788226591741*^9, 3.872788531492332*^9, 3.873290657313401*^9, 
   3.8732908875085983`*^9, 3.8732911568917933`*^9, 3.873292288577038*^9, {
   3.873307287867762*^9, 3.87330729545289*^9}},
 CellLabel->
  "Out[1891]=",ExpressionUUID->"29106946-2a19-4fad-bec8-c93d779ebda6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DSolveValue", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Phi]", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "2", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"1", ",", "x", ",", "z", ",", "t"}], "]"}], "+", 
      RowBox[{
       SuperscriptBox["\[Phi]", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "2", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"1", ",", "x", ",", "z", ",", "t"}], "]"}]}], "\[Equal]", 
     "0"}], "}"}], ",", "\[Phi]", ",", 
   RowBox[{"{", " ", 
    RowBox[{",", "x", ",", "z", ",", "t"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8727022027321777`*^9, 3.872702203012106*^9}},
 CellLabel->
  "In[1892]:=",ExpressionUUID->"48cbda8f-5c3f-4350-a8c6-87022269fdc2"],

Cell[BoxData[
 TemplateBox[{
  "DSolveValue", "deqx", 
   "\"Supplied equations are not differential or integral equations of the \
given functions.\"", 2, 1892, 217, 29496185747949257067, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.872702204233244*^9, 3.873290657344235*^9, 3.87329088754138*^9, 
   3.873291156925304*^9, 3.873292288608058*^9, {3.87330728789865*^9, 
   3.87330729550307*^9}},
 CellLabel->
  "During evaluation of \
In[1892]:=",ExpressionUUID->"7a330e3d-79bf-4ce1-93e5-7e70cee951cc"],

Cell[BoxData[
 RowBox[{"DSolveValue", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Phi]", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "2", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"1", ",", "x", ",", "z", ",", "t"}], "]"}], "+", 
      RowBox[{
       SuperscriptBox["\[Phi]", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "2", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"1", ",", "x", ",", "z", ",", "t"}], "]"}]}], "\[Equal]", 
     "0"}], "}"}], ",", "\[Phi]", ",", 
   RowBox[{"{", 
    RowBox[{"Null", ",", "x", ",", "z", ",", "t"}], "}"}]}], "]"}]], "Output",\

 CellChangeTimes->{
  3.873290657366128*^9, 3.873290887564466*^9, 3.873291156947007*^9, 
   3.87329228863004*^9, {3.873307287921089*^9, 3.8733072955259113`*^9}},
 CellLabel->
  "Out[1892]=",ExpressionUUID->"6cc88d75-fafe-4fbf-8cff-56a14f4a64d6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DSolveValue", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Phi]", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "2", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"1", ",", "x", ",", "z", ",", "t"}], "]"}], "+", 
      RowBox[{
       SuperscriptBox["\[Phi]", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "2", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"1", ",", "x", ",", "z", ",", "t"}], "]"}]}], "\[Equal]", 
     "0"}], "}"}], ",", "\[Phi]", ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "z", ",", "t"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.872702781712679*^9, 3.8727027904969378`*^9}},
 CellLabel->
  "In[1893]:=",ExpressionUUID->"3600d42f-a03f-412a-a48a-4449efef0515"],

Cell[BoxData[
 RowBox[{"DSolveValue", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Phi]", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "2", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"1", ",", "x", ",", "z", ",", "t"}], "]"}], "+", 
      RowBox[{
       SuperscriptBox["\[Phi]", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "2", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"1", ",", "x", ",", "z", ",", "t"}], "]"}]}], "\[Equal]", 
     "0"}], "}"}], ",", "\[Phi]", ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "z", ",", "t"}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.87270279134536*^9, 3.873290657415954*^9, 3.87329088762164*^9, 
   3.873291156994668*^9, 3.873292288681885*^9, {3.873307288030518*^9, 
   3.8733072955699797`*^9}},
 CellLabel->
  "Out[1893]=",ExpressionUUID->"cedf247a-4e79-4d69-8f68-334a33781bab"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DSolveValue", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Laplacian", "[", 
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"x", ",", "y"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y"}], "}"}]}], "]"}], "==", "0"}], ",", " ", 
     RowBox[{"DirichletCondition", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"x", ",", "y"}], "]"}], "==", "1"}], ",", "True"}], "]"}]}], 
    "}"}], ",", 
   RowBox[{"T", "[", 
    RowBox[{"x", ",", "y"}], "]"}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}], " ", "\[Element]", " ", 
    RowBox[{"Rectangle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}]}], "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8727019105475397`*^9, 3.872701915188861*^9}, {
   3.8727021761801577`*^9, 3.8727021931318417`*^9}, {3.8727704264987097`*^9, 
   3.872770428241497*^9}, {3.872770650379174*^9, 3.8727706692500153`*^9}, 
   3.872770963051203*^9, {3.872772116217368*^9, 3.872772127208078*^9}, {
   3.872772189991404*^9, 3.872772200437598*^9}, {3.8727724027200737`*^9, 
   3.872772433549279*^9}, 3.872781775914712*^9, {3.872787874621481*^9, 
   3.872787896505808*^9}, {3.872787929859495*^9, 3.8727879302521687`*^9}, {
   3.8727879605130033`*^9, 3.872787963120144*^9}, {3.872787997207733*^9, 
   3.872788100323553*^9}},
 CellLabel->
  "In[1894]:=",ExpressionUUID->"8658832d-206f-4a44-90c6-0952a12bcaac"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{
  3.8727817781851263`*^9, {3.872787880114581*^9, 3.872787897205467*^9}, 
   3.8727879638171043`*^9, {3.872788008870398*^9, 3.8727881007546453`*^9}, 
   3.873290657465464*^9, 3.8732908876705914`*^9, 3.873291157042158*^9, 
   3.873292288734157*^9, {3.8733072880940247`*^9, 3.873307295658347*^9}},
 CellLabel->
  "Out[1894]=",ExpressionUUID->"518fafbd-cbe1-4268-8dea-f4b2dd0c32b9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DSolve", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        SuperscriptBox["T", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "2"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y"}], "]"}], "+", 
       RowBox[{
        SuperscriptBox["T", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"2", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y"}], "]"}]}], "\[Equal]", "0"}], ",", 
     RowBox[{"DirichletCondition", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"x", ",", "y"}], "]"}], "==", "0"}], ",", "True"}], "]"}]}], 
    "}"}], ",", 
   RowBox[{"T", "[", 
    RowBox[{"x", ",", "y"}], "]"}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}], " ", "\[Element]", " ", 
    RowBox[{"Rectangle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "L"}], ",", 
        RowBox[{"-", "h"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"L", ",", "0"}], "}"}]}], "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.872774519535153*^9, 3.8727745204716463`*^9}, {
   3.872774553503786*^9, 3.872774644071663*^9}, {3.872781656972665*^9, 
   3.8727816789862022`*^9}, {3.872781718635748*^9, 3.872781747849126*^9}, {
   3.8727877549701366`*^9, 3.872787766198744*^9}, 3.8727878114796333`*^9},
 CellLabel->
  "In[1895]:=",ExpressionUUID->"0c60b59b-6e24-4c62-a466-21987d49c29a"],

Cell[BoxData[
 RowBox[{"DSolve", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        SuperscriptBox["T", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "2"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y"}], "]"}], "+", 
       RowBox[{
        SuperscriptBox["T", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"2", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y"}], "]"}]}], "\[Equal]", "0"}], ",", 
     RowBox[{"DirichletCondition", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"x", ",", "y"}], "]"}], "\[Equal]", "0"}], ",", "True"}], 
      "]"}]}], "}"}], ",", 
   RowBox[{"T", "[", 
    RowBox[{"x", ",", "y"}], "]"}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}], "\[Element]", 
    RowBox[{"Rectangle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "L"}], ",", 
        RowBox[{"-", "h"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"L", ",", "0"}], "}"}]}], "]"}]}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.8727745213540897`*^9, {3.8727745590627327`*^9, 3.872774581094612*^9}, {
   3.872774617822332*^9, 3.872774640875022*^9}, 3.8727815158947763`*^9, {
   3.8727816730648746`*^9, 3.872781679412128*^9}, {3.872781719897894*^9, 
   3.872781748613545*^9}, 3.8727877677335377`*^9, 3.872787811976529*^9, 
   3.873290657515683*^9, 3.8732908879030437`*^9, 3.873291157089016*^9, 
   3.87329228878615*^9, {3.8733072881487713`*^9, 3.8733072957023087`*^9}},
 CellLabel->
  "Out[1895]=",ExpressionUUID->"aab0b098-c5cf-4beb-8f92-31192cc3a9af"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8726835837806797`*^9, 3.872683626269375*^9}, 
   3.87268595779274*^9},
 CellLabel->
  "In[1896]:=",ExpressionUUID->"72991f45-0e2b-4b91-9871-27fe23ce9f49"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1440, 771},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"13.1 for Mac OS X ARM (64-bit) (June 16, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"2d16ff12-05a7-4b6e-87cd-19b00cb420e1"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 181, 3, 98, "Title",ExpressionUUID->"b00a80b6-6bb9-45e9-b949-0996d304dd9f"],
Cell[764, 27, 221, 6, 85, "Subtitle",ExpressionUUID->"171d7166-04ce-4e9b-8e0e-f9bc540ed745"],
Cell[988, 35, 274, 5, 30, "Input",ExpressionUUID->"492a0b1f-8802-4cde-8d5f-2482156ea0af"],
Cell[CellGroupData[{
Cell[1287, 44, 164, 3, 67, "Section",ExpressionUUID->"cb9d3b79-5f20-4de2-bc64-6f2a6441573d"],
Cell[1454, 49, 12428, 307, 698, "Text",ExpressionUUID->"6db499c1-8a50-4e78-a4b5-b29203035bf3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13919, 361, 215, 4, 67, "Section",ExpressionUUID->"9274f81e-b79a-4ee0-9378-ac8ed9446c36"],
Cell[14137, 367, 1940, 49, 221, "Input",ExpressionUUID->"d28214ab-a569-432c-a31f-35f9e89de257"],
Cell[16080, 418, 975, 22, 52, "Input",ExpressionUUID->"5ba5cfe9-4bc8-4cd9-bfb5-ea8e872d2c62"],
Cell[CellGroupData[{
Cell[17080, 444, 535, 14, 52, "Input",ExpressionUUID->"cf63aacc-b963-469f-8e31-f049253fe51c"],
Cell[17618, 460, 2345, 65, 37, "Output",ExpressionUUID->"fbb88b27-90a2-4366-9857-48a46685f659"]
}, Open  ]],
Cell[19978, 528, 1693, 38, 52, "Input",ExpressionUUID->"8807aa22-4d2e-4014-a94f-30409f739391"],
Cell[CellGroupData[{
Cell[21696, 570, 854, 17, 52, "Input",ExpressionUUID->"e631a0b0-cb2a-4fb1-a5aa-c78fbcbf322f"],
Cell[22553, 589, 1837, 55, 34, "Output",ExpressionUUID->"5f6e804e-49d4-4f9a-85b9-fd3e79b2235c"]
}, Open  ]],
Cell[24405, 647, 249, 4, 30, "Input",ExpressionUUID->"28ff057a-a164-4bc4-8b5d-5bd4380047f1"],
Cell[24657, 653, 1389, 36, 52, "Input",ExpressionUUID->"abaa8b3b-256f-4398-abaa-3194e8aa4a48"],
Cell[CellGroupData[{
Cell[26071, 693, 693, 16, 52, "Input",ExpressionUUID->"f571322c-de27-41cc-8a37-f8a06f98dc94"],
Cell[26767, 711, 1693, 51, 34, "Output",ExpressionUUID->"d30e0e73-d71e-4880-a78e-4d9c2693810a"]
}, Open  ]],
Cell[28475, 765, 225, 4, 30, "Input",ExpressionUUID->"300d3410-9514-45e5-a308-c44fbd42b001"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28737, 774, 264, 4, 67, "Section",ExpressionUUID->"c33935e2-bfb4-49c5-92c1-568e82b64ca6"],
Cell[29004, 780, 1443, 32, 106, "Text",ExpressionUUID->"e9b48876-698c-418c-98ac-ffc875955536"],
Cell[CellGroupData[{
Cell[30472, 816, 781, 22, 30, "Input",ExpressionUUID->"81e5b6cc-555c-407d-95e5-43d479fd6595"],
Cell[31256, 840, 1361, 31, 34, "Output",ExpressionUUID->"fab3d729-b2d9-4985-ab83-aef2d664ad9d"]
}, Open  ]],
Cell[32632, 874, 669, 16, 30, "Input",ExpressionUUID->"80023062-7256-40f5-ae9e-af9ea0aeac8d"],
Cell[33304, 892, 1987, 53, 73, "Input",ExpressionUUID->"566dc369-8ab9-41ab-8f9c-3c5d1db95472"],
Cell[CellGroupData[{
Cell[35316, 949, 683, 21, 30, "Input",ExpressionUUID->"ce37bee1-f4dc-4fef-8753-ff09d1e68c21"],
Cell[36002, 972, 760, 19, 34, "Output",ExpressionUUID->"33d8abf0-eba0-4a71-bc06-f2cc5dd71b6b"]
}, Open  ]],
Cell[36777, 994, 914, 20, 60, "Text",ExpressionUUID->"f0f3b849-c736-4075-926a-fea16d52ef7a"],
Cell[CellGroupData[{
Cell[37716, 1018, 1030, 27, 73, "Input",ExpressionUUID->"282d3dcb-3bae-4527-990d-4678b1077e6e"],
Cell[38749, 1047, 758, 19, 53, "Output",ExpressionUUID->"6a453810-7249-4979-bb23-9aa3459604b0"],
Cell[39510, 1068, 859, 16, 41, "Message",ExpressionUUID->"0bc749ca-81df-4d24-a782-bdd6058f14c7"],
Cell[40372, 1086, 569, 13, 34, "Output",ExpressionUUID->"b4794b4d-b7cf-457d-b7cf-b7da0ea4e63a"]
}, Open  ]],
Cell[40956, 1102, 1366, 26, 106, "Text",ExpressionUUID->"7d3ad541-0dc3-494d-a7c8-19da8886e329"],
Cell[CellGroupData[{
Cell[42347, 1132, 2055, 54, 241, "Input",ExpressionUUID->"de2de41c-b57f-490c-967a-718f76d99e95"],
Cell[44405, 1188, 1016, 25, 54, "Output",ExpressionUUID->"e40cb349-7268-4cd7-a51f-fb4d98022795"],
Cell[45424, 1215, 879, 22, 50, "Output",ExpressionUUID->"f08c7a53-2503-4962-be69-45395da869a7"]
}, Open  ]],
Cell[46318, 1240, 71, 0, 35, "Text",ExpressionUUID->"4d1e3475-2976-473b-8df6-30ef539a8d9e"],
Cell[46392, 1242, 830, 22, 50, "Output",ExpressionUUID->"7aed649f-08c5-44b0-a640-c83afa618a8a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47259, 1269, 275, 4, 67, "Section",ExpressionUUID->"7482126b-1ebb-48d4-a4e9-e393e6739f5d"],
Cell[47537, 1275, 2137, 54, 98, "Text",ExpressionUUID->"26b0bbb3-f100-40c8-a921-d8f7616718ba"],
Cell[49677, 1331, 350, 6, 30, "Input",ExpressionUUID->"8e432576-bdbd-4270-b8c2-989a518a0eae"],
Cell[50030, 1339, 303, 5, 30, "Input",ExpressionUUID->"78464b50-4f75-459b-b2ba-794dd084b928"],
Cell[50336, 1346, 1029, 27, 52, "Input",ExpressionUUID->"e2800158-3cd5-4c50-8c9f-120860157783"],
Cell[CellGroupData[{
Cell[51390, 1377, 403, 9, 30, "Input",ExpressionUUID->"f01e29bf-10de-43b7-af62-538c0c39958a"],
Cell[51796, 1388, 1160, 33, 51, "Output",ExpressionUUID->"fd2ded5c-0f87-4eaa-b4bb-03c19ba9bf37"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52993, 1426, 3169, 83, 115, "Input",ExpressionUUID->"fdb0cb0d-31d8-416d-91f9-2a1de88543b2"],
Cell[56165, 1511, 763, 23, 34, "Output",ExpressionUUID->"3c896c38-a023-48a1-81b0-a392f801240f"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[56977, 1540, 172, 3, 67, "Section",ExpressionUUID->"49ce2238-68a3-4723-898e-dbb6fd81056c"],
Cell[57152, 1545, 786, 23, 34, "Output",ExpressionUUID->"856f20d0-34e1-432f-af91-14bcd53ed645"],
Cell[57941, 1570, 200, 3, 35, "Text",ExpressionUUID->"570a3c73-9078-43e9-bdbf-ec78f7814338"],
Cell[CellGroupData[{
Cell[58166, 1577, 3225, 92, 94, "Input",ExpressionUUID->"2aca4a3a-95da-499a-acb2-25f649ce45ef"],
Cell[61394, 1671, 259, 4, 34, "Output",ExpressionUUID->"111b97fb-5113-4ec7-aa06-8a8b318e625d"]
}, Open  ]],
Cell[61668, 1678, 184, 3, 30, "Text",ExpressionUUID->"b197d847-52d6-4cb6-9869-54ec49f46bd6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[61889, 1686, 179, 3, 67, "Section",ExpressionUUID->"0c61ca42-2ef7-4493-af30-cce583d837b2"],
Cell[62071, 1691, 1198, 31, 75, "Text",ExpressionUUID->"898818ec-2765-4383-a253-7301d5937b42"],
Cell[63272, 1724, 202, 4, 30, "Input",ExpressionUUID->"ee7e8782-3e46-40ab-b203-ed8bf6d7ce23"],
Cell[CellGroupData[{
Cell[63499, 1732, 1212, 33, 73, "Input",ExpressionUUID->"9a44e161-517f-423b-8e3d-15c972194446"],
Cell[64714, 1767, 2251, 67, 53, "Output",ExpressionUUID->"66804d23-2ad8-4d63-ae1e-8fc80bb3327d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[67002, 1839, 1138, 32, 52, "Input",ExpressionUUID->"44d72002-f6e4-417e-b3cc-794e5758cdc2"],
Cell[68143, 1873, 2009, 55, 96, "Output",ExpressionUUID->"e7628887-c028-4803-b96e-d41275c4357a"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[70201, 1934, 640, 9, 67, "Section",ExpressionUUID->"0d59ae0e-75b4-475f-be58-0055d3427f68"],
Cell[70844, 1945, 268, 6, 35, "Text",ExpressionUUID->"beb639e8-ef69-484c-8105-39903374d2cc"],
Cell[CellGroupData[{
Cell[71137, 1955, 1154, 31, 52, "Input",ExpressionUUID->"ca3210d9-9235-4b75-82e1-522edc8ebd3f"],
Cell[72294, 1988, 682, 14, 40, "Message",ExpressionUUID->"32860a5b-9a1b-4f36-b92a-a961a33597fc"],
Cell[72979, 2004, 859, 23, 52, "Output",ExpressionUUID->"293d3f30-b0aa-4e40-8b7f-c88cce03b684"]
}, Open  ]],
Cell[CellGroupData[{
Cell[73875, 2032, 2091, 41, 30, "Input",ExpressionUUID->"ffac39f8-af49-43a5-88bf-fde620caa63c"],
Cell[75969, 2075, 465, 10, 28, "Message",ExpressionUUID->"01df70bc-5331-401a-8f07-50048af1fbb6"],
Cell[76437, 2087, 2632, 71, 54, "Output",ExpressionUUID->"29106946-2a19-4fad-bec8-c93d779ebda6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[79106, 2163, 943, 27, 33, "Input",ExpressionUUID->"48cbda8f-5c3f-4350-a8c6-87022269fdc2"],
Cell[80052, 2192, 530, 12, 28, "Message",ExpressionUUID->"7a330e3d-79bf-4ce1-93e5-7e70cee951cc"],
Cell[80585, 2206, 1043, 30, 37, "Output",ExpressionUUID->"6cc88d75-fafe-4fbf-8cff-56a14f4a64d6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[81665, 2241, 1002, 29, 33, "Input",ExpressionUUID->"3600d42f-a03f-412a-a48a-4449efef0515"],
Cell[82670, 2272, 1122, 32, 37, "Output",ExpressionUUID->"cedf247a-4e79-4d69-8f68-334a33781bab"]
}, Open  ]],
Cell[CellGroupData[{
Cell[83829, 2309, 1569, 39, 30, "Input",ExpressionUUID->"8658832d-206f-4a44-90c6-0952a12bcaac"],
Cell[85401, 2350, 427, 7, 34, "Output",ExpressionUUID->"518fafbd-cbe1-4268-8dea-f4b2dd0c32b9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[85865, 2362, 1581, 47, 33, "Input",ExpressionUUID->"0c60b59b-6e24-4c62-a466-21987d49c29a"],
Cell[87449, 2411, 1752, 50, 37, "Output",ExpressionUUID->"aab0b098-c5cf-4beb-8f92-31192cc3a9af"]
}, Open  ]],
Cell[89216, 2464, 203, 4, 30, "Input",ExpressionUUID->"72991f45-0e2b-4b91-9871-27fe23ce9f49"]
}, Open  ]]
}, Open  ]]
}
]
*)

